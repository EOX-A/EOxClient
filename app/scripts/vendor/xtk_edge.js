/*
 * 
 *                  xxxxxxx      xxxxxxx
 *                   x:::::x    x:::::x 
 *                    x:::::x  x:::::x  
 *                     x:::::xx:::::x   
 *                      x::::::::::x    
 *                       x::::::::x     
 *                       x::::::::x     
 *                      x::::::::::x    
 *                     x:::::xx:::::x   
 *                    x:::::x  x:::::x  
 *                   x:::::x    x:::::x 
 *              THE xxxxxxx      xxxxxxx TOOLKIT
 *                    
 *                  http://www.goXTK.com
 *                   
 * Copyright (c) 2012 The X Toolkit Developers <dev@goXTK.com>
 *                   
 *    The X Toolkit (XTK) is licensed under the MIT License:
 *      http://www.opensource.org/licenses/mit-license.php
 * 
 *      "Free software" is a matter of liberty, not price.
 *      "Free" as in "free speech", not as in "free beer".
 *                                         - Richard M. Stallman
 * 
 * FUELED BY:
 *  - the wonderful Constructive Solid Geometry library by Evan Wallace (http://madebyevan.com)
 *    LICENSE: https://raw.github.com/xtk/X/master/lib/csg/LICENSE
 *
 *  - parts of the Google Closure Library (http://code.google.com/closure/library)
 *    LICENSE: https://raw.github.com/xtk/google-closure-library/master/LICENSE
 *
 *  - zlib.js, the ultimate gzip/zlib javascript implementation (https://github.com/imaya/zlib.js)
 *    LICENSE: https://raw.github.com/imaya/zlib.js/master/LICENSE
 *
 * MORE CREDITS: https://raw.github.com/xtk/X/master/LICENSE
 *
 */
function m(a){throw a;}var p=void 0,q=!0,t=null,u=!1;function ea(){return function(){}}function fa(a){return function(b){this[a]=b}}function v(a){return function(){return this[a]}}var w,ga=this;function ha(){}
function ia(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b}function ja(a){return a!==p}function la(a){return"array"==ia(a)}function ma(a){var b=ia(a);return"array"==b||"object"==b&&"number"==typeof a.length}function na(a){return"string"==typeof a}function x(a){return"number"==typeof a}function oa(a){return"function"==ia(a)}function pa(a){var b=typeof a;return"object"==b&&a!=t||"function"==b}function qa(a){return a[ra]||(a[ra]=++sa)}var ra="closure_uid_"+(1E9*Math.random()>>>0),sa=0;
function ta(a,b,c){return a.call.apply(a.bind,arguments)}function ua(a,b,c){a||m(Error());if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,e);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function va(a,b,c){va=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ta:ua;return va.apply(t,arguments)}
function wa(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=Array.prototype.slice.call(arguments);b.unshift.apply(b,c);return a.apply(this,b)}}var xa=Date.now||function(){return+new Date};function B(a,b){var c=a.split("."),e=ga;!(c[0]in e)&&e.execScript&&e.execScript("var "+c[0]);for(var d;c.length&&(d=c.shift());)!c.length&&ja(b)?e[d]=b:e=e[d]?e[d]:e[d]={}}
function C(a,b){function c(){}c.prototype=b.prototype;a.z=b.prototype;a.prototype=new c;a.prototype.constructor=a};function ya(a,b,c){this.Ta=this.Sa=this.Ra=0;3==arguments.length?(this.Ra=Number(a),this.Sa=Number(b),this.Ta=Number(c)):a instanceof ya?(this.Ra=Number(a.x()),this.Sa=Number(a.y()),this.Ta=Number(a.d())):(this.Ra=Number(a[0]),this.Sa=Number(a[1]),this.Ta=Number(a[2]))}
ya.prototype={l:function(){return new ya(this.Ra,this.Sa,this.Ta)},Xb:function(a){return this.Ra*a.x()+this.Sa*a.y()+this.Ta*a.d()},ke:function(a,b){return Aa(this,Ba(Ca(a,this),b))},length:function(){return Math.sqrt(this.Xb(this))},ic:function(a){return new ya(this.Sa*a.d()-this.Ta*a.y(),this.Ta*a.x()-this.Ra*a.d(),this.Ra*a.y()-this.Sa*a.x())},x:v("Ra"),y:v("Sa"),d:v("Ta")};function Da(a){var b=a.length();return new ya(a.Ra/b,a.Sa/b,a.Ta/b)}
function Ba(a,b){return new ya(a.Ra*b,a.Sa*b,a.Ta*b)}function Ca(a,b){return new ya(a.Ra-b.x(),a.Sa-b.y(),a.Ta-b.d())}function Aa(a,b){return new ya(a.Ra+b.x(),a.Sa+b.y(),a.Ta+b.d())}function Fa(a){return new ya(-a.Ra,-a.Sa,-a.Ta)};var D=D||{};D.Nj=q;D.Ya=function(a){eval("X.DEV === undefined")||window.console.time(a)};D.Ua=function(a){eval("X.DEV === undefined")||window.console.timeEnd(a)};window["X.counter"]=new function(){this.Eh=0;this.Jj=function(){return this.Eh++}};function Ga(a,b){for(var c in b){var e=b.__lookupGetter__(c),d=b.__lookupSetter__(c);c in a||(e||d?(e&&a.__defineGetter__(c,e),d&&a.__defineSetter__(c,d)):a[c]=b[c])}}var Ha=window.th;
Function.prototype.bind||(Function.prototype.bind=function(a){function b(){return f.apply(this instanceof c?this:a||window,d.concat(e.call(arguments)))}function c(){}"function"!==typeof this&&m(new TypeError("Function.prototype.bind - what is trying to be bound is not callable"));var e=Array.prototype.slice,d=e.call(arguments,1),f=this;c.prototype=this.prototype;b.prototype=new c;return b});
for(var Ia=0,Ja=["ms","moz","webkit","o"],Ka=0;Ka<Ja.length&&!window.requestAnimationFrame;++Ka)window.requestAnimationFrame=window[Ja[Ka]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[Ja[Ka]+"CancelAnimationFrame"]||window[Ja[Ka]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(0,16-(b-Ia)),e=window.setTimeout(function(){a(b+c)},c);Ia=b+c;return e});
window.cancelAnimationFrame||(window.cancelAnimationFrame=function(a){clearTimeout(a)});
"slice"in ArrayBuffer.prototype||(ArrayBuffer.prototype.slice=function(a,b){a===p&&m(Error("Not enough arguments."));var c=b||this.byteLength;0>a&&(a=this.byteLength+a);0>c&&(c=this.byteLength+c);c<a&&(c=a=0);0>a&&(a=0);0>c&&(c=0);a>this.byteLength&&(a=this.byteLength);c>this.byteLength&&(c=this.byteLength);for(var e=new ArrayBuffer(c-a),d=new Uint8Array(this),f=new Uint8Array(e),g=a,h=0;g<c;++g,++h)f[h]=d[g];return e});B("$",Ha);B("Function.prototype.bind",Function.prototype.bind);
B("window.requestAnimationFrame",window.requestAnimationFrame);B("window.cancelAnimationFrame",window.cancelAnimationFrame);var La=0;function Ma(){}w=Ma.prototype;w.key=0;w.mc=u;w.Zd=u;w.wa=function(a,b,c,e,d,f){oa(a)?this.Jg=q:a&&a.handleEvent&&oa(a.handleEvent)?this.Jg=u:m(Error("Invalid listener argument"));this.Yb=a;this.$g=b;this.src=c;this.type=e;this.capture=!!d;this.gf=f;this.Zd=u;this.key=++La;this.mc=u};w.handleEvent=function(a){return this.Jg?this.Yb.call(this.gf||this.src,a):this.Yb.handleEvent.call(this.Yb,a)};function Na(a,b){for(var c in a)b.call(p,a[c],c,a)}function Oa(a){var b=[],c=0,e;for(e in a)b[c++]=a[e];return b}var Pa="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ra(a,b){for(var c,e,d=1;d<arguments.length;d++){e=arguments[d];for(c in e)a[c]=e[c];for(var f=0;f<Pa.length;f++)c=Pa[f],Object.prototype.hasOwnProperty.call(e,c)&&(a[c]=e[c])}};function Sa(a){if(!Ta.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(Ua,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(Va,"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(Wa,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(Xa,"&quot;"));return a}var Ua=/&/g,Va=/</g,Wa=/>/g,Xa=/\"/g,Ta=/[&<>\"]/;var Ya,Za,$a,ab,bb,cb,eb;function fb(){return ga.navigator?ga.navigator.userAgent:t}function gb(){return ga.navigator}ab=$a=Za=Ya=u;var hb;if(hb=fb()){var ib=gb();Ya=0==hb.indexOf("Opera");Za=!Ya&&-1!=hb.indexOf("MSIE");$a=!Ya&&-1!=hb.indexOf("WebKit");ab=!Ya&&!$a&&"Gecko"==ib.product}var jb=Ya,J=Za,lb=ab,mb=$a,ob,pb=gb();ob=pb&&pb.platform||"";bb=-1!=ob.indexOf("Mac");cb=-1!=ob.indexOf("Win");eb=-1!=ob.indexOf("Linux");var qb=!!gb()&&-1!=(gb().appVersion||"").indexOf("X11");
function rb(){var a=ga.document;return a?a.documentMode:p}var vb;a:{var wb="",xb;if(jb&&ga.opera)var yb=ga.opera.version,wb="function"==typeof yb?yb():yb;else if(lb?xb=/rv\:([^\);]+)(\)|;)/:J?xb=/MSIE\s+([^\);]+)(\)|;)/:mb&&(xb=/WebKit\/(\S+)/),xb)var zb=xb.exec(fb()),wb=zb?zb[1]:"";if(J){var Ab=rb();if(Ab>parseFloat(wb)){vb=String(Ab);break a}}vb=wb}var Bb={};
function Cb(a){var b;if(!(b=Bb[a])){b=0;for(var c=String(vb).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),e=String(a).replace(/^[\s\xa0]+|[\s\xa0]+$/g,"").split("."),d=Math.max(c.length,e.length),f=0;0==b&&f<d;f++){var g=c[f]||"",h=e[f]||"",l=RegExp("(\\d*)(\\D*)","g"),j=RegExp("(\\d*)(\\D*)","g");do{var k=l.exec(g)||["","",""],n=j.exec(h)||["","",""];if(0==k[0].length&&0==n[0].length)break;b=((0==k[1].length?0:parseInt(k[1],10))<(0==n[1].length?0:parseInt(n[1],10))?-1:(0==k[1].length?0:parseInt(k[1],
10))>(0==n[1].length?0:parseInt(n[1],10))?1:0)||((0==k[2].length)<(0==n[2].length)?-1:(0==k[2].length)>(0==n[2].length)?1:0)||(k[2]<n[2]?-1:k[2]>n[2]?1:0)}while(0==b)}b=Bb[a]=0<=b}return b}var Db=ga.document,Eb=!Db||!J?p:rb()||("CSS1Compat"==Db.compatMode?parseInt(vb,10):5);var Fb=!J||J&&9<=Eb,Gb=J&&!Cb("9");!mb||Cb("528");lb&&Cb("1.9b")||J&&Cb("8")||jb&&Cb("9.5")||mb&&Cb("528");lb&&!Cb("8")||J&&Cb("9");var Hb=Array.prototype,Ib=Hb.indexOf?function(a,b,c){return Hb.indexOf.call(a,b,c)}:function(a,b,c){c=c==t?0:0>c?Math.max(0,a.length+c):c;if(na(a))return!na(b)||1!=b.length?-1:a.indexOf(b,c);for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1},Jb=Hb.forEach?function(a,b,c){Hb.forEach.call(a,b,c)}:function(a,b,c){for(var e=a.length,d=na(a)?a.split(""):a,f=0;f<e;f++)f in d&&b.call(c,d[f],f,a)},Lb=Hb.map?function(a,b,c){return Hb.map.call(a,b,c)}:function(a,b,c){for(var e=a.length,d=Array(e),f=
na(a)?a.split(""):a,g=0;g<e;g++)g in f&&(d[g]=b.call(c,f[g],g,a));return d},Mb=Hb.some?function(a,b,c){return Hb.some.call(a,b,c)}:function(a,b,c){for(var e=a.length,d=na(a)?a.split(""):a,f=0;f<e;f++)if(f in d&&b.call(c,d[f],f,a))return q;return u};function Nb(a,b){var c=Ib(a,b);0<=c&&Hb.splice.call(a,c,1)}function Ob(a,b,c){return 2>=arguments.length?Hb.slice.call(a,b):Hb.slice.call(a,b,c)};function Pb(){0!=Qb&&(this.Lk=Error().stack,qa(this))}var Qb=0;function Rb(a,b){this.type=a;this.currentTarget=this.target=b}w=Rb.prototype;w.lc=u;w.defaultPrevented=u;w.oe=q;w.stopPropagation=function(){this.lc=q};w.preventDefault=function(){this.defaultPrevented=q;this.oe=u};function Sb(a){Sb[" "](a);return a}Sb[" "]=ha;function Tb(a,b){a&&this.wa(a,b)}C(Tb,Rb);w=Tb.prototype;w.target=t;w.relatedTarget=t;w.offsetX=0;w.offsetY=0;w.clientX=0;w.clientY=0;w.screenX=0;w.screenY=0;w.button=0;w.keyCode=0;w.charCode=0;w.ctrlKey=u;w.altKey=u;w.shiftKey=u;w.metaKey=u;w.pj=u;w.jb=t;
w.wa=function(a,b){var c=this.type=a.type;Rb.call(this,c);this.target=a.target||a.srcElement;this.currentTarget=b;var e=a.relatedTarget;if(e){if(lb){var d;a:{try{Sb(e.nodeName);d=q;break a}catch(f){}d=u}d||(e=t)}}else"mouseover"==c?e=a.fromElement:"mouseout"==c&&(e=a.toElement);this.relatedTarget=e;this.offsetX=mb||a.offsetX!==p?a.offsetX:a.layerX;this.offsetY=mb||a.offsetY!==p?a.offsetY:a.layerY;this.clientX=a.clientX!==p?a.clientX:a.pageX;this.clientY=a.clientY!==p?a.clientY:a.pageY;this.screenX=
a.screenX||0;this.screenY=a.screenY||0;this.button=a.button;this.keyCode=a.keyCode||0;this.charCode=a.charCode||("keypress"==c?a.keyCode:0);this.ctrlKey=a.ctrlKey;this.altKey=a.altKey;this.shiftKey=a.shiftKey;this.metaKey=a.metaKey;this.pj=bb?a.metaKey:a.ctrlKey;this.state=a.state;this.jb=a;a.defaultPrevented&&this.preventDefault();delete this.lc};w.stopPropagation=function(){Tb.z.stopPropagation.call(this);this.jb.stopPropagation?this.jb.stopPropagation():this.jb.cancelBubble=q};
w.preventDefault=function(){Tb.z.preventDefault.call(this);var a=this.jb;if(a.preventDefault)a.preventDefault();else if(a.returnValue=u,Gb)try{if(a.ctrlKey||112<=a.keyCode&&123>=a.keyCode)a.keyCode=-1}catch(b){}};w.ki=v("jb");var Ub={},Vb={},Wb={},Xb={};function L(a,b,c,e,d){if(la(b)){for(var f=0;f<b.length;f++)L(a,b[f],c,e,d);return t}a=Yb(a,b,c,u,e,d);b=a.key;Ub[b]=a;return b}
function Yb(a,b,c,e,d,f){b||m(Error("Invalid event type"));d=!!d;var g=Vb;b in g||(g[b]={ja:0,Ia:0});g=g[b];d in g||(g[d]={ja:0,Ia:0},g.ja++);var g=g[d],h=qa(a),l;g.Ia++;if(g[h]){l=g[h];for(var j=0;j<l.length;j++)if(g=l[j],g.Yb==c&&g.gf==f){if(g.mc)break;e||(l[j].Zd=u);return l[j]}}else l=g[h]=[],g.ja++;var k=Zb,n=Fb?function(a){return k.call(n.src,n.Yb,a)}:function(a){a=k.call(n.src,n.Yb,a);if(!a)return a},j=n,g=new Ma;g.wa(c,j,a,b,d,f);g.Zd=e;j.src=a;j.Yb=g;l.push(g);Wb[h]||(Wb[h]=[]);Wb[h].push(g);
a.addEventListener?(a==ga||!a.customEvent_)&&a.addEventListener(b,j,d):a.attachEvent(b in Xb?Xb[b]:Xb[b]="on"+b,j);return g}function $b(a,b,c,e,d){if(la(b))for(var f=0;f<b.length;f++)$b(a,b[f],c,e,d);else a=Yb(a,b,c,q,e,d),Ub[a.key]=a}function ac(a,b,c,e,d){if(la(b))for(var f=0;f<b.length;f++)ac(a,b[f],c,e,d);else{e=!!e;a:{f=Vb;if(b in f&&(f=f[b],e in f&&(f=f[e],a=qa(a),f[a]))){a=f[a];break a}a=t}if(a)for(f=0;f<a.length;f++)if(a[f].Yb==c&&a[f].capture==e&&a[f].gf==d){bc(a[f].key);break}}}
function bc(a){var b=Ub[a];if(!b||b.mc)return u;var c=b.src,e=b.type,d=b.$g,f=b.capture;c.removeEventListener?(c==ga||!c.customEvent_)&&c.removeEventListener(e,d,f):c.detachEvent&&c.detachEvent(e in Xb?Xb[e]:Xb[e]="on"+e,d);c=qa(c);Wb[c]&&(d=Wb[c],Nb(d,b),0==d.length&&delete Wb[c]);b.mc=q;if(b=Vb[e][f][c])b.Rg=q,cc(e,f,c,b);delete Ub[a];return q}
function cc(a,b,c,e){if(!e.le&&e.Rg){for(var d=0,f=0;d<e.length;d++)e[d].mc?e[d].$g.src=t:(d!=f&&(e[f]=e[d]),f++);e.length=f;e.Rg=u;0==f&&(delete Vb[a][b][c],Vb[a][b].ja--,0==Vb[a][b].ja&&(delete Vb[a][b],Vb[a].ja--),0==Vb[a].ja&&delete Vb[a])}}function dc(a,b){var c=qa(a),e=Wb[c];if(e){var d=ja(b),f=ja(p);return d&&f?(e=Vb[b],!!e&&!!e[p]&&c in e[p]):!d&&!f?q:Mb(e,function(a){return d&&a.type==b||f&&a.capture==p})}return u}
function ec(a,b,c,e,d){var f=1;b=qa(b);if(a[b]){var g=--a.Ia,h=a[b];h.le?h.le++:h.le=1;try{for(var l=h.length,j=0;j<l;j++){var k=h[j];k&&!k.mc&&(f&=fc(k,d)!==u)}}finally{a.Ia=Math.max(g,a.Ia),h.le--,cc(c,e,b,h)}}return Boolean(f)}function fc(a,b){a.Zd&&bc(a.key);return a.handleEvent(b)}
function Zb(a,b){if(a.mc)return q;var c=a.type,e=Vb;if(!(c in e))return q;var e=e[c],d,f;if(!Fb){var g;if(!(g=b))a:{g=["window","event"];for(var h=ga;d=g.shift();)if(h[d]!=t)h=h[d];else{g=t;break a}g=h}d=g;g=q in e;h=u in e;if(g){if(0>d.keyCode||d.returnValue!=p)return q;a:{var l=u;if(0==d.keyCode)try{d.keyCode=-1;break a}catch(j){l=q}if(l||d.returnValue==p)d.returnValue=q}}l=new Tb;l.wa(d,this);d=q;try{if(g){for(var k=[],n=l.currentTarget;n;n=n.parentNode)k.push(n);f=e[q];f.Ia=f.ja;for(var r=k.length-
1;!l.lc&&0<=r&&f.Ia;r--)l.currentTarget=k[r],d&=ec(f,k[r],c,q,l);if(h){f=e[u];f.Ia=f.ja;for(r=0;!l.lc&&r<k.length&&f.Ia;r++)l.currentTarget=k[r],d&=ec(f,k[r],c,u,l)}}else d=fc(a,l)}finally{k&&(k.length=0)}return d}c=new Tb(b,this);return d=fc(a,c)}var gc=0;function hc(a){return a+"_"+gc++};function ic(){Pb.call(this);this.Pk={};this.Jk=this}C(ic,Pb);ic.prototype.customEvent_=q;w=ic.prototype;w.Af=t;w.Ff=fa("Af");w.addEventListener=function(a,b,c,e){L(this,a,b,c,e)};w.removeEventListener=function(a,b,c,e){ac(this,a,b,c,e)};
w.dispatchEvent=function(a){var b=a.type||a,c=Vb;if(b in c){if(na(a))a=new Rb(a,this);else if(a instanceof Rb)a.target=a.target||this;else{var e=a;a=new Rb(b,this);Ra(a,e)}var e=1,d,c=c[b],b=q in c,f;if(b){d=[];for(f=this;f;f=f.Af)d.push(f);f=c[q];f.Ia=f.ja;for(var g=d.length-1;!a.lc&&0<=g&&f.Ia;g--)a.currentTarget=d[g],e&=ec(f,d[g],a.type,q,a)&&a.oe!=u}if(u in c)if(f=c[u],f.Ia=f.ja,b)for(g=0;!a.lc&&g<d.length&&f.Ia;g++)a.currentTarget=d[g],e&=ec(f,d[g],a.type,u,a)&&a.oe!=u;else for(d=this;!a.lc&&
d&&f.Ia;d=d.Af)a.currentTarget=d,e&=ec(f,d,a.type,u,a)&&a.oe!=u;a=Boolean(e)}else a=q;return a};function O(){ic.call(this);this.g="base";this.ta=window["X.counter"].Jj();this.j=u}C(O,ic);O.prototype.__defineGetter__("classname",v("g"));O.prototype.__defineGetter__("id",v("ta"));B("X.base",O);function jc(a,b){this.Qa=new ya(a);this.ra=new ya(b)}jc.prototype={l:function(){return new jc(this.Qa.l(),this.ra.l())},kc:function(){this.ra=Fa(this.ra)}};function kc(a,b){this.ra=a;this.Cd=b}kc.prototype={l:function(){return new kc(this.ra.l(),this.Cd)},kc:function(){this.ra=Fa(this.ra);this.Cd=-this.Cd}};function lc(a,b){this.Eb=a;this.ue=b;var c=a[0].Qa,e=a[2].Qa,e=Da(Ca(a[1].Qa,c).ic(Ca(e,c)));this.Pa=new kc(e,e.Xb(c))}lc.prototype={l:function(){var a=this.Eb.map(function(a){return a.l()});return new lc(a,this.ue)},kc:function(){this.Eb.reverse().map(function(a){a.kc()});this.Pa.kc()}};
function mc(a,b,c,e,d,f){for(var g=0,h=[],l=0;l<a.Eb.length;l++){var j=b.ra.Xb(a.Eb[l].Qa)-b.Cd,j=-1E-5>j?2:1E-5<j?1:0,g=g|j;h.push(j)}switch(g){case 0:(0<b.ra.Xb(a.Pa.ra)?c:e).push(a);break;case 1:d.push(a);break;case 2:f.push(a);break;case 3:c=[];e=[];for(l=0;l<a.Eb.length;l++){var k=(l+1)%a.Eb.length,j=h[l],n=h[k],g=a.Eb[l],k=a.Eb[k];2!=j&&c.push(g);1!=j&&e.push(2!=j?g.l():g);3==(j|n)&&(j=(b.Cd-b.ra.Xb(g.Qa))/b.ra.Xb(Ca(k.Qa,g.Qa)),j=new jc(g.Qa.ke(k.Qa,j),g.ra.ke(k.ra,j)),c.push(j),e.push(j.l()))}3<=
c.length&&d.push(new lc(c,a.ue));3<=e.length&&f.push(new lc(e,a.ue))}};function nc(a){this.ua=this.va=this.Pa=t;this.V=[];a&&oc(this,a)}nc.prototype={l:function(){var a=new nc,b=this.Pa&&this.Pa.l();a.Pa=b;b=this.va&&this.va.l();a.va=b;b=this.ua&&this.ua.l();a.ua=b;a.te(this.V.map(function(a){return a.l()}));return a},U:function(){for(var a=0;a<this.V.length;a++)this.V[a].kc();this.Pa.kc();this.va&&this.va.U();this.ua&&this.ua.U();a=this.va;this.va=this.ua;this.ua=a},te:fa("V")};
function oc(a,b){if(b.length){a.Pa||(a.Pa=b[0].Pa.l());for(var c=[],e=[],d=0;d<b.length;d++)mc(b[d],a.Pa,a.V,a.V,c,e);c.length&&(a.va||(a.va=new nc),oc(a.va,c));e.length&&(a.ua||(a.ua=new nc),oc(a.ua,e))}}function pc(a){var b=a.V.slice();a.va&&(b=b.concat(pc(a.va)));a.ua&&(b=b.concat(pc(a.ua)));return b}function qc(a,b){a.V=rc(b,a.V);a.va&&qc(a.va,b);a.ua&&qc(a.ua,b)}
function rc(a,b){if(!a.Pa)return b.slice();for(var c=[],e=[],d=0;d<b.length;d++)mc(b[d],a.Pa,c,e,c,e);a.va&&(c=rc(a.va,c));e=a.ua?rc(a.ua,e):[];return c.concat(e)};function sc(){this.V=[]}function tc(a){var b=new sc;b.te(a);return b}
sc.prototype={l:function(){var a=new sc;a.te(this.V.map(function(a){return a.l()}));return a},Mf:function(a){var b=new nc(this.l().V);a=new nc(a.l().V);qc(b,a);qc(a,b);a.U();qc(a,b);a.U();oc(b,pc(a));return tc(pc(b))},Ea:function(a){var b=new nc(this.l().V);a=new nc(a.l().V);b.U();qc(b,a);qc(a,b);a.U();qc(a,b);a.U();oc(b,pc(a));b.U();return tc(pc(b))},jf:function(a){var b=new nc(this.l().V);a=new nc(a.l().V);b.U();qc(a,b);a.U();qc(b,a);qc(a,b);oc(b,pc(a));b.U();return tc(pc(b))},inverse:function(){var a=
this.l();a.V.map(function(a){a.kc()});return a},te:fa("V")};function uc(){O.call(this);this.g="indexer";this.Se=[];this.Ek=[];this.Fa={}}C(uc,O);uc.prototype.add=function(a){a==t&&m(Error("Invalid object."));var b=window.JSON.stringify(a);b in this.Fa||(this.Fa[b]=this.Se.length,this.Se.push(a));return this.Fa[b]};uc.prototype.unique=v("Se");function vc(a){O.call(this);this.g="file";this.Sd=a;this.j=q}C(vc,O);function wc(){this.mb=this.r=t}wc.prototype.__defineSetter__("file",function(a){if(a==t||la(a)&&0==a.length)this.r=t;else{if(la(a)){if(1==a.length){this.r=new vc(a[0]);return}this.r=Lb(a,function(a){var c=new Q;c.r=new vc(a);return c})}else this.r=new vc(a);this.mb=t}});wc.prototype.__defineGetter__("file",function(){return!this.r?"":la(this.r)?this.r.map(function(a){return a.r.Sd}):this.r.Sd});
wc.prototype.__defineGetter__("filedata",function(){return la(this.r)?this.r.map(function(a){return a.mb}):this.mb});wc.prototype.__defineSetter__("filedata",function(a){if(a==t||la(a)&&0==a.length)this.mb=t;if(la(a))if(1==a.length)this.mb=a[0];else{var b=this.r.length,c;for(c=0;c<b;c++)this.r[c].mb=a[c]}else this.mb=a});function xc(a){if("function"==typeof a.sd)return a.sd();if(na(a))return a.split("");if(ma(a)){for(var b=[],c=a.length,e=0;e<c;e++)b.push(a[e]);return b}return Oa(a)};function yc(a,b){this.$={};this.Q=[];var c=arguments.length;if(1<c){c%2&&m(Error("Uneven number of arguments"));for(var e=0;e<c;e+=2)this.set(arguments[e],arguments[e+1])}else a&&this.Ue(a)}w=yc.prototype;w.ja=0;w.Of=0;w.ee=v("ja");w.sd=function(){zc(this);for(var a=[],b=0;b<this.Q.length;b++)a.push(this.$[this.Q[b]]);return a};function Ac(a){for(var b=0;b<a.Q.length;b++){var c=a.Q[b];if(Bc(a.$,c)&&a.$[c]==u)return q}return u}w.clear=function(){this.$={};this.Of=this.ja=this.Q.length=0};
w.remove=function(a){return Bc(this.$,a)?(delete this.$[a],this.ja--,this.Of++,this.Q.length>2*this.ja&&zc(this),q):u};function zc(a){if(a.ja!=a.Q.length){for(var b=0,c=0;b<a.Q.length;){var e=a.Q[b];Bc(a.$,e)&&(a.Q[c++]=e);b++}a.Q.length=c}if(a.ja!=a.Q.length){for(var d={},c=b=0;b<a.Q.length;)e=a.Q[b],Bc(d,e)||(a.Q[c++]=e,d[e]=1),b++;a.Q.length=c}}w.get=function(a,b){return Bc(this.$,a)?this.$[a]:b};w.set=function(a,b){Bc(this.$,a)||(this.ja++,this.Q.push(a),this.Of++);this.$[a]=b};
w.Ue=function(a){var b;if(a instanceof yc)zc(a),b=a.Q.concat(),a=a.sd();else{b=[];var c=0,e;for(e in a)b[c++]=e;a=Oa(a)}for(c=0;c<b.length;c++)this.set(b[c],a[c])};w.l=function(){return new yc(this)};w.Lf=function(){for(var a=new yc,b=0;b<this.Q.length;b++){var c=this.Q[b];a.set(this.$[c],c)}return a};function Bc(a,b){return Object.prototype.hasOwnProperty.call(a,b)};function Cc(){O.call(this);this.g="colortable";this.Fa=new yc;Ga(this,new wc)}C(Cc,O);Cc.prototype.add=function(a,b,c,e,d,f){(!x(a)||!x(c)||!x(e)||!x(d)||!x(f))&&m(Error("Invalid color table entry."));this.Fa.set(a,[b,c,e,d,f]);this.j=q};Cc.prototype.get=function(a){return this.Fa.get(a)};B("X.colortable.prototype.get",Cc.prototype.get);function Dc(a,b,c){this.x=ja(a)?a:0;this.y=ja(b)?b:0;this.d=ja(c)?c:0}Dc.prototype.l=function(){return new Dc(this.x,this.y,this.d)};function U(a,b,c){this.x=a;this.y=b;this.d=c}C(U,Dc);w=U.prototype;w.l=function(){return new U(this.x,this.y,this.d)};w.Bb=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.d*this.d)};w.scale=function(a){this.x*=a;this.y*=a;this.d*=a;return this};w.U=function(){this.x=-this.x;this.y=-this.y;this.d=-this.d;return this};w.normalize=function(){return this.scale(1/this.Bb())};w.add=function(a){this.x+=a.x;this.y+=a.y;this.d+=a.d;return this};
w.Ea=function(a){this.x-=a.x;this.y-=a.y;this.d-=a.d;return this};function Ec(a,b){var c=a.x-b.x,e=a.y-b.y,d=a.d-b.d;return Math.sqrt(c*c+e*e+d*d)}function Fc(a,b){var c=a.x-b.x,e=a.y-b.y,d=a.d-b.d;return c*c+e*e+d*d}function Gc(a,b){return new U(a.x+b.x,a.y+b.y,a.d+b.d)}function Hc(a,b){return new U(a.y*b.d-a.d*b.y,a.d*b.x-a.x*b.d,a.x*b.y-a.y*b.x)};D.m=U;w=D.m.prototype;w.l=U.prototype.l;w.Bb=U.prototype.Bb;w.scale=U.prototype.scale;w.U=U.prototype.U;w.add=U.prototype.add;w.Ea=U.prototype.Ea;w.normalize=function(){var a=this.Bb();return 0==a?this.scale(0):this.scale(1/a)};D.m.Xb=function(a,b){return a.x*b.x+a.y*b.y+a.d*b.d};D.m.ic=Hc;D.m.ff=Ec;D.m.ke=function(a,b,c){return new U(a.x+c*(b.x-a.x),a.y+c*(b.y-a.y),a.d+c*(b.d-a.d))};D.m.prototype.__defineGetter__("xx",v("x"));D.m.prototype.__defineGetter__("yy",v("y"));
D.m.prototype.__defineGetter__("zz",v("d"));B("X.vector",D.m);B("X.vector.prototype.clone",D.m.prototype.l);B("X.vector.prototype.magnitude",D.m.prototype.Bb);B("X.vector.prototype.scale",D.m.prototype.scale);B("X.vector.prototype.invert",D.m.prototype.U);B("X.vector.prototype.normalize",D.m.prototype.normalize);B("X.vector.prototype.add",D.m.prototype.add);B("X.vector.prototype.subtract",D.m.prototype.Ea);B("X.vector.dot",D.m.Xb);B("X.vector.cross",D.m.ic);B("X.vector.distance",D.m.ff);
B("X.vector.lerp",D.m.ke);function Ic(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Ic.prototype.BYTES_PER_ELEMENT=8;Ic.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Ic.prototype.toString=Array.prototype.join;if("undefined"==typeof Float64Array){try{Ic.BYTES_PER_ELEMENT=8}catch(Jc){}Ic.prototype.BYTES_PER_ELEMENT=Ic.prototype.BYTES_PER_ELEMENT;Ic.prototype.set=Ic.prototype.set;Ic.prototype.toString=Ic.prototype.toString;B("Float64Array",Ic)};function Kc(a){this.length=a.length||a;for(var b=0;b<this.length;b++)this[b]=a[b]||0}Kc.prototype.BYTES_PER_ELEMENT=4;Kc.prototype.set=function(a,b){b=b||0;for(var c=0;c<a.length&&b+c<this.length;c++)this[b+c]=a[c]};Kc.prototype.toString=Array.prototype.join;"undefined"==typeof Float32Array&&(Kc.BYTES_PER_ELEMENT=4,Kc.prototype.BYTES_PER_ELEMENT=Kc.prototype.BYTES_PER_ELEMENT,Kc.prototype.set=Kc.prototype.set,Kc.prototype.toString=Kc.prototype.toString,B("Float32Array",Kc));function Lc(){return new Float32Array(3)}function Mc(a,b,c){var e=Lc();e[0]=a;e[1]=b;e[2]=c;return e}function Nc(a,b){var c=a[0],e=a[1],d=a[2],c=1/Math.sqrt(c*c+e*e+d*d);b[0]=a[0]*c;b[1]=a[1]*c;b[2]=a[2]*c};function Oc(){return new Float32Array(4)}function Pc(a,b,c,e){var d=Oc();d[0]=a;d[1]=b;d[2]=c;d[3]=e;return d};function Qc(){return new Float32Array(16)}function Rc(){var a=Qc();a[0]=a[5]=a[10]=a[15]=1;return a}function Sc(a,b,c,e,d,f,g,h,l,j,k,n,r,s,z,y,E){a[0]=b;a[1]=c;a[2]=e;a[3]=d;a[4]=f;a[5]=g;a[6]=h;a[7]=l;a[8]=j;a[9]=k;a[10]=n;a[11]=r;a[12]=s;a[13]=z;a[14]=y;a[15]=E;return a}function Uc(a,b,c){b*=4;a[b]=c[0];a[b+1]=c[1];a[b+2]=c[2];a[b+3]=c[3]}function Vc(a,b,c){b*=4;c[0]=a[b];c[1]=a[b+1];c[2]=a[b+2];c[3]=a[b+3]}function V(a,b,c,e,d,f){a[b]=c;a[b+4]=e;a[b+8]=d;a[b+12]=f}
function Wc(a,b,c){a[b]=c[0];a[b+4]=c[1];a[b+8]=c[2];a[b+12]=c[3]}function Xc(a,b,c){c[0]=a[b];c[1]=a[b+4];c[2]=a[b+8];c[3]=a[b+12]}
function Yc(a,b,c){var e=a[0],d=a[1],f=a[2],g=a[3],h=a[4],l=a[5],j=a[6],k=a[7],n=a[8],r=a[9],s=a[10],z=a[11],y=a[12],E=a[13],F=a[14];a=a[15];var K=b[0],A=b[1],G=b[2],I=b[3],H=b[4],R=b[5],N=b[6],S=b[7],ba=b[8],aa=b[9],ca=b[10],M=b[11],T=b[12],P=b[13],Ea=b[14];b=b[15];c[0]=e*K+h*A+n*G+y*I;c[1]=d*K+l*A+r*G+E*I;c[2]=f*K+j*A+s*G+F*I;c[3]=g*K+k*A+z*G+a*I;c[4]=e*H+h*R+n*N+y*S;c[5]=d*H+l*R+r*N+E*S;c[6]=f*H+j*R+s*N+F*S;c[7]=g*H+k*R+z*N+a*S;c[8]=e*ba+h*aa+n*ca+y*M;c[9]=d*ba+l*aa+r*ca+E*M;c[10]=f*ba+j*aa+s*
ca+F*M;c[11]=g*ba+k*aa+z*ca+a*M;c[12]=e*T+h*P+n*Ea+y*b;c[13]=d*T+l*P+r*Ea+E*b;c[14]=f*T+j*P+s*Ea+F*b;c[15]=g*T+k*P+z*Ea+a*b;return c}
function Zc(a,b){var c=a[0],e=a[1],d=a[2],f=a[3],g=a[4],h=a[5],l=a[6],j=a[7],k=a[8],n=a[9],r=a[10],s=a[11],z=a[12],y=a[13],E=a[14],F=a[15],K=c*h-e*g,A=c*l-d*g,G=c*j-f*g,I=e*l-d*h,H=e*j-f*h,R=d*j-f*l,N=k*y-n*z,S=k*E-r*z,ba=k*F-s*z,aa=n*E-r*y,ca=n*F-s*y,M=r*F-s*E,T=K*M-A*ca+G*aa+I*ba-H*S+R*N;if(0==T)return u;T=1/T;b[0]=(h*M-l*ca+j*aa)*T;b[1]=(-e*M+d*ca-f*aa)*T;b[2]=(y*R-E*H+F*I)*T;b[3]=(-n*R+r*H-s*I)*T;b[4]=(-g*M+l*ba-j*S)*T;b[5]=(c*M-d*ba+f*S)*T;b[6]=(-z*R+E*G-F*A)*T;b[7]=(k*R-r*G+s*A)*T;b[8]=(g*ca-
h*ba+j*N)*T;b[9]=(-c*ca+e*ba-f*N)*T;b[10]=(z*H-y*G+F*K)*T;b[11]=(-k*H+n*G-s*K)*T;b[12]=(-g*aa+h*S-l*N)*T;b[13]=(c*aa-e*S+d*N)*T;b[14]=(-z*I+y*A-E*K)*T;b[15]=(k*I-n*A+r*K)*T;return q}function $c(a,b,c){var e=b[0],d=b[1];b=b[2];c[0]=e*a[0]+d*a[4]+b*a[8]+a[12];c[1]=e*a[1]+d*a[5]+b*a[9]+a[13];c[2]=e*a[2]+d*a[6]+b*a[10]+a[14]}
function ad(a,b,c){var e=b[0],d=b[1],f=b[2];b=b[3];c[0]=e*a[0]+d*a[4]+f*a[8]+b*a[12];c[1]=e*a[1]+d*a[5]+f*a[9]+b*a[13];c[2]=e*a[2]+d*a[6]+f*a[10]+b*a[14];c[3]=e*a[3]+d*a[7]+f*a[11]+b*a[15];return c}function bd(a,b,c,e){var d=a[1]*b+a[5]*c+a[9]*e+a[13],f=a[2]*b+a[6]*c+a[10]*e+a[14],g=a[3]*b+a[7]*c+a[11]*e+a[15];a[12]=a[0]*b+a[4]*c+a[8]*e+a[12];a[13]=d;a[14]=f;a[15]=g;return a}new Float64Array(3);new Float64Array(3);new Float64Array(4);new Float64Array(4);new Float64Array(4);new Float64Array(16);D.f={};D.f.Mg=function(a,b,c,e){c=c.Ea(b);c.normalize();e=D.m.ic(c,e);e.normalize();var d=D.m.ic(e,c);d.normalize();c.U();V(a,0,e.x,e.y,e.d,0);V(a,1,d.x,d.y,d.d,0);V(a,2,c.x,c.y,c.d,0);bd(a,-b.x,-b.y,-b.d);return a};D.f.X=function(a,b,c,e){var d=1/(b*a[3]+c*a[7]+e*a[11]+a[15]);return new D.m((b*a[0]+c*a[4]+e*a[8]+a[12])*d,(b*a[1]+c*a[5]+e*a[9]+a[13])*d,(b*a[2]+c*a[6]+e*a[10]+a[14])*d)};D.f.Hj=function(a,b,c){var e=new Float32Array(4),d=new Float32Array(4);Xc(a,b,e);Xc(a,c,d);Wc(a,b,d);Wc(a,c,e);return a};
D.f.Gj=function(a,b,c){var e=new Float32Array(4),d=new Float32Array(4);Vc(a,b,e);Vc(a,c,d);Uc(a,b,d);Uc(a,c,e);return a};D.f.td=Rc;D.f.l=function(a){var b=Qc();b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];b[9]=a[9];b[10]=a[10];b[11]=a[11];b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};
D.f.Lf=function(a,b){if(b==a){var c=a[1],e=a[2],d=a[3],f=a[6],g=a[7],h=a[11];b[1]=a[4];b[2]=a[8];b[3]=a[12];b[4]=c;b[6]=a[9];b[7]=a[13];b[8]=e;b[9]=f;b[11]=a[14];b[12]=d;b[13]=g;b[14]=h}else b[0]=a[0],b[1]=a[4],b[2]=a[8],b[3]=a[12],b[4]=a[1],b[5]=a[5],b[6]=a[9],b[7]=a[13],b[8]=a[2],b[9]=a[6],b[10]=a[10],b[11]=a[14],b[12]=a[3],b[13]=a[7],b[14]=a[11],b[15]=a[15];return b};
D.f.$h=function(a){var b=a[0],c=a[1],e=a[2],d=a[3],f=a[4],g=a[5],h=a[6],l=a[7],j=a[8],k=a[9],n=a[10],r=a[11],s=a[12],z=a[13],y=a[14];a=a[15];return(b*g-c*f)*(n*a-r*y)-(b*h-e*f)*(k*a-r*z)+(b*l-d*f)*(k*y-n*z)+(c*h-e*g)*(j*a-r*s)-(c*l-d*g)*(j*y-n*s)+(e*l-d*h)*(j*z-k*s)};D.f.U=Zc;D.f.mf=function(a,b,c,e,d){var f=b/2;b=d-e;var g=Math.sin(f);if(0==b||0==g||0==c)return a;f=Math.cos(f)/g;return Sc(a,f/c,0,0,0,0,f,0,0,0,0,-(d+e)/b,-1,0,0,-(2*e*d)/b,0)};
D.f.Fi=function(a,b,c,e,d,f,g){return Sc(a,2*f/(c-b),0,0,0,0,2*f/(d-e),0,0,(c+b)/(c-b),(d+e)/(d-e),-(g+f)/(g-f),-1,0,0,-(2*g*f)/(g-f),0)};D.f.Gi=function(a,b,c,e,d,f,g){return Sc(a,2/(c-b),0,0,0,0,2/(d-e),0,0,0,0,-2/(g-f),0,-(c+b)/(c-b),-(d+e)/(d-e),-(g+f)/(g-f),1)};D.f.multiply=Yc;D.f.Qg=ad;D.f.translate=bd;D.f.scale=function(a,b,c,e){return Sc(a,a[0]*b,a[1]*b,a[2]*b,a[3]*b,a[4]*c,a[5]*c,a[6]*c,a[7]*c,a[8]*e,a[9]*e,a[10]*e,a[11]*e,a[12],a[13],a[14],a[15])};
D.f.rotate=function(a,b,c,e,d){var f=a[0],g=a[1],h=a[2],l=a[3],j=a[4],k=a[5],n=a[6],r=a[7],s=a[8],z=a[9],y=a[10],E=a[11],F=Math.cos(b),K=Math.sin(b),A=1-F;b=c*c*A+F;var G=c*e*A+d*K,I=c*d*A-e*K,H=c*e*A-d*K,R=e*e*A+F,N=e*d*A+c*K,S=c*d*A+e*K;c=e*d*A-c*K;d=d*d*A+F;return Sc(a,f*b+j*G+s*I,g*b+k*G+z*I,h*b+n*G+y*I,l*b+r*G+E*I,f*H+j*R+s*N,g*H+k*R+z*N,h*H+n*R+y*N,l*H+r*R+E*N,f*S+j*c+s*d,g*S+k*c+z*d,h*S+n*c+y*d,l*S+r*c+E*d,a[12],a[13],a[14],a[15])};
D.f.pe=function(a,b){var c=a[4],e=a[5],d=a[6],f=a[7],g=a[8],h=a[9],l=a[10],j=a[11],k=Math.cos(b),n=Math.sin(b);a[4]=c*k+g*n;a[5]=e*k+h*n;a[6]=d*k+l*n;a[7]=f*k+j*n;a[8]=c*-n+g*k;a[9]=e*-n+h*k;a[10]=d*-n+l*k;a[11]=f*-n+j*k;return a};D.f.qe=function(a,b){var c=a[0],e=a[1],d=a[2],f=a[3],g=a[8],h=a[9],l=a[10],j=a[11],k=Math.cos(b),n=Math.sin(b);a[0]=c*k+g*-n;a[1]=e*k+h*-n;a[2]=d*k+l*-n;a[3]=f*k+j*-n;a[8]=c*n+g*k;a[9]=e*n+h*k;a[10]=d*n+l*k;a[11]=f*n+j*k;return a};
D.f.re=function(a,b){var c=a[0],e=a[1],d=a[2],f=a[3],g=a[4],h=a[5],l=a[6],j=a[7],k=Math.cos(b),n=Math.sin(b);a[0]=c*k+g*n;a[1]=e*k+h*n;a[2]=d*k+l*n;a[3]=f*k+j*n;a[4]=c*-n+g*k;a[5]=e*-n+h*k;a[6]=d*-n+l*k;a[7]=f*-n+j*k;return a};B("X.matrix.identity",D.f.td);B("X.matrix.clone",D.f.l);B("X.matrix.transpose",D.f.Lf);B("X.matrix.determinant",D.f.$h);B("X.matrix.invert",D.f.U);B("X.matrix.multiply",D.f.multiply);B("X.matrix.multiplyByVector",D.f.X);B("X.matrix.multiplyByVec4",D.f.Qg);
B("X.matrix.makePerspective",D.f.mf);B("X.matrix.makeFrustum",D.f.Fi);B("X.matrix.makeOrtho",D.f.Gi);B("X.matrix.makeLookAt",D.f.Mg);B("X.matrix.translate",D.f.translate);B("X.matrix.scale",D.f.scale);B("X.matrix.rotate",D.f.rotate);B("X.matrix.rotateX",D.f.pe);B("X.matrix.rotateY",D.f.qe);B("X.matrix.rotateZ",D.f.re);B("X.matrix.swapRows",D.f.Hj);B("X.matrix.swapCols",D.f.Gj);function cd(){O.call(this);this.g="transform";this.N=D.f.td()}C(cd,O);cd.prototype.__defineGetter__("matrix",v("N"));cd.prototype.__defineSetter__("matrix",function(a){(a==t||!(a instanceof Float32Array))&&m(Error("Invalid matrix."));this.N=a;this.p()});w=cd.prototype;w.pe=function(a){(!x(a)||-360>a||360<a)&&m(Error("Invalid angle."));D.f.pe(this.N,a*Math.PI/180);this.p()};w.qe=function(a){(!x(a)||-360>a||360<a)&&m(Error("Invalid angle."));D.f.qe(this.N,a*Math.PI/180);this.p()};
w.re=function(a){(!x(a)||-360>a||360<a)&&m(Error("Invalid angle."));D.f.re(this.N,a*Math.PI/180);this.p()};w.nh=function(a){x(a)||m(Error("Invalid distance."));D.f.translate(this.N,a,0,0);this.p()};w.oh=function(a){x(a)||m(Error("Invalid distance."));D.f.translate(this.N,0,a,0);this.p()};w.ph=function(a){x(a)||m(Error("Invalid distance."));D.f.translate(this.N,0,0,a);this.p()};function dd(a,b,c){a.N[b+4*c]*=-1;a.p()}w.gi=function(){dd(this,0,0)};w.hi=function(){dd(this,1,1)};
w.ii=function(){dd(this,2,2)};w.p=function(){this.j=q};B("X.transform",cd);B("X.transform.prototype.rotateX",cd.prototype.pe);B("X.transform.prototype.rotateY",cd.prototype.qe);B("X.transform.prototype.rotateZ",cd.prototype.re);B("X.transform.prototype.translateX",cd.prototype.nh);B("X.transform.prototype.translateY",cd.prototype.oh);B("X.transform.prototype.translateZ",cd.prototype.ph);B("X.transform.prototype.flipX",cd.prototype.gi);B("X.transform.prototype.flipY",cd.prototype.hi);
B("X.transform.prototype.flipZ",cd.prototype.ii);B("X.transform.prototype.modified",cd.prototype.p);function ed(){O.call(this);this.g="texture";this.Tb=this.Jb=this.r=t;this.Me=this.Ne=0;this.Xf=u;Ga(this,new wc)}C(ed,O);ed.prototype.__defineSetter__("rawData",function(a){this.Tb=a;this.j=q});ed.prototype.__defineSetter__("rawDataHeight",function(a){this.Me=a;this.j=q});ed.prototype.__defineSetter__("rawDataWidth",function(a){this.Ne=a;this.j=q});ed.prototype.__defineSetter__("grayscale",function(a){this.Xf=a;this.j=q});B("X.texture",ed);function W(a,b){O.call(this);this.g="triplets";this.eb=Infinity;this.$a=-Infinity;this.fb=Infinity;this.ab=-Infinity;this.gb=Infinity;this.bb=-Infinity;this.Hd=[0,0,0];this.Wf=q;this.R=0;this.Y=new Float32Array(a);b!=t&&(this.Y=b.Y.subarray(0,b.Y.length),this.R=this.Y.length,this.eb=b.eb,this.$a=b.$a,this.fb=b.fb,this.ab=b.ab,this.gb=b.gb,this.bb=b.bb,this.Hd=b.Hd.slice(),this.Wf=u)}C(W,O);w=W.prototype;
w.add=function(a,b,c){this.eb=Math.min(this.eb,a);this.$a=Math.max(this.$a,a);this.fb=Math.min(this.fb,b);this.ab=Math.max(this.ab,b);this.gb=Math.min(this.gb,c);this.bb=Math.max(this.bb,c);this.Hd=[(this.eb+this.$a)/2,(this.fb+this.ab)/2,(this.gb+this.bb)/2];this.Wf=u;this.j=q;this.Y[this.R++]=a;this.Y[this.R++]=b;this.Y[this.R++]=c;return this.R/3};w.Cb=function(){if(this.R!=this.Y.length){var a=new Float32Array(this.R);a.set(this.Y.subarray(0,this.R));this.Y=a}};
w.get=function(a){a*=3;return[this.Y[a],this.Y[a+1],this.Y[a+2]]};w.remove=function(){m(Error("Not implemented."))};w.clear=function(){this.Y=new Float32Array(this.Y.length);this.j=q};W.prototype.__defineGetter__("count",function(){this.Cb();return this.Y.length/3});W.prototype.__defineGetter__("length",function(){this.Cb();return this.Y.length});B("X.triplets",W);B("X.triplets.prototype.add",W.prototype.add);B("X.triplets.prototype.resize",W.prototype.Cb);B("X.triplets.prototype.get",W.prototype.get);
B("X.triplets.prototype.remove",W.prototype.remove);B("X.triplets.prototype.clear",W.prototype.clear);function fd(){this.Da=gd;this.ca=new cd;this.u=[1,1,1];this.Fc=this.C=this.la=this.q=this.h=t;this.Ac=[];this.L=q;this.zc=this.ad=1;this.qc=t;this.Sc=u;this.qa=1;this.sa=0;this.$c=q}var gd="TRIANGLES";fd.prototype.__defineSetter__("type",function(a){return this.Da=a});fd.prototype.__defineGetter__("type",v("Da"));fd.prototype.__defineGetter__("texture",function(){this.C||(this.C=new ed);return this.C});fd.prototype.__defineGetter__("transform",v("ca"));fd.prototype.__defineGetter__("points",v("h"));
fd.prototype.__defineSetter__("points",fa("h"));fd.prototype.__defineGetter__("normals",v("q"));fd.prototype.__defineSetter__("normals",fa("q"));fd.prototype.__defineGetter__("colors",v("la"));fd.prototype.__defineSetter__("colors",fa("la"));fd.prototype.__defineGetter__("color",v("u"));fd.prototype.__defineSetter__("color",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid color."));for(var b=this.c,c=b.length,e=0,e=0;e<c;e++)b[e].color=a;this.u=a;this.j=q});
fd.prototype.__defineGetter__("opacity",v("qa"));fd.prototype.__defineSetter__("opacity",function(a){(!x(a)||1<a||0>a)&&m(Error("Invalid opacity."));for(var b=this.c,c=b.length,e=0,e=0;e<c;e++)b[e]!=t&&(b[e].opacity=a);this.qa=a;this.j=q});fd.prototype.__defineGetter__("caption",v("qc"));fd.prototype.__defineSetter__("caption",function(a){this.qc=a;this.j=q});fd.prototype.__defineGetter__("visible",v("L"));
fd.prototype.__defineSetter__("visible",function(a){for(var b=this.c,c=b.length,e=0,e=0;e<c;e++)b[e]!=t&&(b[e].visible=a);this.L=a;this.j=q});fd.prototype.__defineGetter__("pointsize",v("ad"));fd.prototype.__defineSetter__("pointsize",function(a){x(a)||m(Error("Invalid point size."));this.ad=a;this.j=q});fd.prototype.__defineGetter__("magicmode",v("Sc"));fd.prototype.__defineSetter__("magicmode",function(a){"boolean"!=typeof a&&m(Error("Invalid magic mode setting."));this.Sc=a;this.j=q});
fd.prototype.__defineGetter__("linewidth",v("zc"));fd.prototype.__defineSetter__("linewidth",function(a){x(a)||m(Error("Invalid line width."));this.zc=a;this.j=q});fd.prototype.__defineGetter__("pickable",v("$c"));fd.prototype.__defineSetter__("pickable",function(a){"boolean"!=typeof a&&m(Error("Invalid pickable setting."));this.$c=a;this.j=q});fd.prototype.__defineGetter__("textureCoordinateMap",v("Fc"));fd.prototype.__defineSetter__("textureCoordinateMap",fa("Hk"));function hd(){this.cb=Infinity;this.fa=this.ma=-Infinity;this.ga=Infinity;this.Ob=[0,0,0];this.Mb=[1,1,1]}hd.prototype.__defineGetter__("lowerThreshold",v("fa"));hd.prototype.__defineSetter__("lowerThreshold",fa("fa"));hd.prototype.__defineGetter__("upperThreshold",v("ga"));hd.prototype.__defineSetter__("upperThreshold",fa("ga"));hd.prototype.__defineGetter__("min",v("cb"));hd.prototype.__defineGetter__("max",v("ma"));hd.prototype.__defineGetter__("minColor",v("Ob"));
hd.prototype.__defineSetter__("minColor",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid min. color."));this.Ob=a});hd.prototype.__defineGetter__("maxColor",v("Mb"));hd.prototype.__defineSetter__("maxColor",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid max. color."));this.Mb=a});function id(){O.call(this);this.g="scalars";this.Pc=this.F=t;this.jg=q;this.Be=0;Ga(this,new wc);Ga(this,new hd);this.Ob=[0,1,0];this.Mb=[1,0,0]}C(id,O);id.prototype.__defineGetter__("array",v("F"));id.prototype.__defineSetter__("array",function(a){this.Pc=this.F=a;this.j=q});id.prototype.__defineGetter__("interpolation",v("Be"));id.prototype.__defineSetter__("interpolation",fa("Be"));B("X.scalars",id);function Y(a){O.call(this);this.g="object";this.c=[];this.G=this.Aa=t;Ga(this,new fd);a!=t&&this.gc(a)}C(Y,O);
Y.prototype.gc=function(a){this.Da=a.Da;this.ca=new cd;this.ca.N=new Float32Array(a.ca.N);this.u=a.u.slice();a.h&&(this.h=new W(a.h.length,a.h));a.q&&(this.q=new W(a.q.length,a.q));a.la&&(this.la=new W(a.la.length,a.la));this.C=a.C;this.Fc=a.Fc;a.r&&(this.r=new vc((new String(a.r.Sd)).toString()));this.qa=a.qa;this.c.length=0;var b=a.c;if(b)for(var c=b.length,e=0,e=0;e<c;e++)this.c.push(new D[b[e].g](b[e]));this.L=a.L;this.ad=a.ad;this.zc=a.zc;a.qc&&(this.qc=(new String(a.qc)).toString());this.Sc=
a.Sc;this.$c=a.$c;this.Ac=a.Ac.slice();this.j=q};Y.prototype.__defineGetter__("colortable",function(){this.Aa||(this.Aa=new Cc);return this.Aa});Y.prototype.__defineGetter__("scalars",function(){this.G||(this.G=new id);return this.G});Y.prototype.__defineGetter__("children",v("c"));Y.prototype.p=function(){var a=new jd;a.K=this;this.dispatchEvent(a)};Y.prototype.remove=function(){var a=new kd;a.K=this;this.dispatchEvent(a)};
function ld(a,b){(a==t||b==t||!(a instanceof Y)||!(b instanceof Y))&&m(Error("Fatal: Two valid X.objects are required for comparison."));return 1==a.qa?-1:1==b.qa?1:a.sa!=t&&b.sa!=t&&a.sa>b.sa?-1:1}B("X.object",Y);B("X.object.prototype.modified",Y.prototype.p);B("X.object.prototype.remove",Y.prototype.remove);function md(){}function nd(a){for(var b=a.h.count,c=[],e=0,e=0;e<b;e+=3){var d=a.h.get(e),f=a.h.get(e+1),g=a.h.get(e+2),h=a.q.get(e),l=a.q.get(e+1),j=a.q.get(e+2),k=a.u;a.la&&0<a.la.length&&(k=a.la.get(e));var n=[];n.push(new jc(d,h));n.push(new jc(f,l));n.push(new jc(g,j));c.push(new lc(n,k))}return tc(c)}
function od(a,b){(b==t||!(b instanceof sc))&&m(Error("Invalid CSG object."));var c=new uc,e=[];Lb(b.V,function(a){var b=[],g=a.ue,b=Lb(a.Eb,function(a){a.color=g;return c.add(a)});for(a=a=2;a<b.length;a++)e.push([b[0],b[a-1],b[a]])}.bind(a));a.Dh=Lb(c.unique(),function(a){return[a.Qa.x(),a.Qa.y(),a.Qa.d()]});a.Ch=Lb(c.unique(),function(a){return[a.ra.x(),a.ra.y(),a.ra.d()]});a.Bh=Lb(c.unique(),function(a){return!a.color?t:[a.color[0],a.color[1],a.color[2]]});a.h=new W(9*e.length);a.q=new W(9*e.length);
a.la=new W(9*e.length);Lb(e,function(a){var b=a[0],c=a[1];a=a[2];var e=this.Dh,l=this.Ch,j=this.Bh;this.h.add(e[b][0],e[b][1],e[b][2]);this.h.add(e[c][0],e[c][1],e[c][2]);this.h.add(e[a][0],e[a][1],e[a][2]);this.q.add(l[b][0],l[b][1],l[b][2]);this.q.add(l[c][0],l[c][1],l[c][2]);this.q.add(l[a][0],l[a][1],l[a][2]);j[b]&&this.la.add(j[b][0],j[b][1],j[b][2]);j[c]&&this.la.add(j[c][0],j[c][1],j[c][2]);j[a]&&this.la.add(j[a][0],j[a][1],j[a][2])}.bind(a));0==a.la.R&&(a.la=t);a.Da=gd}
md.prototype.Mf=function(a){(a==t||!(a instanceof sc)&&!(a instanceof Y))&&m(Error("Invalid object."));var b=a;a instanceof Y&&(b=nd(b));a=new Y;Ga(a,new md);od(a,nd(this).Mf(b));return a};md.prototype.Ea=function(a){(a==t||!(a instanceof sc)&&!(a instanceof Y))&&m(Error("Invalid object."));var b=a;a instanceof Y&&(b=nd(b));a=new Y;Ga(a,new md);od(a,nd(this).Ea(b));return a};
md.prototype.jf=function(a){(a==t||!(a instanceof sc)&&!(a instanceof Y))&&m(Error("Invalid object."));var b=a;a instanceof Y&&(b=nd(b));a=new Y;Ga(a,new md);od(a,nd(this).jf(b));return a};md.prototype.inverse=function(){var a=new Y;Ga(a,new md);od(a,nd(this).inverse());return a};B("X.constructable",md);B("X.constructable.prototype.intersect",md.prototype.jf);B("X.constructable.prototype.inverse",md.prototype.inverse);B("X.constructable.prototype.subtract",md.prototype.Ea);
B("X.constructable.prototype.union",md.prototype.Mf);function pd(a){Rb.call(this,a);this.g="event"}C(pd,Rb);var qd=hc("pan"),rd=hc("rotate"),sd=hc("zoom"),td=hc("scroll");hc("render");var ud=hc("resetview"),vd=hc("windowlevel"),wd=hc("modified"),xd=hc("remove"),yd=hc("progress"),zd=hc("hover"),Ad=hc("hover_end"),Bd=hc("computing"),Cd=hc("computing_end"),Dd=hc("computing_progress");function Ed(){pd.call(this,vd);this.Ge=this.Te=0}C(Ed,pd);function Fd(){pd.call(this,qd);this.sa=new D.m(0,0,0)}C(Fd,pd);
function Gd(){pd.call(this,rd);this.sa=new D.m(0,0,0)}C(Gd,pd);function Hd(){pd.call(this,sd);this.Za=this.nb=u}C(Hd,pd);function Id(){pd.call(this,td);this.Z=u}C(Id,pd);function Jd(){pd.call(this,zd);this.Yd=this.Xd=0}C(Jd,pd);function Kd(){pd.call(this,Ad)}C(Kd,pd);function Ld(){pd.call(this,ud)}C(Ld,pd);function jd(){pd.call(this,wd);this.B=this.K=t}C(jd,pd);function kd(){pd.call(this,xd);this.B=this.K=t}C(kd,pd);function Md(){pd.call(this,yd);this.od=0}C(Md,pd);
function Nd(){pd.call(this,Bd);this.K=t}C(Nd,pd);function Od(){pd.call(this,Dd);this.od=0}C(Od,pd);function Pd(){pd.call(this,Cd);this.K=t}C(Pd,pd);B("X.event.events.PAN",qd);B("X.event.events.ROTATE",rd);B("X.event.events.ZOOM",sd);B("X.event.events.SCROLL",td);function Qd(a,b,c){a==t&&m(Error("Invalid GL Buffer."));b==t&&m(Error("Invalid number of items."));c==t&&m(Error("Invalid item size."));O.call(this);this.g="buffer";this.M=a;this.Kb=b;this.Lb=c}C(Qd,O);var Rd;function Sd(a,b){var c;c=a.className;c=na(c)&&c.match(/\S+/g)||[];for(var e=Ob(arguments,1),d=c.length+e.length,f=c,g=0;g<e.length;g++)0<=Ib(f,e[g])||f.push(e[g]);a.className=c.join(" ");return c.length==d};function Td(a,b){this.width=a;this.height=b}w=Td.prototype;w.l=function(){return new Td(this.width,this.height)};w.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};w.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};w.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};w.scale=function(a,b){var c=x(b)?b:a;this.width*=a;this.height*=c;return this};var Ud=!J||J&&9<=Eb;!lb&&!J||J&&J&&9<=Eb||lb&&Cb("1.9.1");J&&Cb("9");function Vd(a,b){this.x=ja(a)?a:0;this.y=ja(b)?b:0}w=Vd.prototype;w.l=function(){return new Vd(this.x,this.y)};function Wd(a,b){return new Vd(a.x-b.x,a.y-b.y)}w.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};w.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};w.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};
w.translate=function(a,b){a instanceof Vd?(this.x+=a.x,this.y+=a.y):(this.x+=a,x(b)&&(this.y+=b));return this};w.scale=function(a,b){var c=x(b)?b:a;this.x*=a;this.y*=c;return this};function Xd(a){return a?new Yd(Zd(a)):Rd||(Rd=new Yd)}function $d(a){return na(a)?document.getElementById(a):a}var ae={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function be(a,b,c){return ce(document,arguments)}
function ce(a,b){var c=b[0],e=b[1];if(!Ud&&e&&(e.name||e.type)){c=["<",c];e.name&&c.push(' name="',Sa(e.name),'"');if(e.type){c.push(' type="',Sa(e.type),'"');var d={};Ra(d,e);delete d.type;e=d}c.push(">");c=c.join("")}var f=a.createElement(c);e&&(na(e)?f.className=e:la(e)?Sd.apply(t,[f].concat(e)):Na(e,function(a,b){"style"==b?f.style.cssText=a:"class"==b?f.className=a:"for"==b?f.htmlFor=a:b in ae?f.setAttribute(ae[b],a):0==b.lastIndexOf("aria-",0)||0==b.lastIndexOf("data-",0)?f.setAttribute(b,a):
f[b]=a}));if(2<b.length){e=function(b){b&&f.appendChild(na(b)?a.createTextNode(b):b)};for(c=2;c<b.length;c++){var g=b[c];if(ma(g)&&!(pa(g)&&0<g.nodeType)){var d=Jb,h;a:{if((h=g)&&"number"==typeof h.length){if(pa(h)){h="function"==typeof h.item||"string"==typeof h.item;break a}if(oa(h)){h="function"==typeof h.item;break a}}h=u}if(h)if(h=g.length,0<h){for(var l=Array(h),j=0;j<h;j++)l[j]=g[j];g=l}else g=[];d(g,e)}else e(g)}}return f}function de(a){a&&a.parentNode&&a.parentNode.removeChild(a)}
function ee(a){for(;a&&1!=a.nodeType;)a=a.nextSibling;return a}function fe(a,b){if(a.contains&&1==b.nodeType)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a}function Zd(a){return 9==a.nodeType?a:a.ownerDocument||a.document}function Yd(a){this.da=a||ga.document||document}w=Yd.prototype;w.fe=Xd;w.s=function(a){return na(a)?this.da.getElementById(a):a};w.th=Yd.prototype.s;
w.Ic=function(a,b,c){return ce(this.da,arguments)};w.createElement=function(a){return this.da.createElement(a)};w.createTextNode=function(a){return this.da.createTextNode(String(a))};function ge(a){return"CSS1Compat"==a.da.compatMode}function he(a){var b=a.da;a=!mb&&"CSS1Compat"==b.compatMode?b.documentElement:b.body;b=b.parentWindow||b.defaultView;return J&&Cb("10")&&b.pageYOffset!=a.scrollTop?new Vd(a.scrollLeft,a.scrollTop):new Vd(b.pageXOffset||a.scrollLeft,b.pageYOffset||a.scrollTop)}
w.appendChild=function(a,b){a.appendChild(b)};w.contains=fe;function ie(a,b,c,e){this.top=a;this.right=b;this.bottom=c;this.left=e}w=ie.prototype;w.l=function(){return new ie(this.top,this.right,this.bottom,this.left)};w.contains=function(a){return!this||!a?u:a instanceof ie?a.left>=this.left&&a.right<=this.right&&a.top>=this.top&&a.bottom<=this.bottom:a.x>=this.left&&a.x<=this.right&&a.y>=this.top&&a.y<=this.bottom};
w.ceil=function(){this.top=Math.ceil(this.top);this.right=Math.ceil(this.right);this.bottom=Math.ceil(this.bottom);this.left=Math.ceil(this.left);return this};w.floor=function(){this.top=Math.floor(this.top);this.right=Math.floor(this.right);this.bottom=Math.floor(this.bottom);this.left=Math.floor(this.left);return this};w.round=function(){this.top=Math.round(this.top);this.right=Math.round(this.right);this.bottom=Math.round(this.bottom);this.left=Math.round(this.left);return this};
w.translate=function(a,b){a instanceof Vd?(this.left+=a.x,this.right+=a.x,this.top+=a.y,this.bottom+=a.y):(this.left+=a,this.right+=a,x(b)&&(this.top+=b,this.bottom+=b));return this};w.scale=function(a,b){var c=x(b)?b:a;this.left*=a;this.right*=a;this.top*=c;this.bottom*=c;return this};function je(a,b,c,e){this.left=a;this.top=b;this.width=c;this.height=e}w=je.prototype;w.l=function(){return new je(this.left,this.top,this.width,this.height)};w.Ig=function(a){var b=Math.max(this.left,a.left),c=Math.min(this.left+this.width,a.left+a.width);if(b<=c){var e=Math.max(this.top,a.top);a=Math.min(this.top+this.height,a.top+a.height);if(e<=a)return this.left=b,this.top=e,this.width=c-b,this.height=a-e,q}return u};
w.contains=function(a){return a instanceof je?this.left<=a.left&&this.left+this.width>=a.left+a.width&&this.top<=a.top&&this.top+this.height>=a.top+a.height:a.x>=this.left&&a.x<=this.left+this.width&&a.y>=this.top&&a.y<=this.top+this.height};function ke(a,b){var c=b.x<a.left?a.left-b.x:Math.max(b.x-(a.left+a.width),0),e=b.y<a.top?a.top-b.y:Math.max(b.y-(a.top+a.height),0);return c*c+e*e}w.ff=function(a){return Math.sqrt(ke(this,a))};
w.ceil=function(){this.left=Math.ceil(this.left);this.top=Math.ceil(this.top);this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};w.floor=function(){this.left=Math.floor(this.left);this.top=Math.floor(this.top);this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};w.round=function(){this.left=Math.round(this.left);this.top=Math.round(this.top);this.width=Math.round(this.width);this.height=Math.round(this.height);return this};
w.translate=function(a,b){a instanceof Vd?(this.left+=a.x,this.top+=a.y):(this.left+=a,x(b)&&(this.top+=b));return this};w.scale=function(a,b){var c=x(b)?b:a;this.left*=a;this.width*=a;this.top*=c;this.height*=c;return this};function le(a,b){var c=Zd(a);return c.defaultView&&c.defaultView.getComputedStyle&&(c=c.defaultView.getComputedStyle(a,t))?c[b]||c.getPropertyValue(b)||"":""}function me(a,b){return le(a,b)||(a.currentStyle?a.currentStyle[b]:t)||a.style&&a.style[b]}function ne(a){a=a?Zd(a):document;return J&&!(J&&9<=Eb)&&!ge(Xd(a))?a.body:a.documentElement}
function oe(a){var b=a.getBoundingClientRect();J&&(a=a.ownerDocument,b.left-=a.documentElement.clientLeft+a.body.clientLeft,b.top-=a.documentElement.clientTop+a.body.clientTop);return b}
function pe(a){if(J&&!(J&&8<=Eb))return a.offsetParent;var b=Zd(a),c=me(a,"position"),e="fixed"==c||"absolute"==c;for(a=a.parentNode;a&&a!=b;a=a.parentNode)if(c=me(a,"position"),e=e&&"static"==c&&a!=b.documentElement&&a!=b.body,!e&&(a.scrollWidth>a.clientWidth||a.scrollHeight>a.clientHeight||"fixed"==c||"absolute"==c||"relative"==c))return a;return t}
function qe(a){for(var b=new ie(0,Infinity,Infinity,0),c=Xd(a),e=c.da.body,d=c.da.documentElement,f=!mb&&"CSS1Compat"==c.da.compatMode?c.da.documentElement:c.da.body;a=pe(a);)if((!J||0!=a.clientWidth)&&(!mb||0!=a.clientHeight||a!=e)&&a!=e&&a!=d&&"visible"!=me(a,"overflow")){var g=re(a),h;h=a;if(lb&&!Cb("1.9")){var l=parseFloat(le(h,"borderLeftWidth"));if(se(h))var j=h.offsetWidth-h.clientWidth-l-parseFloat(le(h,"borderRightWidth")),l=l+j;h=new Vd(l,parseFloat(le(h,"borderTopWidth")))}else h=new Vd(h.clientLeft,
h.clientTop);g.x+=h.x;g.y+=h.y;b.top=Math.max(b.top,g.y);b.right=Math.min(b.right,g.x+a.clientWidth);b.bottom=Math.min(b.bottom,g.y+a.clientHeight);b.left=Math.max(b.left,g.x)}e=f.scrollLeft;f=f.scrollTop;b.left=Math.max(b.left,e);b.top=Math.max(b.top,f);c=(c.da.parentWindow||c.da.defaultView||window).document;c="CSS1Compat"==c.compatMode?c.documentElement:c.body;c=new Td(c.clientWidth,c.clientHeight);b.right=Math.min(b.right,e+c.width);b.bottom=Math.min(b.bottom,f+c.height);return 0<=b.top&&0<=b.left&&
b.bottom>b.top&&b.right>b.left?b:t}
function re(a){var b,c=Zd(a),e=me(a,"position"),d=lb&&c.getBoxObjectFor&&!a.getBoundingClientRect&&"absolute"==e&&(b=c.getBoxObjectFor(a))&&(0>b.screenX||0>b.screenY),f=new Vd(0,0),g=ne(c);if(a==g)return f;if(a.getBoundingClientRect)b=oe(a),a=he(Xd(c)),f.x=b.left+a.x,f.y=b.top+a.y;else if(c.getBoxObjectFor&&!d)b=c.getBoxObjectFor(a),a=c.getBoxObjectFor(g),f.x=b.screenX-a.screenX,f.y=b.screenY-a.screenY;else{b=a;do{f.x+=b.offsetLeft;f.y+=b.offsetTop;b!=a&&(f.x+=b.clientLeft||0,f.y+=b.clientTop||0);
if(mb&&"fixed"==me(b,"position")){f.x+=c.body.scrollLeft;f.y+=c.body.scrollTop;break}b=b.offsetParent}while(b&&b!=a);if(jb||mb&&"absolute"==e)f.y-=c.body.offsetTop;for(b=a;(b=pe(b))&&b!=c.body&&b!=g;)if(f.x-=b.scrollLeft,!jb||"TR"!=b.tagName)f.y-=b.scrollTop}return f}
function te(a){var b=new Vd;if(1==a.nodeType){if(a.getBoundingClientRect){var c=oe(a);b.x=c.left;b.y=c.top}else{var c=he(Xd(a)),e=re(a);b.x=e.x-c.x;b.y=e.y-c.y}if(lb&&!Cb(12)){var d;J?d="-ms-transform":mb?d="-webkit-transform":jb?d="-o-transform":lb&&(d="-moz-transform");var f;d&&(f=me(a,d));f||(f=me(a,"transform"));f?(a=f.match(ue),a=!a?new Vd(0,0):new Vd(parseFloat(a[1]),parseFloat(a[2]))):a=new Vd(0,0);b=new Vd(b.x+a.x,b.y+a.y)}}else d=oa(a.ki),f=a,a.targetTouches?f=a.targetTouches[0]:d&&a.jb.targetTouches&&
(f=a.jb.targetTouches[0]),b.x=f.clientX,b.y=f.clientY;return b}function ve(a,b){"number"==typeof a&&(a=(b?Math.round(a):a)+"px");return a}function we(a){if("none"!=me(a,"display"))return xe(a);var b=a.style,c=b.display,e=b.visibility,d=b.position;b.visibility="hidden";b.position="absolute";b.display="inline";a=xe(a);b.display=c;b.position=d;b.visibility=e;return a}
function xe(a){var b=a.offsetWidth,c=a.offsetHeight,e=mb&&!b&&!c;return(!ja(b)||e)&&a.getBoundingClientRect?(a=oe(a),new Td(a.right-a.left,a.bottom-a.top)):new Td(b,c)}function ye(a,b){a.style.display=b?"":"none"}function se(a){return"rtl"==me(a,"direction")}function ze(a,b){if(/^\d+px?$/.test(b))return parseInt(b,10);var c=a.style.left,e=a.runtimeStyle.left;a.runtimeStyle.left=a.currentStyle.left;a.style.left=b;var d=a.style.pixelLeft;a.style.left=c;a.runtimeStyle.left=e;return d}
function Ae(a,b){var c=a.currentStyle?a.currentStyle[b]:t;return c?ze(a,c):0}var Be={thin:2,medium:4,thick:6};function Ce(a,b){if("none"==(a.currentStyle?a.currentStyle[b+"Style"]:t))return 0;var c=a.currentStyle?a.currentStyle[b+"Width"]:t;return c in Be?Be[c]:ze(a,c)}var ue=/matrix\([0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, [0-9\.\-]+, ([0-9\.\-]+)p?x?, ([0-9\.\-]+)p?x?\)/;function De(a,b){ic.call(this);this.D=a;var c=pa(this.D)&&1==this.D.nodeType?this.D:this.D?this.D.body:t;this.Di=!!c&&se(c);this.Rk=L(this.D,lb?"DOMMouseScroll":"mousewheel",this,b)}C(De,ic);
De.prototype.handleEvent=function(a){var b=0,c=0,e=0;a=a.jb;if("mousewheel"==a.type){c=1;if(J||mb&&(cb||Cb("532.0")))c=40;e=Ee(-a.wheelDelta,c);ja(a.wheelDeltaX)?(b=Ee(-a.wheelDeltaX,c),c=Ee(-a.wheelDeltaY,c)):c=e}else e=a.detail,100<e?e=3:-100>e&&(e=-3),ja(a.axis)&&a.axis===a.HORIZONTAL_AXIS?b=e:c=e;x(this.Ng)&&(b=Math.min(Math.max(b,-this.Ng),this.Ng));x(this.Og)&&(c=Math.min(Math.max(c,-this.Og),this.Og));this.Di&&(b=-b);b=new Fe(e,a,b,c);this.dispatchEvent(b)};
function Ee(a,b){return mb&&(bb||eb)&&0!=a%b?a:a/b}function Fe(a,b,c,e){b&&this.wa(b,p);this.type="mousewheel";this.detail=a;this.Mk=c;this.Jc=e}C(Fe,Tb);J||mb&&Cb("525");function Ge(a){O.call(this);this.g="interactor";this.Ja=a;this.He=this.dg=this.cg=this.eg=this.bg=this.fg=t;this.Qd=q;this.Ub=this.Nb=this.ob=u;this.pa=[0,0];this.Ce=new D.m(0,0,0);this.Qc=new D.m(0,0,0);this.Kg=0;this.mg=this.Md=t;this.lg=u;this.O={MOUSEWHEEL_ENABLED:q,MOUSECLICKS_ENABLED:q,KEYBOARD_ENABLED:q,HOVERING_ENABLED:q,CONTEXTMENU_ENABLED:u,TOUCH_ENABLED:q,TOUCH_BOUNCING_ENABLED:u}}C(Ge,O);Ge.prototype.__defineGetter__("config",v("O"));Ge.prototype.__defineGetter__("leftButtonDown",v("ob"));
Ge.prototype.__defineGetter__("middleButtonDown",v("Nb"));Ge.prototype.__defineGetter__("rightButtonDown",v("Ub"));
Ge.prototype.wa=function(){this.O.MOUSEWHEEL_ENABLED?(this.He=new De(this.Ja),this.fg=L(this.He,"mousewheel",this.wd.bind(this))):(bc(this.fg),this.He=t);this.O.MOUSECLICKS_ENABLED?(this.bg=L(this.Ja,"mousedown",this.Pi.bind(this)),this.eg=L(this.Ja,"mouseup",this.Ui.bind(this))):(bc(this.bg),bc(this.eg));this.Ja.oncontextmenu=this.O.CONTEXTMENU_ENABLED?t:function(){return u};window.onkeydown=this.O.KEYBOARD_ENABLED?this.Ug.bind(this):t;this.O.TOUCH_ENABLED?(this.O.TOUCH_BOUNCING_ENABLED||document.body.addEventListener("touchmove",
function(a){a.preventDefault()},u),this.Lh=L(this.Ja,"touchstart",this.ij.bind(this)),this.Kh=L(this.Ja,"touchmove",this.gj.bind(this)),this.Jh=L(this.Ja,"touchend",this.cj.bind(this))):(bc(this.Lh),bc(this.Kh),bc(this.Jh));bc(this.cg);bc(this.dg);this.cg=L(this.Ja,"mousemove",this.Ri.bind(this));this.dg=L(this.Ja,"mouseout",this.Si.bind(this))};
Ge.prototype.Pi=function(a){0==a.button?this.ob=q:1==a.button?this.Nb=q:2==a.button&&(this.Ub=q);eval("this.onMouseDown("+this.ob+","+this.Nb+","+this.Ub+")");He(this);a.preventDefault()};Ge.prototype.Oi=ea();Ge.prototype.Ui=function(a){0==a.button?this.ob=u:1==a.button?this.Nb=u:2==a.button&&(this.Ub=u);eval("this.onMouseUp("+this.ob+","+this.Nb+","+this.Ub+")");He(this);a.preventDefault()};Ge.prototype.__defineGetter__("mousePosition",v("pa"));w=Ge.prototype;w.Ti=ea();
w.Si=function(a){this.Qd=u;this.O.KEYBOARD_ENABLED&&(window.onkeydown=t);this.Ub=this.Nb=this.ob=u;He(this);this.Ce=new D.m(0,0,0);a.preventDefault()};w.Qi=ea();w.ij=function(a){a.preventDefault();a.wa(a.jb.targetTouches[0],a.currentTarget);eval("this.onTouchStart("+a.clientX+","+a.clientY+")");this.Qc=new D.m(a.clientX,a.clientY,0);this.mg=setTimeout(this.ej.bind(this,a),500)};w.hj=ea();
w.ej=function(a){eval("this.onTouchHover("+a.clientX+","+a.clientY+")");a=new Hd;a.nb=q;a.Za=this instanceof Ie;this.dispatchEvent(a);this.Ud=q};w.dj=ea();function Je(a){clearTimeout(a.mg);if(a.Ud){var b=new Hd;b.nb=u;b.Za=a instanceof Ie;a.dispatchEvent(b)}a.Ud=u}w.cj=function(a){a.preventDefault();eval("this.onTouchEnd()");Je(this)};w.bj=ea();
w.gj=function(a){a.preventDefault();this.Ud||Je(this);this.touchmoveEvent=a=a.jb;eval("this.onTouchMove(this['touchmoveEvent'])");var b=a.targetTouches;if(1==b.length){a=b[0];var c=[a.clientX,a.clientY];a=new D.m(c[0],c[1],0);var b=c[0]>3*this.Ja.clientWidth/4,e=c[0]<this.Ja.clientWidth/4,d=c[1]<this.Ja.clientHeight/4,c=c[1]>3*this.Ja.clientHeight/4,c=!b&&!e&&!d&&!c,d=this.Qc.Ea(a);this.Qc=a.l();if(this.Ud)a=new Fd,5<d.x?d.x=1:-5>d.x&&(d.x=-1),5<d.y?d.y=1:-5>d.y&&(d.y=-1),a.sa=d,this.dispatchEvent(a);
else if(this instanceof Ke&&(b||e))a=new Id,a.Z=0>d.y,this.dispatchEvent(a);else if(this instanceof Ie||c)d.scale(3),a=new Gd,a.sa=d,this.dispatchEvent(a)}else 2==b.length&&(a=b[0],b=b[1],a=[a.clientX,a.clientY],b=[b.clientX,b.clientY],a=new D.m(a[0],a[1],0),b=new D.m(b[0],b[1],0),d=Fc(a,b),b=d-this.Kg,this.Kg=d,this.Qc.Ea(a),this.Qc=a.l(),10<Math.abs(b)&&(a=new Hd,a.nb=0<b,a.Za=this instanceof Ie,this.dispatchEvent(a)))};w.fj=ea();
w.Ri=function(a){this.mousemoveEvent=a;eval("this.onMouseMove(this['mousemoveEvent'])");this.Qd=q;this.O.KEYBOARD_ENABLED&&window.onkeydown==t&&(window.onkeydown=this.Ug.bind(this));a.preventDefault();var b=a.shiftKey;this.lg=b;this.pa=[a.offsetX,a.offsetY];var c=new D.m(this.pa[0],this.pa[1],0);a=this.Ce.Ea(c);this.Ce=c.l();this.O.HOVERING_ENABLED&&((0<Math.abs(a.x)||0<Math.abs(a.y)||this.Nb||this.ob||this.Ub)&&He(this),this.Md=setTimeout(function(){He(this);var a=new Jd;a.Xd=c.x;a.Yd=c.y;this.dispatchEvent(a);
this.Md=t}.bind(this),300));0!=a.Bb()&&(this.ob&&!b?(b=new Gd,a.scale(3),b.sa=a,this.dispatchEvent(b)):this.Nb||this.ob&&b?(b=new Fd,b.sa=a,this.dispatchEvent(b)):this.Ub&&(b=new Hd,b.nb=0<a.y,b.Za=u,this.dispatchEvent(b)))};function He(a){a.Md&&clearTimeout(a.Md);a.dispatchEvent(new Kd)}w.Vi=ea();w.wd=function(a){this.mouseWheelEvent=a;eval("this.onMouseWheel(this['mouseWheelEvent'])");He(this);a.preventDefault()};w.Mi=ea();
w.Ug=function(a){if(this.Qd){this.keyEvent=a;eval("this.onKey(this['keyEvent'])");He(this);var b=a.altKey,c=a.ctrlKey,e=a.metaKey,d=a.shiftKey,f=a.keyCode;82==f&&!b&&!c&&!e&&!d?(a.preventDefault(),a=new Ld,this.dispatchEvent(a)):37<=f&&40>=f&&(a.preventDefault(),d?a=new Fd:b?a=new Hd:(a=new Gd,this instanceof Ke&&(a=new Id)),a&&(c=new D.m(0,0,0),37==f?(c.x=5,a.Z=u,b&&(a.Z=q,a.nb=q,a.Za=u)):39==f?(c.x=-5,a.Z=q,b&&(a.nb=u,a.Za=u)):38==f?(c.y=5,a.Z=q,b&&(a.nb=q,a.Za=q)):40==f&&(c.y=-5,a.Z=u,b&&(a.nb=
u,a.Za=q)),a.sa=c,this.dispatchEvent(a)))}};B("X.interactor",Ge);B("X.interactor.prototype.init",Ge.prototype.wa);B("X.interactor.prototype.onMouseDown",Ge.prototype.Oi);B("X.interactor.prototype.onMouseUp",Ge.prototype.Ti);B("X.interactor.prototype.onMouseMove",Ge.prototype.Qi);B("X.interactor.prototype.onMouseWheel",Ge.prototype.Vi);B("X.interactor.prototype.onKey",Ge.prototype.Mi);B("X.interactor.prototype.onTouchStart",Ge.prototype.hj);B("X.interactor.prototype.onTouchMove",Ge.prototype.fj);
B("X.interactor.prototype.onTouchEnd",Ge.prototype.bj);B("X.interactor.prototype.onTouchHover",Ge.prototype.dj);function Ke(a){Ge.call(this,a);this.g="interactor2D"}C(Ke,Ge);Ke.prototype.wd=function(a){Ke.z.wd.call(this,a);var b=new Id;a.Jc==t&&(a.Jc=0);b.Z=0>a.Jc;this.dispatchEvent(b)};function Le(a){Y.call(this);this.g="slice";this.A=[0,0,0];this.tc=[0,0,1];this.Z=[0,1,0];this.Td=[1,0,0];this.v=this.H=10;this.Fc=[0,1,0,0,1,1,1,1,1,0,0,0];this.e=this.zb=t;this.ub=q;this.pc=[1,1,1];a!=t&&this.gc(a)}C(Le,Y);Le.prototype.gc=function(a){this.A=a.A.slice();this.tc=a.tc.slice();this.Z=a.Z.slice();this.H=a.H;this.v=a.v;this.zb=a.zb;this.e=a.e;this.ub=a.ub;this.pc=a.pc;this.Fh=a.Fh;Le.z.gc.call(this,a)};Le.prototype.__defineSetter__("height",fa("v"));
Le.prototype.__defineSetter__("width",fa("H"));Le.prototype.create=function(){this.hc()};
Le.prototype.hc=function(){var a=(new U(this.tc[0],this.tc[1],this.tc[2])).normalize(),b=new U(this.Z[0],this.Z[1],this.Z[2]),c=new U(this.Td[0],this.Td[1],this.Td[2]),e=new U(this.A[0],this.A[1],this.A[2]),d=Gc(c.l().U().scale(this.H/2),b.l().U().scale(this.v/2)),f=new U(d.x+e.x,d.y+e.y,d.d+e.d),d=Gc(c.l().U().scale(this.H/2),b.l().scale(this.v/2)),g=new U(d.x+e.x,d.y+e.y,d.d+e.d),d=Gc(c.l().scale(this.H/2),b.l().U().scale(this.v/2)),h=new U(d.x+e.x,d.y+e.y,d.d+e.d),d=Gc(c.l().scale(this.H/2),b.l().scale(this.v/
2)),b=new U(d.x+e.x,d.y+e.y,d.d+e.d);this.h=new W(18);this.q=new W(18);this.h.add(f.x,f.y,f.d);this.h.add(g.x,g.y,g.d);this.h.add(h.x,h.y,h.d);this.h.add(h.x,h.y,h.d);this.h.add(b.x,b.y,b.d);this.h.add(g.x,g.y,g.d);this.q.add(a.x,a.y,a.d);this.q.add(a.x,a.y,a.d);this.q.add(a.x,a.y,a.d);this.q.add(a.x,a.y,a.d);this.q.add(a.x,a.y,a.d);this.q.add(a.x,a.y,a.d);this.ub&&(a=new Y,a.h=new W(24),a.q=new W(24),a.h.add(f.x,f.y,f.d),a.h.add(g.x,g.y,g.d),a.h.add(g.x,g.y,g.d),a.h.add(b.x,b.y,b.d),a.h.add(b.x,
b.y,b.d),a.h.add(h.x,h.y,h.d),a.h.add(h.x,h.y,h.d),a.h.add(f.x,f.y,f.d),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.q.add(0,0,0),a.u=[this.pc[0],this.pc[1],this.pc[2]],a.Da="LINES",a.zc=2,this.c.push(a))};B("X.slice",Le);B("X.slice.prototype.create",Le.prototype.create);function Me(){O.call(this);this.g="parser";this.P=t;this.R=0;this.Hh=0<(new Int8Array((new Int16Array([1])).buffer))[0];this.Od=q;this.Gk=-Infinity;this.Fk=Infinity}C(Me,O);Me.prototype.parse=function(){m(Error("The function parse() should be overloaded."))};function Ne(a){for(var b=Infinity,c=-Infinity,e=a.length,d=0,d=0;d<e;d++)if(!isNaN(a[d]))var f=a[d],b=Math.min(b,f),c=Math.max(c,f);return[b,c]}
function Oe(a,b,c){b===p&&(b=0);c===p&&(c=a.length);for(var e="",d=0,d=b;d<c;++d)e+=String.fromCharCode(a[d]);return e}
function Z(a,b,c){c!=t||(c=1);var e=1,d=Uint8Array;switch(b){case "schar":d=Int8Array;break;case "ushort":d=Uint16Array;e=2;break;case "sshort":d=Int16Array;e=2;break;case "uint":d=Uint32Array;e=4;break;case "sint":d=Int32Array;e=4;break;case "float":d=Float32Array;e=4;break;case "complex":d=Float64Array;e=8;break;case "double":d=Float64Array,e=8}b=new d(a.P.slice(a.R,a.R+=c*e));if(a.Hh!=a.Od){a=b;b=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);for(d=0;d<a.byteLength;d+=e)for(var f=d+e-1,g=d;f>
g;f--,g++){var h=b[g];b[g]=b[f];b[f]=h}b=a}return 1==c?b[0]:b}
function Pe(a,b){var c=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE],e=Pc(0,0,0,1),d=Oc();ad(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=Pc(0,0,b[2]-1,1);ad(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=Pc(0,b[1]-
1,0,1);ad(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=Pc(b[0]-1,0,0,1);ad(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=Pc(b[0]-1,b[1]-1,0,1);ad(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];
c[5]=d[2]>c[5]?d[2]:c[5];e=Pc(b[0]-1,0,b[2]-1,1);ad(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=Pc(0,b[1]-1,b[2]-1,1);ad(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];e=Pc(b[0]-1,b[1]-1,b[2]-1,1);ad(a,e,d);c[0]=d[0]<c[0]?d[0]:c[0];c[1]=d[0]>c[1]?d[0]:c[1];c[2]=d[1]<c[2]?d[1]:
c[2];c[3]=d[1]>c[3]?d[1]:c[3];c[4]=d[2]<c[4]?d[2]:c[4];c[5]=d[2]>c[5]?d[2]:c[5];return c}
function Qe(a,b){var c=Rc();if(!(a.length==b.length&&a[0]==b[0]&&a[1]==b[1]&&a[2]==b[2])){var e=Math.acos(a[2]),d=Lc(),f=a[0],g=a[1],h=a[2],l=b[0],j=b[1],k=b[2];d[0]=g*k-h*j;d[1]=h*l-f*k;d[2]=f*j-g*l;Nc(d,d);f=Math.cos(e/2);g=Math.sin(e/2)*d[0];h=Math.sin(e/2)*d[1];e=Math.sin(e/2)*d[2];V(c,0,f*f+g*g-h*h-e*e,2*(g*h-f*e),2*(g*e+f*h),0);V(c,1,2*(g*h+f*e),f*f+h*h-g*g-e*e,2*(h*e-f*g),0);V(c,2,2*(g*e-f*h),2*(h*e+f*g),f*f+e*e-h*h-g*g,0)}e=Qc();Zc(c,e);return[c,e]}
function Re(a,b,c,e,d,f,g,h,l){var j=new Le;Nc(c,c);for(var k=[],n=[],r=0;6>r;r++)for(var s=Math.floor(r/2),z=(s+1)%3,y=(s+2)%3,E=(4+2*s)%6,F=0;2>F;F++){var K=(2+F+2*s)%6,A=-(c[s]*(d[r]-a[s])+c[z]*(d[K]-a[z]))/c[y]+a[y];if(A>=d[E]&&A<=d[E+1]||A<=d[E]&&A>=d[E+1]){var G=[];G[s]=d[r];G[z]=d[K];G[y]=A;k.push(G)}else G=[],G[s]=d[r],G[z]=d[K],G[y]=A,n.push(G)}a=Mc(0,0,1);a=Qe(c,a);d=a[0];a=a[1];s=[];for(n=0;n<k.length;++n)r=Pc(k[n][0],k[n][1],k[n][2],1),z=Oc(),ad(d,r,z),s.push([z[0],z[1],z[2]]);d=Mc(1,
0,0);k=Lc();$c(a,d,k);n=Mc(0,1,0);d=Lc();$c(a,n,d);r=[Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE,Number.MAX_VALUE,-Number.MAX_VALUE];for(n=n=0;n<s.length;++n)s[n][0]<r[0]&&(r[0]=s[n][0]),s[n][0]>r[1]&&(r[1]=s[n][0]),s[n][1]<r[2]&&(r[2]=s[n][1]),s[n][1]>r[3]&&(r[3]=s[n][1]),s[n][2]<r[4]&&(r[4]=s[n][2]),s[n][2]>r[5]&&(r[5]=s[n][2]);n=Pc(r[0]+(r[1]-r[0])/2,r[2]+(r[3]-r[2])/2,r[4]+(r[5]-r[4])/2,0);s=Oc();Yc(a,n,s);z=Math.floor(r[0]);y=Math.ceil(r[1]);z==y&&y++;E=y-z;F=Math.floor(r[2]);
K=Math.ceil(r[3]);A=K-F;G=b[0];b=b[1];var n=Math.ceil(E/G),I=Math.ceil(A/b),H=new Uint8Array(4*n*I),R=new ed;R.Ne=n;R.Me=I;var I=Oc(),N=Pc(0,0,r[4],1),S=Qc();Yc(g.yh,a,S);for(var ba=K-1E-7,aa=y-1E-7,ca=0,M=0,T=0,P=F,P=F;P<=ba;P+=b){T++;M=0;N[1]=P;for(n=z;n<=aa;n+=G){M++;N[0]=n;ad(S,N,I);var Ea=4*ca,sb=Math.floor(I[2]),tb=Math.floor(I[1]),ub=Math.floor(I[0]);if(0<=ub&&ub<g.oa[0]&&0<=tb&&tb<g.oa[1]&&0<=sb&&sb<g.oa[2]){var kb=f[sb][tb][ub],Tc=ub=tb=sb=0;l?((kb=l.get(kb))||(kb=[0,0.61,0,0,1]),sb=255*
kb[1],tb=255*kb[2],ub=255*kb[3],Tc=255*kb[4]):(sb=tb=ub=255*(kb/g.ma),Tc=255);H[Ea]=sb;H[++Ea]=tb;H[++Ea]=ub;H[++Ea]=Tc}else H[Ea]=0,H[++Ea]=0,H[++Ea]=0,H[++Ea]=0;ca++}}R.Tb=H;j.C=R;j.Nh=r;j.Ah=a;j.zh=S;j.Gh=F;j.Dk=K;j.Mh=z;j.Ik=y;j.Zf=M;j.Yf=T;j.Hc=G;j.H=E;j.uc=b;j.v=A;j.A=[s[0],s[1],s[2]];j.tc=[c[0],c[1],c[2]];j.Td=[k[0],k[1],k[2]];j.Z=[d[0],d[1],d[2]];j.L=u;j.zb=g;j.ub=g.zb!=t&&!h?u:q;j.pc=e;j.hc();j.L=u;return j}
function Se(a,b,c,e){var d;d=e.ka;for(var f=[],g=[],h=0;6>h;h++){var l=Math.floor(h/2),j=(l+1)%3,k=(l+2)%3,n=(2+2*l)%6,r=(4+2*l)%6,s=(d[h]-b[l])*(1/c[l]);if(Infinity!=s&&-Infinity!=s){var z=b[j]+c[j]*s,s=b[k]+c[k]*s;z>=d[n]&&z<=d[n+1]&&s>=d[r]&&s<=d[r+1]?(n=[],n[l]=d[h],n[j]=z,n[k]=s,f.push(n)):(n=[],n[l]=d[h],n[j]=z,n[k]=s,g.push(n))}}d=[f,g];b=d[0];e.b[a].k=d;d=Ec(new U(b[0][0],b[0][1],b[0][2]),new U(b[1][0],b[1][1],b[1][2]));e.b[a].Ck=d;f=Mc(0,0,1);g=Qe(c,f)[0];h=Pc(e.ye[0],e.ye[1],e.ye[2],0);
f=Oc();ad(g,h,f);g=Oc();h=f[2];g[0]=c[0]*h;g[1]=c[1]*h;g[2]=c[2]*h;g[3]=c[3]*h;0.5>Math.abs(f[0])&&(f[0]=0.5);0.5>Math.abs(f[1])&&(f[1]=0.5);e.b[a].Ca=[Math.abs(f[0]),Math.abs(f[1])];e.b[a].Dc=f[2];e.b[a].w=g;d=Math.floor(Math.abs(d/f[2]));e.cd[a]=d+1;e.b[a].o=d+1;e.b[a].k[0][0][0]>e.b[a].k[0][1][0]?0<g[0]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d):e.b[a].k[0][0][0]<e.b[a].k[0][1][0]?0>g[0]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d):e.b[a].k[0][0][1]>
e.b[a].k[0][1][1]?0<g[1]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d):e.b[a].k[0][0][1]<e.b[a].k[0][1][1]?0>g[1]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d):e.b[a].k[0][0][2]>e.b[a].k[0][1][2]?0<g[2]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d):e.b[a].k[0][0][2]<e.b[a].k[0][1][2]&&0>g[2]&&(d=e.b[a].k[0][0],e.b[a].k[0][0]=e.b[a].k[0][1],e.b[a].k[0][1]=d);e.b[a].Je=-(c[0]*b[0][0]+c[1]*b[0][1]+c[2]*b[0][2])}
function Ve(a,b){var c;c=b.P;for(var e=b.oa,d=b.ma,f=Array(e[2]),g=Array(e[2]),h=e[1]*e[0],l=0,j=0,k=0,n=0,r=0,n=0;n<e[2];n++){var s=c.subarray(n*h,(n+1)*h),r=0;g[n]=Array(e[1]);f[n]=Array(e[1]);for(k=0;k<e[1];k++){g[n][k]=new c.constructor(e[0]);f[n][k]=new c.constructor(e[0]);for(j=0;j<e[0];j++)l=s[r],g[n][k][j]=255*(l/d),f[n][k][j]=l,r++}}c=[f,g];b.ba=c[0];b.Ak=c[1];D.Ya(a.g+".reslice");b.I=b.e!=t;b.Aa&&(b.Oc=b.Aa.Fa);b.Vk=[0,0,0];b.t=[b.ya[0]+(b.tb[0]-1)/2,b.ya[1]+(b.tb[1]-1)/2,b.ya[2]+(b.tb[2]-
1)/2];b.ka=[Math.min(b.ya[0],b.ya[0]+b.tb[0]-1),Math.max(b.ya[0],b.ya[0]+b.tb[0]-1),Math.min(b.ya[1],b.ya[1]+b.tb[1]-1),Math.max(b.ya[1],b.ya[1]+b.tb[1]-1),Math.min(b.ya[2],b.ya[2]+b.tb[2]-1),Math.max(b.ya[2],b.ya[2]+b.tb[2]-1)];b.b=[{},{},{}];c=Mc(b.t[0],b.t[1],b.t[2]);b.b[0].ed=c;e=Mc(1,0,0);Nc(e,e);b.b[0].i=e;d=[1,0,0];b.b[0].u=d;Se(0,c,e,b);b.c[0].c=Array(b.b[0].o);c[0]=b.b[0].k[0][0][0]+b.b[0].w[0]*Math.floor(b.b[0].o/2);c[1]=b.b[0].k[0][0][1]+b.b[0].w[1]*Math.floor(b.b[0].o/2);c[2]=b.b[0].k[0][0][2]+
b.b[0].w[2]*Math.floor(b.b[0].o/2);c=Re(c,b.b[0].Ca,b.b[0].i,b.b[0].u,b.ka,b.ba,b,b.I,b.Oc);b.I&&(c.e=b.e.c[0].c[Math.floor(b.b[0].o/2)].C);b.c[0].c[Math.floor(b.b[0].o/2)]=c;b.vb=Math.floor(b.b[0].o/2);b.vc=Math.floor(b.b[0].o/2);c=Mc(b.t[0],b.t[1],b.t[2]);b.b[1].ed=c;e=Mc(0,1,0);Nc(e,e);b.b[1].i=e;d=[0,1,0];b.b[1].u=d;Se(1,c,e,b);b.c[1].c=Array(b.b[1].o);c[0]=b.b[1].k[0][0][0]+b.b[1].w[0]*Math.floor(b.b[1].o/2);c[1]=b.b[1].k[0][0][1]+b.b[1].w[1]*Math.floor(b.b[1].o/2);c[2]=b.b[1].k[0][0][2]+b.b[1].w[2]*
Math.floor(b.b[1].o/2);c=Re(c,b.b[1].Ca,b.b[1].i,b.b[1].u,b.ka,b.ba,b,b.I,b.Oc);b.I&&(c.e=b.e.c[1].c[Math.floor(b.b[1].o/2)].C);b.c[1].c[Math.floor(b.b[1].o/2)]=c;b.wb=Math.floor(b.b[1].o/2);b.wc=Math.floor(b.b[1].o/2);c=Mc(b.t[0],b.t[1],b.t[2]);b.b[2].ed=c;e=Mc(0,0,1);Nc(e,e);b.b[2].i=e;d=[0,0.392,0.804];b.b[2].u=d;Se(2,c,e,b);b.c[2].c=Array(b.b[2].o);c[0]=b.b[2].k[0][0][0]+b.b[2].w[0]*Math.floor(b.b[2].o/2);c[1]=b.b[2].k[0][0][1]+b.b[2].w[1]*Math.floor(b.b[2].o/2);c[2]=b.b[2].k[0][0][2]+b.b[2].w[2]*
Math.floor(b.b[2].o/2);c=Re(c,b.b[2].Ca,b.b[2].i,b.b[2].u,b.ka,b.ba,b,b.I,b.Oc);b.I&&(c.e=b.e.c[2].c[Math.floor(b.b[2].o/2)].C);b.c[2].c[Math.floor(b.b[2].o/2)]=c;b.xb=Math.floor(b.b[2].o/2);b.xc=Math.floor(b.b[2].o/2);D.Ua(a.g+".reslice");return b.ba};function Q(a){Y.call(this);this.g="volume";this.A=[0,0,0];this.oa=[10,10,10];this.ka=[1,1,1];this.cd=[10,10,10];this.kd=[1,1,1];this.Jb=[];this.xc=this.xb=this.wc=this.wb=this.vc=this.vb=0;this.gd=new Y;this.hd=new Y;this.jd=new Y;this.Wd=this.Ma=u;this.T=-1;this.ng=[];this.e=t;this.ub=q;this.ia=Infinity;this.ha=-Infinity;this.kg=q;this.ma=0;this.P=t;Ga(this,new wc);Ga(this,new hd);a!=t&&this.gc(a)}C(Q,Y);
Q.prototype.gc=function(a){this.A=a.A.slice();this.oa=a.oa.slice();this.kd=a.kd.slice();this.vb=a.vb;this.vc=a.vc;this.wb=a.wb;this.wc=a.wc;this.xb=a.xb;this.xc=a.xc;this.Tf=a.Tf.slice();this.gd=new Y(a.gd);this.hd=new Y(a.hd);this.jd=new Y(a.jd);this.ma=a.ma;this.P=a.P;this.Ma=a.Ma;this.Wd=a.Wd;this.T=a.T;this.e=a.e;this.ub=a.ub;Q.z.gc.call(this,a)};
Q.prototype.hc=function(a){this.c.length=0;this.gd.c.length=0;this.hd.c.length=0;this.jd.c.length=0;this.c.push(this.gd);this.c.push(this.hd);this.c.push(this.jd);this.ya=a.Ed;this.ye=a.Fd;this.tb=a.Dd;this.oc=a.Fb;this.yh=a.Gb;this.ma=a.max;this.P=a.data;this.j=q};
Q.prototype.p=function(a){a="undefined"!==typeof a?a:q;if(0<this.c.length){this.Ma!=this.Wd&&(!this.Ma&&-1!=this.T&&(this.c[this.T].visible=u),this.j=q,this.Wd=this.Ma);if(!this.L)return;for(var b=0,b=0;3>b;b++){var c=this.c[b],e=0,d=0;0==b?(e=this.vb,d=this.vc,this.vc=this.vb):1==b?(e=this.wb,d=this.wc,this.wc=this.wb):2==b&&(e=this.xb,d=this.xc,this.xc=this.xb);if(this.c[b].c[parseInt(e,10)]==t){var f=Lc();f[0]=this.b[b].k[0][0][0]+this.b[b].w[0]*parseInt(e,10);f[1]=this.b[b].k[0][0][1]+this.b[b].w[1]*
parseInt(e,10);f[2]=this.b[b].k[0][0][2]+this.b[b].w[2]*parseInt(e,10);if(this.I){var g=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.e.ba,this.e,this.e.I,this.e.Aa.Fa);this.e.c[b].c[parseInt(e,10)]=g;this.e.c[b].p(q)}f=Re(f,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.ba,this,q,t);this.I&&(f.e=f.C,f.e=this.e.c[b].c[parseInt(e,10)].C);c.c[parseInt(e,10)]=f;this.c[b].p(q)}d=c.c[parseInt(d,10)];this.Ma||(d.visible=u);c=c.c[parseInt(e,10)];c.visible=q;c.qa=1;this.Ma&&(c.c[0].L=u,b!=this.T&&
(c.visible=u,c.qa=0))}this.Ma&&-1!=this.T&&We(this,this.T)}a&&Q.z.p.call(this)};Q.prototype.__defineGetter__("dimensions",v("oa"));Q.prototype.__defineGetter__("bbox",v("ka"));Q.prototype.__defineGetter__("range",v("cd"));Q.prototype.__defineGetter__("dimensionsRAS",v("Tf"));Q.prototype.__defineGetter__("volumeRendering",v("Ma"));Q.prototype.__defineSetter__("volumeRendering",function(a){this.Ma=a;this.p(u)});Q.prototype.__defineGetter__("visible",v("L"));
Q.prototype.__defineSetter__("visible",function(a){if(a)this.L=a,this.p(u);else{for(var b=this.c,c=b.length,e=0,e=0;e<c;e++)b[e].visible=a;this.L=a;this.j=q}});Q.prototype.__defineGetter__("center",v("A"));Q.prototype.__defineSetter__("center",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid center."));this.A=a});Q.prototype.__defineGetter__("image",v("Jb"));Q.prototype.__defineGetter__("labelmap",function(){this.e||(this.e=new Xe(this));return this.e});
Q.prototype.__defineGetter__("indexX",v("vb"));Q.prototype.__defineSetter__("indexX",function(a){x(a)&&(0<=a&&a<this.gd.c.length)&&(this.vb=a,this.p(u))});Q.prototype.__defineGetter__("indexY",v("wb"));Q.prototype.__defineSetter__("indexY",function(a){x(a)&&(0<=a&&a<this.hd.c.length)&&(this.wb=a,this.p(u))});Q.prototype.__defineGetter__("indexZ",v("xb"));Q.prototype.__defineSetter__("indexZ",function(a){x(a)&&(0<=a&&a<this.jd.c.length)&&(this.xb=a,this.p(u))});
Q.prototype.__defineGetter__("windowLow",v("ia"));Q.prototype.__defineSetter__("windowLow",fa("ia"));Q.prototype.__defineGetter__("windowHigh",v("ha"));Q.prototype.__defineSetter__("windowHigh",fa("ha"));Q.prototype.__defineGetter__("borders",v("ub"));Q.prototype.__defineSetter__("borders",fa("ub"));Q.prototype.__defineGetter__("reslicing",v("kg"));Q.prototype.__defineSetter__("reslicing",fa("kg"));Q.prototype.__defineSetter__("xNormX",function(a){this.b[0].i[0]=a});
Q.prototype.__defineGetter__("xNormX",function(){return this.b[0].i[0]});Q.prototype.__defineSetter__("xNormY",function(a){this.b[0].i[1]=a});Q.prototype.__defineGetter__("xNormY",function(){return this.b[0].i[1]});Q.prototype.__defineSetter__("xNormZ",function(a){this.b[0].i[2]=a});Q.prototype.__defineGetter__("xNormZ",function(){return this.b[0].i[2]});Q.prototype.__defineSetter__("xColor",function(a){this.b[0].u=a});Q.prototype.__defineGetter__("xColor",function(){return this.b[0].u});
Q.prototype.__defineSetter__("yNormX",function(a){this.b[1].i[0]=a});Q.prototype.__defineGetter__("yNormX",function(){return this.b[1].i[0]});Q.prototype.__defineSetter__("yNormY",function(a){this.b[1].i[1]=a});Q.prototype.__defineGetter__("yNormY",function(){return this.b[1].i[1]});Q.prototype.__defineSetter__("yNormZ",function(a){this.b[1].i[2]=a});Q.prototype.__defineGetter__("yNormZ",function(){return this.b[1].i[2]});Q.prototype.__defineSetter__("yColor",function(a){this.b[1].u=a});
Q.prototype.__defineGetter__("yColor",function(){return this.b[1].u});Q.prototype.__defineSetter__("zNormX",function(a){this.b[2].i[0]=a});Q.prototype.__defineGetter__("zNormX",function(){return this.b[2].i[0]});Q.prototype.__defineSetter__("zNormY",function(a){this.b[2].i[1]=a});Q.prototype.__defineGetter__("zNormY",function(){return this.b[2].i[1]});Q.prototype.__defineSetter__("zNormZ",function(a){this.b[2].i[2]=a});Q.prototype.__defineGetter__("zNormZ",function(){return this.b[2].i[2]});
Q.prototype.__defineSetter__("zColor",function(a){this.b[2].u=a});Q.prototype.__defineGetter__("zColor",function(){return this.b[2].u});
Q.prototype.zj=function(a){this.c[a].visible=u;for(var b=0;b<this.c[a].c.length;b++)"undefined"!=typeof this.c[a].c[b]&&(this.I&&(this.e.c[a].c[b].remove(),this.e.c[a].c[b]=t),this.c[a].c[b].remove(),this.c[a].c[b]=t);Nc(this.b[a].i,this.b[a].i);Se(a,this.b[a].ed,this.b[a].i,this);this.c[a].c=[];this.c[a].c=Array(this.b[a].o);this.I&&(b=Re(this.b[a].ed,this.b[a].Ca,this.b[a].i,this.b[a].u,this.ka,this.e.ba,this.e,this.e.I,this.e.Aa.Fa),this.e.c[a].c=[],this.e.c[a].c=Array(this.b[a].o),this.e.c[a].c[Math.floor(this.b[a].o/
2)]=b,this.e.c[a].p());b=Re(this.b[a].ed,this.b[a].Ca,this.b[a].i,this.b[a].u,this.ka,this.ba,this,q,t);this.I&&(b.e=b.C,b.e=this.e.c[a].c[Math.floor(this.b[a].o/2)].C);this.c[a].c[Math.floor(this.b[a].o/2)]=b;0==a?(this.vb=Math.floor(this.b[a].o/2),this.vc=Math.floor(this.b[a].o/2)):1==a?(this.wb=Math.floor(this.b[a].o/2),this.wc=Math.floor(this.b[a].o/2)):(this.xb=Math.floor(this.b[a].o/2),this.xc=Math.floor(this.b[a].o/2));this.c[a].p();this.c[a].c[Math.floor(this.b[a].o/2)].L=q};
function We(a,b){if(!a.Id)if(!a.Ma||!a.j&&b==a.T)a.T=b;else if(-1==a.ng.indexOf(b)){a.ng.push(b);a.Id=q;var c=new Nd;c.K=a;a.dispatchEvent(c);a.onComputing(b);setTimeout(function(){var a=t;0<=this.T&&(a=this.c[this.T],a.visible=u);var a=this.c[b],c=a.c.length,d=Math.floor(c/4),e;for(e=0;e<1*d;e++){if(a.c[e]==t){var j=Lc();j[0]=this.b[b].k[0][0][0]+this.b[b].w[0]*e;j[1]=this.b[b].k[0][0][1]+this.b[b].w[1]*e;j[2]=this.b[b].k[0][0][2]+this.b[b].w[2]*e;if(this.I){var k=Re(j,this.b[b].Ca,this.b[b].i,this.b[b].u,
this.ka,this.e.ba,this.e,this.e.I,this.e.Aa.Fa);this.e.c[b].c[e]=k;this.e.c[b].p(q)}j=Re(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.ba,this,q,t);j.c[0].L=u;this.I&&(j.e=j.C,j.e=this.e.c[b].c[e].C);a.c[e]=j}a.c[e].L=q}Ye(this,0.25);setTimeout(function(){for(;e<2*d;e++){if(a.c[e]==t){var j=Lc();j[0]=this.b[b].k[0][0][0]+this.b[b].w[0]*e;j[1]=this.b[b].k[0][0][1]+this.b[b].w[1]*e;j[2]=this.b[b].k[0][0][2]+this.b[b].w[2]*e;if(this.I){var k=Re(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.e.ba,
this.e,this.e.I,this.e.Aa.Fa);this.e.c[b].c[e]=k;this.e.c[b].p(q)}j=Re(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.ba,this,q,t);j.c[0].L=u;this.I&&(j.e=j.C,j.e=this.e.c[b].c[e].C);a.c[e]=j}a.c[e].L=q}Ye(this,0.5);setTimeout(function(){for(;e<3*d;e++){if(a.c[e]==t){var j=Lc();j[0]=this.b[b].k[0][0][0]+this.b[b].w[0]*e;j[1]=this.b[b].k[0][0][1]+this.b[b].w[1]*e;j[2]=this.b[b].k[0][0][2]+this.b[b].w[2]*e;if(this.I){var k=Re(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.e.ba,this.e,this.e.I,
this.e.Aa.Fa);this.e.c[b].c[e]=k;this.e.c[b].p(q)}j=Re(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.ba,this,q,t);j.c[0].L=u;this.I&&(j.e=j.C,j.e=this.e.c[b].c[e].C);a.c[e]=j}a.c[e].L=q}Ye(this,0.75);setTimeout(function(){for(e=3*d;e<c;e++){if(a.c[e]==t){var j=Lc();j[0]=this.b[b].k[0][0][0]+this.b[b].w[0]*e;j[1]=this.b[b].k[0][0][1]+this.b[b].w[1]*e;j[2]=this.b[b].k[0][0][2]+this.b[b].w[2]*e;if(this.I){var k=Re(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.e.ba,this.e,this.e.I,this.e.Aa.Fa);
this.e.c[b].c[e]=k;this.e.c[b].p(q)}j=Re(j,this.b[b].Ca,this.b[b].i,this.b[b].u,this.ka,this.ba,this,q,t);j.c[0].L=u;this.I&&(j.e=j.C,j.e=this.e.c[b].c[e].C);a.c[e]=j}a.c[e].L=q}Ye(this,1);setTimeout(function(){this.Id&&this.c[b].p(q);this.T=b;this.j=u;if(this.Id){var a=new Pd;a.K=this;this.dispatchEvent(a);this.onComputingEnd(b)}this.Id=u}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(this),10)}.bind(a),10)}else{c=a.c[a.T];c.visible=u;var c=a.c[b],e=c.c.length,d;for(d=0;d<e;d++)c.c[d].L=q;
a.T=b;a.j=u}}function Ye(a,b){var c=new Od;c.od=b;a.dispatchEvent(c);a.onComputingProgress(100*b)}Q.prototype.sf=ea();Q.prototype.uf=ea();Q.prototype.tf=ea();B("X.volume",Q);B("X.volume.prototype.modified",Q.prototype.p);B("X.volume.prototype.sliceInfoChanged",Q.prototype.zj);B("X.volume.prototype.onComputing",Q.prototype.sf);B("X.volume.prototype.onComputingProgress",Q.prototype.uf);B("X.volume.prototype.onComputingEnd",Q.prototype.tf);function Ze(){Me.call(this);this.g="parserSTL"}C(Ze,Me);
Ze.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");this.P=c;var e=b.h,d=b.q;if("solid"==Oe(Z(this,"uchar",5))){b.h=e=new W(c.byteLength);b.q=d=new W(c.byteLength);var f=e,e=d,d=Z(this,"uchar",c.byteLength-5);c=d.length;var g=u,h=u,l=0,j;for(j=0;j<c;j++)if(10==d[j]){if(g||h){var k=Oe(d,l,j).split(" "),h=parseFloat(k[0]),n=parseFloat(k[1]),k=parseFloat(k[2]);g?(e.add(h,n,k),e.add(h,n,k),e.add(h,n,k)):f.add(h,n,k);h=g=u}}else 32==d[j-1]&&(102==d[j]?(l=j+=13,g=q):118==d[j]&&(l=j+=7,h=q))}else{this.R=
80;f=Z(this,"uint");b.h=e=new W(9*f);b.q=d=new W(9*f);for(c=c=0;c<f;c++)g=Z(this,"float",12),l=g[0],j=g[1],h=g[2],d.add(l,j,h),d.add(l,j,h),d.add(l,j,h),e.add(g[3],g[4],g[5]),e.add(g[6],g[7],g[8]),e.add(g[9],g[10],g[11]),this.R+=2}D.Ua(this.g+".parse");f=new jd;f.K=b;f.B=a;this.dispatchEvent(f)};B("X.parserSTL",Ze);B("X.parserSTL.prototype.parse",Ze.prototype.parse);function $e(){Me.call(this);this.g="parserDCM"}C($e,Me);
$e.prototype.parse=function(a,b,c){b.nc={};b.nc.lf=0;this.yd(c,b);if(b.r.length==t||b.na.length==b.r.length){b.nc.lf=b.r.length;var e={};c={};for(var d=0;d<b.na.length;d++)e.hasOwnProperty(b.na[d].series_instance_uid)||(e[b.na[d].series_instance_uid]=[],c[b.na[d].series_instance_uid]={}),c[b.na[d].series_instance_uid].hasOwnProperty(b.na[d].sop_instance_uid)||(c[b.na[d].series_instance_uid][b.na[d].sop_instance_uid]=q,e[b.na[d].series_instance_uid].push(b.na[d]));var f=Object.keys(e)[0],d=e[f],g=
d.length;c={};var h="image_position_patient";1==g?(h="image_position_patient",e[f][0].dist=0):d[0].image_position_patient[0]!=d[1].image_position_patient[0]||d[0].image_position_patient[1]!=d[1].image_position_patient[1]||d[0].image_position_patient[2]!=d[1].image_position_patient[2]?(h="image_position_patient",e=new U(d[0].image_orientation_patient[0],d[0].image_orientation_patient[1],d[0].image_orientation_patient[2]),f=new U(d[0].image_orientation_patient[3],d[0].image_orientation_patient[4],d[0].image_orientation_patient[5]),
e=Hc(e,f),d.map(function(a,b){b.dist=b.image_position_patient[0]*a.x+b.image_position_patient[1]*a.y+b.image_position_patient[2]*a.d;return b}.bind(t,e)),d.sort(function(a,b){return a.dist-b.dist})):d[0].instance_number!=d[1].instance_number?(h="instance_number",d.sort(function(a,b){return a.instance_number-b.instance_number})):window.console.log("Could not resolve the ordering mode");isNaN(d[0].pixel_spacing[0])&&(d[0].pixel_spacing[0]=1);isNaN(d[0].pixel_spacing[1])&&(d[0].pixel_spacing[1]=1);if(1<
g)switch(h){case "image_position_patient":var l=d[0].image_position_patient,e=d[1].image_position_patient,f=e[0]-l[0],j=e[1]-l[1],k=e[2]-l[2];d[0].pixel_spacing[2]=Math.sqrt(f*f+j*j+k*k);break;case "instance_number":d[0].pixel_spacing[2]=1;break;default:window.console.log("Unkown ordering mode - returning: "+h)}else d[0].pixel_spacing[2]=1;e=1;switch(h){case "image_position_patient":var l=d[0].image_position_patient,n=d[g-1].image_position_patient,f=n[0]-l[0],j=n[1]-l[1],k=n[2]-l[2],f=Math.sqrt(f*
f+j*j+k*k),e=e+Math.round(f/d[0].pixel_spacing[2]);break;case "instance_number":e+=Math.abs(d[g-1].instance_number-d[0].instance_number);break;default:window.console.log("Unkown ordering mode - returning: "+h)}l=d[0].columns*d[0].rows;f=l*e;n=t;switch(d[0].Ve){case 8:n=new Uint8Array(f);break;case 16:n=new Uint16Array(f);break;case 32:n=new Uint32Array(f);default:window.console.log("Unknown number of bits allocated - using default: 32 bits")}b.kd=d[0].pixel_spacing;for(var r=0;r<g;r++){var s=d[r].data,
f=0;switch(h){case "image_position_patient":f=d[r].image_position_patient[0]-d[0].image_position_patient[0];j=d[r].image_position_patient[1]-d[0].image_position_patient[1];k=d[r].image_position_patient[2]-d[0].image_position_patient[2];f=Math.sqrt(f*f+j*j+k*k)/d[0].pixel_spacing[2];break;case "instance_number":f=d[r].instance_number-d[0].instance_number;break;default:window.console.log("Unkown ordering mode - returning: "+h)}n.set(s,f*l)}c.data=n;b.P=n;b.oa=[d[0].columns,d[0].rows,e];c.Nk=b.oa;e=
Ne(n);g=e[0];e=e[1];c.min=b.cb=b.ia=g;c.max=b.ma=b.ha=e;-Infinity==b.fa&&(b.fa=g);Infinity==b.ga&&(b.ga=e);j=d[0].image_position_patient;g=Qc();switch(h){case "image_position_patient":e=new U(d[0].image_orientation_patient[0],d[0].image_orientation_patient[1],d[0].image_orientation_patient[2]);f=new U(d[0].image_orientation_patient[3],d[0].image_orientation_patient[4],d[0].image_orientation_patient[5]);e=Hc(e,f);V(g,0,-d[0].image_orientation_patient[0]*d[0].pixel_spacing[0],-d[0].image_orientation_patient[3]*
d[0].pixel_spacing[1],-e.x*d[0].pixel_spacing[2],-j[0]);V(g,1,-d[0].image_orientation_patient[1]*d[0].pixel_spacing[0],-d[0].image_orientation_patient[4]*d[0].pixel_spacing[1],-e.y*d[0].pixel_spacing[2],-j[1]);V(g,2,d[0].image_orientation_patient[2]*d[0].pixel_spacing[0],d[0].image_orientation_patient[5]*d[0].pixel_spacing[1],e.d*d[0].pixel_spacing[2],j[2]);V(g,3,0,0,0,1);break;case "instance_number":V(g,0,-1,0,0,-j[0]);V(g,1,-0,-1,-0,-j[1]);V(g,2,0,0,1,j[2]);V(g,3,0,0,0,1);break;default:window.console.log("Unkown ordering mode - returning: "+
h)}c.Fb=g;c.Gb=Qc();Zc(c.Fb,c.Gb);h=Pc(0,0,0,1);d=Oc();ad(g,h,d);h=Pc(1,1,1,1);e=Oc();ad(g,h,e);c.Fd=[e[0]-d[0],e[1]-d[1],e[2]-d[2]];d=Pe(g,[b.oa[0],b.oa[1],b.oa[2]]);c.Dd=[d[1]-d[0]+1,d[3]-d[2]+1,d[5]-d[4]+1];c.Ed=[d[0],d[2],d[4]];b.hc(c);b.Jb=Ve(this,b)}c=new jd;c.K=b;c.B=a;this.dispatchEvent(c)};
function af(a,b,c,e){switch(c){case 16975:case 20819:case 20053:case 22351:c=function(a){for(var b="",c=128;1<=c;c/=2)b+=a&c?"1":"0";return b};e=a[b++];a=a[b++];e=parseInt(c((a&65280)>>8)+c(a&255)+(c((e&65280)>>8)+c(e&255)),2);4294967295==e&&(e=0);b+=e/2;break;default:b+=e/2}return b}
$e.prototype.yd=function(a,b){this.P=a;if("undefined"==typeof b.na||b.na==t)b.na=[];for(var c={pixel_spacing:[0.1,0.1,Infinity],image_orientation_patient:[1,0,0,0,1,0],image_position_patient:[0,0,0],transfer_syntax_uid:"no_transfer_syntax_uid"},e=Z(this,"ushort",this.P.byteLength),d=66,f=t,g=t,h=t,l=t;d<e.length;)switch(f=e[d++],g=e[d++],h=e[d++],l=e[d++],"1.2.840.10008.1.2"==c.transfer_syntax_uid&&0==l&&(l=h),f){case 2:switch(g){case 16:for(var j="",f=f=0;f<l/2;f++)h=e[d++],g=h&255,h=(h&65280)>>
8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);c.transfer_syntax_uid=j.replace(/\0/g,"");break;default:d=af(e,d,h,l)}break;case 40:switch(g){case 16:c.rows=e[d];d+=l/2;break;case 17:c.columns=e[d];d+=l/2;break;case 256:c.Ve=e[d];d+=l/2;break;case 257:c.bits_stored=e[d];d+=l/2;break;case 2:c.number_of_images=e[d];d+=l/2;break;case 48:j="";for(f=0;f<l/2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);j=j.split("\\");c.pixel_spacing=[parseFloat(j[0]),parseFloat(j[1]),
Infinity];break;default:d=af(e,d,h,l)}break;case 32:switch(g){case 14:c.series_instance_uid="";for(f=0;f<l/2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,c.series_instance_uid+=String.fromCharCode(g),c.series_instance_uid+=String.fromCharCode(h);break;case 19:j="";for(f=0;f<l/2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);c.instance_number=parseInt(j,10);break;case 50:j="";for(f=0;f<l/2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);
j=j.split("\\");c.image_position_patient=[parseFloat(j[0]),parseFloat(j[1]),parseFloat(j[2])];break;case 55:j="";for(f=0;f<l/2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,j+=String.fromCharCode(g),j+=String.fromCharCode(h);j=j.split("\\");c.image_orientation_patient=[parseFloat(j[0]),parseFloat(j[1]),parseFloat(j[2]),parseFloat(j[3]),parseFloat(j[4]),parseFloat(j[5])];break;default:d=af(e,d,h,l)}break;case 65534:switch(g){default:l=0,d+=l/2}break;case 8:switch(g){case 24:c.sop_instance_uid="";for(f=0;f<l/
2;f++)h=e[d++],g=h&255,h=(h&65280)>>8,c.sop_instance_uid+=String.fromCharCode(g),c.sop_instance_uid+=String.fromCharCode(h);break;default:d=af(e,d,h,l)}break;case 16:switch(g){case 8720:for(f=0;f<l/2;f++)d++;break;default:d=af(e,d,h,l)}break;default:d=af(e,d,h,l)}switch(c.Ve){case 8:c.data=new Uint8Array(c.columns*c.rows);break;case 16:c.data=new Uint16Array(c.columns*c.rows);break;case 32:c.data=new Uint32Array(c.columns*c.rows)}this.R=this.P.byteLength-2*c.columns*c.rows;e=t;switch(c.Ve){case 8:e=
Z(this,"uchar",c.columns*c.rows);break;case 16:e=Z(this,"ushort",c.columns*c.rows);break;case 32:e=Z(this,"uint",c.columns*c.rows)}c.data=e;b.na.push(c);return b};B("X.parserDCM",$e);B("X.parserDCM.prototype.parse",$e.prototype.parse);function bf(){Me.call(this);this.g="parserVTK"}C(bf,Me);
bf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");var e=b.h,d=b.q,f=new Uint8Array(c),g="";b.h=e=new W(c.byteLength);b.q=d=new W(c.byteLength);c=0;for(var h=f.length;c<h;c+=32768)g+=Oe(f,c,Math.min(c+32768,h));f=g.split("\n");g=f.length;this.md=this.nd=t;this.bc=[];this.Ka=gd;this.Ie=this.Qb=this.Ib=this.Rb=u;c=0;for(h=g%8;h--;)cf(this,f[c]),c++;for(h=0.125*g^0;h--;)cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,cf(this,f[c]),c++,
cf(this,f[c]),c++;c=this.nd;var f=this.md,g=f.length,l=h=this.bc.length;do{var j=this.bc[h-l],k=j.length,n;for(n=0;n<k&&!("LINES"==this.Ka&&n+1>=k);n++){var r=parseInt(j[n],10),s=c.get(r);e.add(s[0],s[1],s[2]);var z=r,y=s;"LINES"==this.Ka?(z=parseInt(j[n+1],10),y=c.get(z),e.add(y[0],y[1],y[2])):"TRIANGLE_STRIPS"==this.Ka&&(0==n||n==k-1)&&e.add(s[0],s[1],s[2]);r<g?(y=f.get(r),d.add(y[0],y[1],y[2]),"LINES"==this.Ka?(z=f.get(z),d.add(z[0],z[1],z[2])):"TRIANGLE_STRIPS"==this.Ka&&(0==n||n==k-1)&&d.add(y[0],
y[1],y[2])):(z=new U(s[0],s[1],s[2]),z.normalize(),d.add(z.x,z.y,z.d),"LINES"==this.Ka?(z=new U(y[0],y[1],y[2]),z.normalize(),d.add(z.x,z.y,z.d)):"TRIANGLE_STRIPS"==this.Ka&&(0==n||n==k-1)&&d.add(z.x,z.y,z.d))}l--}while(0<l);b.Da=this.Ka;D.Ua(this.g+".parse");e=new jd;e.K=b;e.B=a;this.dispatchEvent(e)};
function cf(a,b){b=b.replace(/^\s+|\s+$/g,"");var c=b.split(" "),e=c.length,d=c[0];switch(d){case "POINTS":a.Rb=q;a.Ib=u;a.Qb=u;c=parseInt(c[1],10);a.nd=new W(3*c);a.md=new W(3*c);return;case "VERTICES":a.Ib=q;a.Rb=u;a.Qb=u;c=parseInt(c[1],10);3<=c?a.Ka=gd:1==c?a.Ka="POINTS":m(Error("This VTK file is not supported!"));a.bc=[];return;case "TRIANGLE_STRIPS":a.Ib=q;a.Rb=u;a.Qb=u;a.Ka="TRIANGLE_STRIPS";a.bc=[];return;case "LINES":a.Ib=q;a.Rb=u;a.Qb=u;a.Ka="LINES";a.bc=[];return;case "POLYGONS":a.Ib=q;
a.Rb=u;a.Qb=u;a.Ka="POLYGONS";a.bc=[];return;case "POINT_DATA":a.Qb=q;a.Rb=u;a.Ib=u;return}if(a.Rb)if(1==e||isNaN(parseFloat(d)))a.Rb=u;else{if(3<=e){var d=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]);a.nd.add(d,f,g)}6<=e&&(d=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.nd.add(d,f,g));9<=e&&(e=parseFloat(c[6]),d=parseFloat(c[7]),c=parseFloat(c[8]),a.nd.add(e,d,c))}else a.Ib?1==e||isNaN(parseFloat(d))?a.Ib=u:(c=c.slice(1),a.bc.push(c)):a.Qb&&("NORMALS"==d?a.Ie=q:1==e||isNaN(parseFloat(d))?
(a.Qb=u,a.Ie=u):a.Ie&&(3<=e&&(d=parseFloat(c[0]),f=parseFloat(c[1]),g=parseFloat(c[2]),a.md.add(d,f,g)),6<=e&&(d=parseFloat(c[3]),f=parseFloat(c[4]),g=parseFloat(c[5]),a.md.add(d,f,g)),9<=e&&(e=parseFloat(c[6]),d=parseFloat(c[7]),c=parseFloat(c[8]),a.md.add(e,d,c))))}B("X.parserVTK",bf);B("X.parserVTK.prototype.parse",bf.prototype.parse);function df(){Me.call(this);this.g="parserFSM";this.Od=u}C(df,Me);
df.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");this.P=c;var e=b.h,d=b.q;b.Ac=[];var f=b.Ac;c=0;var g;do g=Z(this,"uchar"),c++;while(200>c&&10!=g);Z(this,"uchar");d=Z(this,"uint");c=Z(this,"uint");var h=Z(this,"float",3*d);g=Z(this,"uint",3*c);var l=new Uint32Array(d),j=new Float32Array(9*c);b.h=e=new W(9*c);b.q=d=new W(9*c);var k;for(k=0;k<c;k++){var n=3*k,r=g[n],s=g[n+1],z=g[n+2];f.push(r);f.push(s);f.push(z);l[r]+=1;l[s]+=1;l[z]+=1;var n=3*r,y=3*s,E=3*z,F=h[n],K=h[n+1],A=h[n+2],s=h[y],
z=h[y+1],r=h[y+2],G=h[E],I=h[E+1],H=h[E+2];e.add(F,K,A);e.add(s,z,r);e.add(G,I,H);F=new U(F,K,A);G=new U(G,I,H);s=(new U(s,z,r)).l().Ea(F);z=G.l().Ea(F);s=Hc(s,z).normalize();j[n]+=s.x;j[n+1]+=s.y;j[n+2]+=s.d;j[y]+=s.x;j[y+1]+=s.y;j[y+2]+=s.d;j[E]+=s.x;j[E+1]+=s.y;j[E+2]+=s.d}for(k=0;k<c;k++)n=3*k,r=g[n],s=g[n+1],z=g[n+2],n=3*r,y=3*s,E=3*z,f=new U(j[y],j[y+1],j[y+2]),h=new U(j[E],j[E+1],j[E+2]),n=(new U(j[n],j[n+1],j[n+2])).scale(1/l[r]).normalize(),f=f.scale(1/l[s]).normalize(),h=h.scale(1/l[z]).normalize(),
d.add(n.x,n.y,n.d),d.add(f.x,f.y,f.d),d.add(h.x,h.y,h.d);c=Z(this,"uchar",this.P.byteLength-this.R);g=t;for(n=0;n<c.length;n++)if(99==c[n]&&114==c[n+1]&&97==c[n+2]&&115==c[n+3]){for(d=g=n+9;10!=c[n]&&n<c.length;)d++,n++;g=Oe(c.subarray(g,d)).split(" ");break}g&&(b.ca.nh(parseFloat(g[0])),b.ca.oh(parseFloat(g[1])),b.ca.ph(parseFloat(g[2])));b.Da=gd;D.Ua(this.g+".parse");c=new jd;c.K=b;c.B=a;this.dispatchEvent(c)};B("X.parserFSM",df);B("X.parserFSM.prototype.parse",df.prototype.parse);var ef={Ze:function(a,b,c){return ef.update(a,0,b,c)},update:function(a,b,c,e){var d=ef.uh,f="number"===typeof c?c:c=0;e="number"===typeof e?e:a.length;b^=4294967295;for(f=e&7;f--;++c)b=b>>>8^d[(b^a[c])&255];for(f=e>>3;f--;c+=8)b=b>>>8^d[(b^a[c])&255],b=b>>>8^d[(b^a[c+1])&255],b=b>>>8^d[(b^a[c+2])&255],b=b>>>8^d[(b^a[c+3])&255],b=b>>>8^d[(b^a[c+4])&255],b=b>>>8^d[(b^a[c+5])&255],b=b>>>8^d[(b^a[c+6])&255],b=b>>>8^d[(b^a[c+7])&255];return(b^4294967295)>>>0}};
ef.uh=new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,
3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,
366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,
3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,
1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,
1088359270,936918E3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]);function ff(a){var b=a.length,c=0,e=Number.POSITIVE_INFINITY,d,f,g,h,l,j,k,n,r;for(n=0;n<b;++n)a[n]>c&&(c=a[n]),a[n]<e&&(e=a[n]);d=1<<c;f=new Uint32Array(d);g=1;h=0;for(l=2;g<=c;){for(n=0;n<b;++n)if(a[n]===g){j=0;k=h;for(r=0;r<g;++r)j=j<<1|k&1,k>>=1;for(r=j;r<d;r+=l)f[r]=g<<16|n;++h}++g;h<<=1;l<<=1}return[f,c,e]};function gf(a,b){this.We=[];this.Xe=32768;this.ib=this.pd=this.xa=this.Kf=0;this.input=new Uint8Array(a);this.pg=u;this.Ye=hf;this.Cb=u;if(b||!(b={}))b.index&&(this.xa=b.index),b.bufferSize&&(this.Xe=b.bufferSize),b.bufferType&&(this.Ye=b.bufferType),b.resize&&(this.Cb=b.resize);switch(this.Ye){case jf:this.ea=32768;this.Oa=new Uint8Array(32768+this.Xe+258);break;case hf:this.ea=0;this.Oa=new Uint8Array(this.Xe);this.jc=this.di;this.sg=this.Uh;this.ef=this.Yh;break;default:m(Error("invalid inflate mode"))}}
var jf=0,hf=1;
gf.prototype.rd=function(){for(;!this.pg;){var a=kf(this,3);a&1&&(this.pg=q);a>>>=1;switch(a){case 0:var a=this.input,b=this.xa,c=this.Oa,e=this.ea,d=p,f=p,g=p,h=c.length,d=p;this.ib=this.pd=0;d=a[b++];d===p&&m(Error("invalid uncompressed block header: LEN (first byte)"));f=d;d=a[b++];d===p&&m(Error("invalid uncompressed block header: LEN (second byte)"));f|=d<<8;d=a[b++];d===p&&m(Error("invalid uncompressed block header: NLEN (first byte)"));g=d;d=a[b++];d===p&&m(Error("invalid uncompressed block header: NLEN (second byte)"));g|=
d<<8;f===~g&&m(Error("invalid uncompressed block header: length verify"));b+f>a.length&&m(Error("input buffer is broken"));switch(this.Ye){case jf:for(;e+f>c.length;)d=h-e,f-=d,c.set(a.subarray(b,b+d),e),e+=d,b+=d,this.ea=e,c=this.jc(),e=this.ea;break;case hf:for(;e+f>c.length;)c=this.jc({yg:2});break;default:m(Error("invalid inflate mode"))}c.set(a.subarray(b,b+f),e);e+=f;this.xa=b+=f;this.ea=e;this.Oa=c;break;case 1:this.ef(lf,mf);break;case 2:nf(this);break;default:m(Error("unknown BTYPE: "+a))}}return this.sg()};
var of=new Uint16Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),pf=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258]),qf=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0]),rf=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577]),sf=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),tf=new Uint8Array(288),
uf,vf;uf=0;for(vf=tf.length;uf<vf;++uf)tf[uf]=143>=uf?8:255>=uf?9:279>=uf?7:8;var lf=ff(tf),wf=new Uint8Array(30),xf,yf;xf=0;for(yf=wf.length;xf<yf;++xf)wf[xf]=5;var mf=ff(wf);function kf(a,b){for(var c=a.pd,e=a.ib,d=a.input,f=a.xa,g;e<b;)g=d[f++],g===p&&m(Error("input buffer is broken")),c|=g<<e,e+=8;g=c&(1<<b)-1;a.pd=c>>>b;a.ib=e-b;a.xa=f;return g}
function zf(a,b){for(var c=a.pd,e=a.ib,d=a.input,f=a.xa,g=b[0],h=b[1],l;e<h;)l=d[f++],l===p&&m(Error("input buffer is broken")),c|=l<<e,e+=8;d=g[c&(1<<h)-1];g=d>>>16;a.pd=c>>g;a.ib=e-g;a.xa=f;return d&65535}
function nf(a){function b(a,b,c){var d,e,f;for(f=0;f<a;)switch(d=zf(this,b),d){case 16:for(d=3+kf(this,2);d--;)c[f++]=e;break;case 17:for(d=3+kf(this,3);d--;)c[f++]=0;e=0;break;case 18:for(d=11+kf(this,7);d--;)c[f++]=0;e=0;break;default:e=c[f++]=d}return c}var c=kf(a,5)+257,e=kf(a,5)+1,d=kf(a,4)+4,f=new Uint8Array(of.length),g;for(g=0;g<d;++g)f[of[g]]=kf(a,3);d=ff(f);f=new Uint8Array(c);g=new Uint8Array(e);a.ef(ff(b.call(a,c,d,f)),ff(b.call(a,e,d,g)))}w=gf.prototype;
w.ef=function(a,b){var c=this.Oa,e=this.ea;this.vg=a;for(var d=c.length-258,f,g,h;256!==(f=zf(this,a));)if(256>f)e>=d&&(this.ea=e,c=this.jc(),e=this.ea),c[e++]=f;else{f-=257;h=pf[f];0<qf[f]&&(h+=kf(this,qf[f]));f=zf(this,b);g=rf[f];0<sf[f]&&(g+=kf(this,sf[f]));e>=d&&(this.ea=e,c=this.jc(),e=this.ea);for(;h--;)c[e]=c[e++-g]}for(;8<=this.ib;)this.ib-=8,this.xa--;this.ea=e};
w.Yh=function(a,b){var c=this.Oa,e=this.ea;this.vg=a;for(var d=c.length,f,g,h;256!==(f=zf(this,a));)if(256>f)e>=d&&(c=this.jc(),d=c.length),c[e++]=f;else{f-=257;h=pf[f];0<qf[f]&&(h+=kf(this,qf[f]));f=zf(this,b);g=rf[f];0<sf[f]&&(g+=kf(this,sf[f]));e+h>d&&(c=this.jc(),d=c.length);for(;h--;)c[e]=c[e++-g]}for(;8<=this.ib;)this.ib-=8,this.xa--;this.ea=e};
w.jc=function(){var a=new Uint8Array(this.ea-32768),b=this.ea-32768,c=this.Oa;a.set(c.subarray(32768,a.length));this.We.push(a);this.Kf+=a.length;c.set(c.subarray(b,b+32768));this.ea=32768;return c};w.di=function(a){var b=this.input.length/this.xa+1|0,c=this.input,e=this.Oa;a&&("number"===typeof a.yg&&(b=a.yg),"number"===typeof a.Oh&&(b+=a.Oh));2>b?(a=(c.length-this.xa)/this.vg[2],a=258*(a/2)|0,a=a<e.length?e.length+a:e.length<<1):a=e.length*b;a=new Uint8Array(a);a.set(e);return this.Oa=a};
w.sg=function(){var a=0,b=this.Oa,c=this.We,e,d=new Uint8Array(this.Kf+(this.ea-32768)),f,g,h,l;if(0===c.length)return this.Oa.subarray(32768,this.ea);f=0;for(g=c.length;f<g;++f){e=c[f];h=0;for(l=e.length;h<l;++h)d[a++]=e[h]}f=32768;for(g=this.ea;f<g;++f)d[a++]=b[f];this.We=[];return this.buffer=d};w.Uh=function(){var a,b=this.ea;this.Cb?(a=new Uint8Array(b),a.set(this.Oa.subarray(0,b))):a=this.Oa.subarray(0,b);return this.buffer=a};new Uint8Array(256);var Af;for(Af=0;256>Af;++Af)for(var Bf=Af,Cf=7,Bf=Bf>>>1;Bf;Bf>>>=1)--Cf;var Df=[],Ef;for(Ef=0;288>Ef;Ef++)switch(q){case 143>=Ef:Df.push([Ef+48,8]);break;case 255>=Ef:Df.push([Ef-144+400,9]);break;case 279>=Ef:Df.push([Ef-256+0,7]);break;case 287>=Ef:Df.push([Ef-280+192,8]);break;default:m("invalid literal: "+Ef)}
function Ff(){var a=Gf;switch(q){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-
31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:m("invalid length: "+a)}}var Hf=[],Gf,If;
for(Gf=3;258>=Gf;Gf++)If=Ff(),Hf[Gf]=If[2]<<24|If[1]<<16|If[0];new Uint32Array(Hf);function Jf(){};function Kf(a){this.input=a;this.xa=0;this.member=[]}
Kf.prototype.rd=function(){for(var a=this.input.length;this.xa<a;){var b=new Jf,c=p,e=p,d=p,f=c=d=p,g=p,c=c=p,h=this.input,e=this.xa;b.Eg=h[e++];b.Fg=h[e++];(31!==b.Eg||139!==b.Fg)&&m(Error("invalid file signature:",b.Eg,b.Fg));b.rg=h[e++];switch(b.rg){case 8:break;default:m(Error("unknown compression method: "+b.rg))}b.de=h[e++];c=h[e++]|h[e++]<<8|h[e++]<<16|h[e++]<<24;b.Tk=new Date(1E3*c);b.Xk=h[e++];b.Uk=h[e++];0<(b.de&4)&&(b.Kj=h[e++]|h[e++]<<8,e+=b.Kj);if(0<(b.de&8)){g=[];for(f=0;0<(c=h[e++]);)g[f++]=
String.fromCharCode(c);b.name=g.join("")}if(0<(b.de&16)){g=[];for(f=0;0<(c=h[e++]);)g[f++]=String.fromCharCode(c);b.comment=g.join("")}0<(b.de&2)&&(b.Vh=ef.Ze(h,0,e)&65535,b.Vh!==(h[e++]|h[e++]<<8)&&m(Error("invalid header crc16")));c=h[h.length-4]|h[h.length-3]<<8|h[h.length-2]<<16|h[h.length-1]<<24;h.length-e-4-4<512*c&&(d=c);e=new gf(h,{index:e,bufferSize:d});b.data=d=e.rd();e=e.xa;b.Kk=c=(h[e++]|h[e++]<<8|h[e++]<<16|h[e++]<<24)>>>0;ef.Ze(d)!==c&&m(Error("invalid CRC-32 checksum: 0x"+ef.Ze(d).toString(16)+
" / 0x"+c.toString(16)));b.Qk=c=(h[e++]|h[e++]<<8|h[e++]<<16|h[e++]<<24)>>>0;(d.length&4294967295)!==c&&m(Error("invalid input size: "+(d.length&4294967295)+" / "+c));this.member.push(b);this.xa=e}a=this.member;b=d=e=0;for(h=a.length;b<h;++b)d+=a[b].data.length;d=new Uint8Array(d);for(b=0;b<h;++b)d.set(a[b].data,e),e+=a[b].data.length;return d};function Lf(){Me.call(this);this.g="parserMGZ";this.Od=u}C(Lf,Me);
Lf.prototype.parse=function(a,b,c,e){D.Ya(this.g+".parse");e&&(c=(new Kf(new Uint8Array(c))).rd(),c=c.buffer);e=this.yd(c);var d=[e.of,e.pf,e.qf];b.oa=d;var f=e.qh;b.kd=f;c=e.min;var g=e.max;b.cb=b.ia=c;b.ma=b.ha=g;-Infinity==b.fa&&(b.fa=c);Infinity==b.ga&&(b.ga=g);c=Qc();V(c,0,e.Xa[0][0],e.Xa[1][0],e.Xa[2][0],0);V(c,1,e.Xa[0][1],e.Xa[1][1],e.Xa[2][1],0);V(c,2,e.Xa[0][2],e.Xa[1][2],e.Xa[2][2],0);V(c,3,0,0,0,1);for(var g=d[0]/2,h=d[1]/2,l=d[2]/2,d=[0,0,0],j=0;3>j;++j)d[j]=e.Xa[3][j]-(c[j+0]*f[0]*g+
c[j+4]*f[1]*h+c[j+8]*f[2]*l);f=d[1];g=d[2];c[12]=d[0];c[13]=f;c[14]=g;c[15]=1;e.Fb=c;e.Gb=Qc();Zc(e.Fb,e.Gb);d=Pc(0,0,0,1);f=Oc();ad(c,d,f);g=Pc(1,1,1,1);d=Oc();ad(c,g,d);c=Pe(c,b.oa);e.Fd=[d[0]-f[0],d[1]-f[1],d[2]-f[2]];e.Dd=[c[1]-c[0]+1,c[3]-c[2]+1,c[5]-c[4]+1];e.Ed=[c[0],c[2],c[4]];b.hc(e);D.Ua(this.g+".parse");b.Jb=Ve(this,b);e=new jd;e.K=b;e.B=a;this.dispatchEvent(e)};
Lf.prototype.yd=function(a){this.P=a;a={version:0,xh:0,vh:0,ji:0,wh:0,of:0,pf:0,qf:0,Ki:0,type:0,bi:0,hh:0,Qj:t,Xa:t,qh:t,data:t,min:Infinity,max:-Infinity};a.version=Z(this,"uint");a.of=Z(this,"uint");a.pf=Z(this,"uint");a.qf=Z(this,"uint");a.Ki=Z(this,"uint");a.type=Z(this,"uint");a.bi=Z(this,"uint");a.hh=Z(this,"ushort");if(0<a.hh){a.qh=Z(this,"float",3);var b=[];b.push(Z(this,"float",3));b.push(Z(this,"float",3));b.push(Z(this,"float",3));b.push(Z(this,"float",3));a.Xa=b}this.R=284;b=a.of*a.pf*
a.qf;switch(a.type){case 0:a.data=Z(this,"uchar",b);break;case 1:a.data=Z(this,"uint",b);break;case 3:a.data=Z(this,"float",b);break;case 4:a.data=Z(this,"ushort",b);break;default:m(Error("Unsupported MGH/MGZ data type: "+a.type))}b=Ne(a.data);a.min=b[0];a.max=b[1];this.R+16<this.P.byteLength&&(a.xh=Z(this,"float"),a.ji=Z(this,"float"),a.vh=Z(this,"float"),a.wh=Z(this,"float"));return a};B("X.parserMGZ",Lf);B("X.parserMGZ.prototype.parse",Lf.prototype.parse);function Mf(){Me.call(this);this.g="parserLBL"}C(Mf,Me);
Mf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");var e=b.Ac,d=e.length;0==d&&m(Error("No _pointIndices defined on the X.object."));this.P=c;var f=[],g=Z(this,"uchar",c.byteLength),h=g.length,l=u,j=0;for(c=1;c<h;c++)10==g[c-1]?(j=c,l=q):l&&32==g[c]&&(f.push(parseInt(Oe(g,j,c),10)),l=u);g=b.G.F?b.G.F:new Float32Array(d);h=f.length;for(c=0;c<h;c++)g[f[c]]=1;f=new Float32Array(3*d);for(c=h=0;c<d;c++)l=e[c],l>d&&m(Error("Could not find scalar for vertex.")),l=g[l],f[h++]=l,f[h++]=l,f[h++]=l;b.G.F=
g;b.G.Pc=f;b.G.j=q;D.Ua(this.g+".parse");e=new jd;e.K=b;e.B=a;this.dispatchEvent(e)};B("X.parserLBL",Mf);B("X.parserLBL.prototype.parse",Mf.prototype.parse);function Nf(){Me.call(this);this.g="parserCRV";this.Od=u}C(Nf,Me);
Nf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");var e=b.Ac;0==e.length&&m(Error("No _pointIndices defined on the X.object."));this.P=c;this.R=3;var d=Z(this,"uint");Z(this,"uint");Z(this,"uint");var f=0,g=0,h=0,l=0,j=0,k=0,n=0,r=0,s=0,z=0,y=0;c=Array(2);var E=Array(2),F=Z(this,"float",d),K;for(K=0;K<d;K++){var A=F[K];0==K&&(c[0]=E[0]=A);0<=A?(f++,l+=A):(g++,h+=A);s+=A;y++;E[0]=Math.max(A,E[0]);c[0]=Math.min(A,c[0]);F[K]=A}0!=f&&(j=l/f);0!=g&&(k=h/g);0!=y&&(z=s/y);for(y=s=h=l=0;y<d;y++)A=
F[y],K=0,0<=A?(K=Math.pow(A-j,2),l+=K):(K=Math.pow(A-k,2),h+=K),K=Math.pow(A-z,2),s+=K;1<f&&(n=Math.sqrt(l/(f-1)));1<g&&(r=Math.sqrt(h/(g-1)));c[1]=k-2.5*r;E[1]=j+2.5*n;d=e.length;f=new Float32Array(3*d);for(y=0;y<d;y++)g=F[e[y]],h=3*y,f[h]=g,f[h+1]=g,f[h+2]=g;b.G.cb=c[1];b.G.ma=E[1];-Infinity==b.G.fa&&(b.G.fa=c[1]);Infinity==b.G.ga&&(b.G.ga=E[1]);b.G.F=F;b.G.Pc=f;b.G.j=q;D.Ua(this.g+".parse");e=new jd;e.K=b;e.B=a;this.dispatchEvent(e)};B("X.parserCRV",Nf);B("X.parserCRV.prototype.parse",Nf.prototype.parse);function Of(){Me.call(this);this.g="parserTRK"}C(Of,Me);
Of.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");var e=b.h,d=b.q,f=b.la;this.P=c;Z(this,"uchar",6);Z(this,"ushort",3);var g=Z(this,"float",3);Z(this,"float",3);var h=Z(this,"ushort");Z(this,"uchar",200);Z(this,"ushort");Z(this,"uchar",200);c=Z(this,"float",16);Z(this,"uchar",444);Z(this,"uchar",4);Z(this,"uchar",4);Z(this,"float",6);Z(this,"uchar",2);Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");Z(this,"uchar");var l=Z(this,"uint");Z(this,"uint");var j=Z(this,
"uint"),k=[],n=[],r=Infinity,s=-Infinity,z=t,y=t,E=t,F=t,d=e=t,K=Z(this,"uint",(this.P.byteLength-1E3)/4);this.R=j;for(var A=Z(this,"float",(this.P.byteLength-1E3)/4),G=0,j=f=0;j<l;j++){for(var I=K[G],H=new W(3*I),R=0,N=0;N<I;N++){var S=A[G+3*N+N*h+1],ba=A[G+3*N+N*h+2],aa=A[G+3*N+N*h+3],S=S/g[0],ba=ba/g[1],aa=aa/g[2];H.add(S,ba,aa);if(0<N)var ca=H.get(N-1),R=R+Math.sqrt(Math.pow(S-ca[0],2)+Math.pow(ba-ca[1],2)+Math.pow(aa-ca[2],2));N<I-1&&(f+=6)}G+=3*I+I*h+1;N=H.eb;I=H.$a;S=H.fb;ba=H.ab;aa=H.gb;ca=
H.bb;if(!z||N<z)z=N;if(!y||I>y)y=I;if(!E||S<E)E=S;if(!F||ba>F)F=ba;if(!e||aa<e)e=aa;if(!d||ca>d)d=ca;k.push(H);n.push(R)}g=(z+y)/2;E=(E+F)/2;h=(e+d)/2;F=new Float32Array(f);b.h=e=new W(f);b.q=d=new W(f);b.la=f=new W(f);for(j=z=0;j<l;j++){y=k[j];K=y.count;R=n[j];r=Math.min(r,R);s=Math.max(s,R);for(N=0;N<K-1;N++){G=y.get(N);A=y.get(N+1);e.add(G[0],G[1],G[2]);e.add(A[0],A[1],A[2]);var H=G[0]-g,I=G[1]-E,S=G[2]-h,ba=Math.sqrt(H*H+I*I+S*S),aa=A[0]-g,ca=A[1]-E,M=A[2]-h,T=Math.sqrt(aa*aa+ca*ca+M*M);d.add(H/
ba,I/ba,S/ba);d.add(aa/T,ca/T,M/T);A=[Math.abs(A[0]-G[0]),Math.abs(A[1]-G[1]),Math.abs(A[2]-G[2])];G=Math.sqrt(A[0]*A[0]+A[1]*A[1]+A[2]*A[2]);A[0]/=G;A[1]/=G;A[2]/=G;f.add(A[0],A[1],A[2]);f.add(A[0],A[1],A[2]);F[z++]=R;F[z++]=R;F[z++]=R;F[z++]=R;F[z++]=R;F[z++]=R}}b.Da="LINES";l=new id;l.cb=r;l.ma=s;l.fa=r;l.ga=s;l.Pc=F;l.jg=u;l.j=q;b.G=l;D.Ua(this.g+".parse");D.f.Lf(c,b.ca.N);c=new jd;c.K=b;c.B=a;this.dispatchEvent(c)};B("X.parserTRK",Of);B("X.parserTRK.prototype.parse",Of.prototype.parse);function Pf(){Me.call(this);this.g="parserIMAGE"}C(Pf,Me);Pf.prototype.parse=function(a,b,c,e){c instanceof ArrayBuffer||m(Error());for(var d=new Uint8Array(c),f=d.length,g=Array(f);f--;)g[f]=String.fromCharCode(d[f]);d=window.btoa(g.join(""));f=new Image;$b(f,"load",this.nj.bind(this,f,a,b,c,e));f.src="data:image/"+e+";base64,"+d};Pf.prototype.nj=function(a,b,c){b.Jb=a;b.Tb=t;a=new jd;a.K=c;a.B=b;this.dispatchEvent(a)};B("X.parserIMAGE",Pf);B("X.parserIMAGE.prototype.parse",Pf.prototype.parse);function Qf(){Me.call(this);this.g="parserLUT"}C(Qf,Me);
Qf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");this.P=c;c=Z(this,"uchar",c.byteLength);var e=c.length,d=0,f;for(f=0;f<e;f++)if(10==c[f]){var g=Oe(c,d,f),d=f+1,g=g.replace(/^\s+|\s+$/g,"");"#"!=g[0]&&(g=g.split(" "),g=g.filter(function(a){return""!=a}),6==g.length&&(g[2]=parseInt(g[2],10)/255,g[3]=parseInt(g[3],10)/255,g[4]=parseInt(g[4],10)/255,g[5]=parseInt(g[5],10)/255,a.add(parseInt(g[0],10),g[1],g[2],g[3],g[4],g[5],10)))}D.Ua(this.g+".parse");c=new jd;c.K=b;c.B=a;this.dispatchEvent(c)};
B("X.parserLUT",Qf);B("X.parserLUT.prototype.parse",Qf.prototype.parse);function Rf(){Me.call(this);this.g="parserNRRD"}C(Rf,Me);
Rf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");this.P=c;c=Z(this,"uchar",c.byteLength);var e=c.length,d=t,f=0,g;for(g=1;g<e;g++)if(10==c[g-1]&&10==c[g]){d=Oe(c,0,g-2);f=g+1;break}var h,l,j,k,e=d.split(/\r?\n/),d=0;for(g=e.length;d<g;d++)if(h=e[d],h.match(/NRRD\d+/))this.Ci=q;else if(!h.match(/^#/)&&(k=h.match(/(.*):(.*)/)))l=k[1].trim(),h=k[2].trim(),(j=this.fi[l])?j.call(this,h):this[l]=h;this.Ci||m(Error("Not an NRRD file"));"raw"!==this.encoding&&("gzip"!==this.encoding&&"gz"!==this.encoding)&&
m(Error("Only raw or gz/gzip encoding is allowed"));if(!this.aa&&(this.aa=[new U(1,0,0),new U(0,1,0),new U(0,0,1)],this.If)){e=[];for(k=0;2>=k;k++)e.push(!isNaN(this.If[k])?this.aa[k].scale(this.If[k]):p)}f=c.subarray(f);if("gzip"==this.encoding||"gz"==this.encoding)f=(new Kf(new Uint8Array(f))).rd();f=f.buffer;c={data:t,min:Infinity,max:-Infinity};c.data=new this.Hb(f);k=Ne(c.data);f=c.min=k[0];k=c.max=k[1];b.cb=b.ia=f;b.ma=b.ha=k;b.oa=[this.Gf[0],this.Gf[1],this.Gf[2]];e=(new U(this.aa[0][0],this.aa[0][1],
this.aa[0][2])).Bb();d=(new U(this.aa[1][0],this.aa[1][1],this.aa[1][2])).Bb();g=(new U(this.aa[2][0],this.aa[2][1],this.aa[2][2])).Bb();b.kd=[e,d,g];-Infinity==b.fa&&(b.fa=f);Infinity==b.ga&&(b.ga=k);e=k=1;"left-posterior-superior"==this.Ej&&(e=k=-1);f=Rc();V(f,0,k*this.aa[0][0],k*this.aa[1][0],k*this.aa[2][0],k*this.Hf[0]);V(f,1,e*this.aa[0][1],e*this.aa[1][1],e*this.aa[2][1],e*this.Hf[1]);V(f,2,1*this.aa[0][2],1*this.aa[1][2],1*this.aa[2][2],1*this.Hf[2]);V(f,3,0,0,0,1);c.Fb=f;c.Gb=Qc();Zc(c.Fb,
c.Gb);e=Pc(0,0,0,1);k=Oc();ad(f,e,k);d=Pc(1,1,1,1);e=Oc();ad(f,d,e);f=Pe(f,b.oa);c.Fd=[e[0]-k[0],e[1]-k[1],e[2]-k[2]];c.Dd=[f[1]-f[0]+1,f[3]-f[2]+1,f[5]-f[4]+1];c.Ed=[f[0],f[2],f[4]];b.hc(c);D.Ua(this.g+".parse");b.Jb=Ve(this,b);c=new jd;c.K=b;c.B=a;this.dispatchEvent(c)};
Rf.prototype.fi={type:function(a){switch(a){case "uchar":case "unsigned char":case "uint8":case "uint8_t":this.Hb=Uint8Array;break;case "signed char":case "int8":case "int8_t":this.Hb=Int8Array;break;case "short":case "short int":case "signed short":case "signed short int":case "int16":case "int16_t":this.Hb=Int16Array;break;case "ushort":case "unsigned short":case "unsigned short int":case "uint16":case "uint16_t":this.Hb=Uint16Array;break;case "int":case "signed int":case "int32":case "int32_t":this.Hb=
Int32Array;break;case "uint":case "unsigned int":case "uint32":case "uint32_t":this.Hb=Uint32Array;break;case "float":this.Hb=Float32Array;break;case "double":this.Hb=Float64Array;break;default:m(Error("Unsupported NRRD data type: "+a))}return this.type=a},endian:function(a){return this.Ok=a},encoding:function(a){return this.encoding=a},dimension:function(a){return this.Vb=parseInt(a,10)},sizes:function(a){var b,c,e,d;e=a.split(/\s+/);d=[];b=0;for(c=e.length;b<c;b++)a=e[b],d.push(parseInt(a,10));
return this.Gf=d},space:function(a){return this.Ej=a},"space origin":function(a){return this.Hf=a.split("(")[1].split(")")[0].split(",")},"space directions":function(a){var b,c;a=a.match(/\(.*?\)/g);var e,d,f;f=[];e=0;for(d=a.length;e<d;e++)c=a[e],f.push(function(){var a,d,e,f;e=c.slice(1,-1).split(/,/);f=[];a=0;for(d=e.length;a<d;a++)b=e[a],f.push(parseFloat(b));return f}());return this.aa=f},spacings:function(a){var b;b=a.split(/\s+/);var c,e,d;d=[];c=0;for(e=b.length;c<e;c++)a=b[c],d.push(parseFloat(a));
return this.If=d}};B("X.parserNRRD",Rf);B("X.parserNRRD.prototype.parse",Rf.prototype.parse);function Sf(){Me.call(this);this.g="parserNII"}C(Sf,Me);
Sf.prototype.parse=function(a,b,c){var e=c,d=-1,d="undefined"==typeof DataView?(new Int32Array(c,0,1))[0]:(new DataView(c,0)).getInt32(0,q);348!=d&&(e=(new Kf(new Uint8Array(e))).rd(),e=e.buffer);c=this.yd(e);e=c.min;d=c.max;b.cb=b.ia=e;b.ma=b.ha=d;-Infinity==b.fa&&(b.fa=e);Infinity==b.ga&&(b.ga=d);e=Qc();V(e,3,0,0,0,1);if(0<c.Cf){var d=0,f=c.eh,g=c.fh,h=c.gh,l=1,j=1,k=1,n=c.ah,r=c.bh,s=c.dh,d=1-(f*f+g*g+h*h);1E-7>d?(d=1/Math.sqrt(f*f+g*g+h*h),f*=d,g*=d,h*=d,d=0):d=Math.sqrt(d);0<c.kb[1]&&(l=c.kb[1]);
0<c.kb[2]&&(j=c.kb[2]);0<c.kb[2]&&(k=c.kb[3]);0>c.kb[0]&&(k=-k);V(e,0,(d*d+f*f-g*g-h*h)*l,2*(f*g-d*h)*j,2*(f*h+d*g)*k,n);V(e,1,2*(f*g+d*h)*l,(d*d+g*g-f*f-h*h)*j,2*(g*h-d*f)*k,r);V(e,2,2*(f*h-d*g)*l,2*(g*h+d*f)*j,(d*d+h*h-g*g-f*f)*k,s)}else 0<c.ih?(d=c.kh,f=c.lh,g=c.mh,V(e,0,d[0],d[1],d[2],d[3]),V(e,1,f[0],f[1],f[2],f[3]),V(e,2,g[0],g[1],g[2],g[3])):0==c.Cf?(V(e,0,c.kb[1],0,0,0),V(e,1,0,c.kb[2],0,0),V(e,2,0,0,c.kb[3],0)):window.console.log("UNKNOWN METHOD IN PARSER NII");c.Fb=e;c.Gb=Qc();Zc(c.Fb,c.Gb);
f=Pc(0,0,0,1);d=Oc();ad(e,f,d);g=Pc(1,1,1,1);f=Oc();ad(e,g,f);g=[c.Vb[1],c.Vb[2],c.Vb[3]];e=Pe(e,g);c.Fd=[f[0]-d[0],f[1]-d[1],f[2]-d[2]];c.Dd=[e[1]-e[0]+1,e[3]-e[2]+1,e[5]-e[4]+1];c.Ed=[e[0],e[2],e[4]];b.oa=g;b.hc(c);b.Jb=Ve(this,b);c=new jd;c.K=b;c.B=a;this.dispatchEvent(c)};
Sf.prototype.yd=function(a){this.P=a;a={yj:0,Wh:t,Xh:t,ei:0,wj:0,rj:0,ai:t,Vb:t,yi:0,zi:0,Ai:0,wi:0,df:0,Rh:0,Dj:0,kb:t,rh:0,vj:0,uj:0,Cj:0,Aj:t,Lj:t,Sh:0,Th:0,Bj:0,Ij:0,li:0,mi:0,Zh:t,Qh:t,Cf:0,ih:0,eh:0,fh:0,gh:0,ah:0,bh:0,dh:0,kh:t,lh:t,mh:t,xi:t,Ei:t,data:t,min:Infinity,max:-Infinity};a.yj=Z(this,"uint");a.Wh=Z(this,"uchar",10);a.Xh=Z(this,"uchar",18);a.ei=Z(this,"uint");a.wj=Z(this,"ushort");a.rj=Z(this,"uchar");a.ai=Z(this,"uchar");a.Vb=Z(this,"ushort",8);a.yi=Z(this,"float");a.zi=Z(this,"float");
a.Ai=Z(this,"float");a.wi=Z(this,"ushort");a.df=Z(this,"ushort");a.Rh=Z(this,"ushort");a.Dj=Z(this,"ushort");a.kb=Z(this,"float",8);a.rh=Z(this,"float");a.vj=Z(this,"float");a.uj=Z(this,"float");a.Cj=Z(this,"ushort");a.Aj=Z(this,"uchar");a.Lj=Z(this,"uchar");a.Sh=Z(this,"float");a.Th=Z(this,"float");a.Bj=Z(this,"float");a.Ij=Z(this,"float");a.li=Z(this,"uint",1);a.mi=Z(this,"uint",1);a.Zh=Z(this,"uchar",80);a.Qh=Z(this,"uchar",24);a.Cf=Z(this,"ushort");a.ih=Z(this,"ushort");a.eh=Z(this,"float");a.fh=
Z(this,"float");a.gh=Z(this,"float");a.ah=Z(this,"float");a.bh=Z(this,"float");a.dh=Z(this,"float");a.kh=Z(this,"float",4);a.lh=Z(this,"float",4);a.mh=Z(this,"float",4);a.xi=Z(this,"uchar",16);a.Ei=Z(this,"uchar",4);this.R=parseInt(a.rh,10);var b=a.Vb[1]*a.Vb[2]*a.Vb[3];switch(a.df){case 2:a.data=Z(this,"uchar",b);break;case 4:a.data=Z(this,"sshort",b);break;case 8:a.data=Z(this,"sint",b);break;case 16:a.data=Z(this,"float",b);break;case 32:a.data=Z(this,"complex",b);break;case 64:a.data=Z(this,"double",
b);break;case 256:a.data=Z(this,"schar",b);break;case 512:a.data=Z(this,"ushort",b);break;case 768:a.data=Z(this,"uint",b);break;default:m(Error("Unsupported NII data type: "+a.df))}b=Ne(a.data);a.min=b[0];a.max=b[1];return a};B("X.parserNII",Sf);B("X.parserNII.prototype.parse",Sf.prototype.parse);function Tf(){Me.call(this);this.g="parserOBJ"}C(Tf,Me);
Tf.prototype.parse=function(a,b,c){D.Ya(this.g+".parse");this.P=c;c=c.byteLength;var e=Z(this,"uchar",c),d=[];b.h=new W(c);b.q=new W(c);var f=b.h,g=b.q,h=0,l;for(l=0;l<c;++l)if(10==e[l]){var j=Oe(e,h,l).replace(/\s{2,}/g," ").split(" ");if("v"==j[0])d.push([parseFloat(j[1]),parseFloat(j[2]),parseFloat(j[3])]);else if("f"==j[0]){var k=d[parseInt(j[1],10)-1],h=d[parseInt(j[2],10)-1],j=d[parseInt(j[3],10)-1];f.add(k[0],k[1],k[2]);f.add(h[0],h[1],h[2]);f.add(j[0],j[1],j[2]);k=new U(k[0],k[1],k[2]);j=
new U(j[0],j[1],j[2]);h=Hc((new U(h[0],h[1],h[2])).Ea(k),j.Ea(k));h.normalize();g.add(h.x,h.y,h.d);g.add(h.x,h.y,h.d);g.add(h.x,h.y,h.d)}h=l+1}D.Ua(this.g+".parse");c=new jd;c.K=b;c.B=a;this.dispatchEvent(c)};B("X.parserOBJ",Tf);B("X.parserOBJ.prototype.parse",Tf.prototype.parse);function Uf(){O.call(this);this.g="loader";this.yc=new yc;this.bd=0}C(Uf,O);function Vf(a,b){a.bd+=b/a.yc.ee()/3;a.bd=Math.min(1,a.bd);var c=new Md;c.od=a.bd;a.dispatchEvent(c)}function Wf(a){a=a.r.Sd;var b=a.split(".").pop().toUpperCase();b==a.toUpperCase()&&(b="");b in Xf||m(Error("The "+b+" file format is not supported."));return[a,b,Xf[b][0],Xf[b][1],Xf[b][2]]}
Uf.prototype.load=function(a,b){(!a||!b)&&m(Error("No container or object to load."));if(!Bc(this.yc.$,a.ta)||this.yc.get(a.ta)){this.yc.set(a.ta,u);var c=Wf(a)[0];if(a.mb!=t)this.parse(t,a,b);else{var e=new XMLHttpRequest;L(e,"abort",this.xg.bind(this,e,a,b));L(e,"error",this.xg.bind(this,e,a,b));L(e,"load",this.parse.bind(this,e,a,b));e.open("GET",c,q);e.responseType="arraybuffer";e.send(t)}}};
Uf.prototype.parse=function(a,b,c){Vf(this,1);setTimeout(function(){var e=Wf(b),d=e[3],e=new e[2];$b(e,wd,this.complete.bind(this));var f=b.mb;f==t&&(f=a.response,b.mb=f);e.parse(b,c,f,d)}.bind(this),100)};Uf.prototype.complete=function(a){Vf(this,1);setTimeout(function(){var b=a.B,c=a.K;b.r.j=u;b.j=q;c.p();this.yc.set(b.ta,q)}.bind(this),100)};Uf.prototype.xg=function(a,b,c){m(Error("Loading failed: ",b,c))};
var Xf={OBJ:[Tf,t],STL:[Ze,t],VTK:[bf,t],TRK:[Of,t],FSM:[df,t],INFLATED:[df,t],SMOOTHWM:[df,t],SPHERE:[df,t],PIAL:[df,t],ORIG:[df,t],NRRD:[Rf,t],NII:[Sf,t],GZ:[Sf,t],DCM:[$e,t],DICOM:[$e,t],"":[$e,t],CRV:[Nf,t],LABEL:[Mf,t],MGH:[Lf,u],MGZ:[Lf,q],TXT:[Qf,t],LUT:[Qf,t],PNG:[Pf,"png"],JPG:[Pf,"jpeg"],JPEG:[Pf,"jpeg"],GIF:[Pf,"gif"]};function Yf(a,b){(!x(a)||!x(b))&&m(Error("A camera needs valid width and height values."));O.call(this);this.g="camera";this.cc=new D.m(0,100,0);this.sc=new D.m(0,0,0);this.Z=new D.m(0,0,1);this.H=a;this.v=b;this.n=this.me(this.cc,this.sc)}C(Yf,O);Yf.prototype.observe=function(a){(a==t||!(a instanceof Ge))&&m(Error("Could not observe the interactor."));L(a,rd,this.Zi.bind(this));L(a,qd,this.Wi.bind(this));L(a,sd,this.lj.bind(this))};
Yf.prototype.Zi=function(a){a instanceof Gd||m(Error("Received no valid rotate event."));this.rotate(a.sa)};Yf.prototype.lj=function(a){a instanceof Hd||m(Error("Received no valid zoom event."));a.nb?this.Pf(a.Za):this.Qf(a.Za)};Yf.prototype.Wi=function(a){a instanceof Fd||m(Error("Received no valid pan event."));this.zf(a.sa)};Yf.prototype.__defineGetter__("view",v("n"));
Yf.prototype.__defineSetter__("view",function(a){(a==t||!(a instanceof Float32Array))&&m(Error("Invalid view matrix."));this.n=a});Yf.prototype.__defineGetter__("position",function(){return[this.cc.x,this.cc.y,this.cc.d]});Yf.prototype.__defineSetter__("position",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid position."));this.cc=new D.m(a[0],a[1],a[2]);this.reset()});Yf.prototype.__defineGetter__("focus",function(){return[this.sc.x,this.sc.y,this.sc.d]});
Yf.prototype.__defineSetter__("focus",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid focus"));this.sc=new D.m(a[0],a[1],a[2]);this.reset()});Yf.prototype.__defineGetter__("up",function(){return[this.Z.x,this.Z.y,this.Z.d]});Yf.prototype.__defineSetter__("up",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid up vector."));this.Z=new D.m(a[0],a[1],a[2]);this.reset()});w=Yf.prototype;w.reset=function(){this.n=this.me(this.cc,this.sc)};
w.rotate=function(a){la(a)&&2==a.length?a=new D.m(a[0],a[1],0):a instanceof D.m||m(Error("Invalid distance vector for rotate operation."));return a};w.zf=function(a){la(a)&&2==a.length?a=new D.m(a[0],a[1],0):a instanceof D.m||m(Error("Invalid distance vector for pan operation."));this.n[12]-=a.x;this.n[13]+=a.y};w.Pf=function(a){var b=20;a!=t&&!a&&(b=1);this.n[14]+=b};w.Qf=function(a){var b=20;a!=t&&!a&&(b=1);this.n[14]-=b};
w.me=function(a,b){(!(a instanceof D.m)||!(b instanceof D.m))&&m(Error("3D vectors required for calculating the view."));return D.f.td()};B("X.camera",Yf);B("X.camera.prototype.pan",Yf.prototype.zf);B("X.camera.prototype.rotate",Yf.prototype.rotate);B("X.camera.prototype.zoomIn",Yf.prototype.Pf);B("X.camera.prototype.zoomOut",Yf.prototype.Qf);function Zf(a){function b(a,b,e){b=2*b*Math.PI;b=Aa(Ba(l,Math.cos(b)),Ba(j,Math.sin(b)));a=Aa(Aa(c,Ba(d,a)),Ba(b,f));e=Aa(Ba(b,1-Math.abs(e)),Ba(g,e));return new jc(a,e)}this.V=[];a=a||{};var c=new ya(a.start||[0,-1,0]),e=new ya(a.end||[0,1,0]),d=Ca(e,c),f=a.qb||1;a=a.na||16;for(var g=Da(d),h=0.5<Math.abs(g.y()),l=Da((new ya(h,!h,0)).ic(g)),j=Da(l.ic(g)),h=new jc(c,Fa(g)),e=new jc(e,Da(g)),k=[],n=0;n<a;n++){var r=n/a,s=(n+1)/a;k.push(new lc([h,b(0,r,-1),b(0,s,-1)]));k.push(new lc([b(0,s,0),b(0,r,
0),b(1,r,0),b(1,s,0)]));k.push(new lc([e,b(1,s,1),b(1,r,1)]))}return tc(k)}C(Zf,sc);function $f(){Y.call(this);this.g="cylinder";this.Re=[-10,-10,-10];this.Ae=[10,10,10];this.dc=10;this.Wa=32;Ga(this,new md)}C($f,Y);$f.prototype.__defineGetter__("start",v("Re"));$f.prototype.__defineSetter__("start",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid start"));this.Re=a});$f.prototype.__defineGetter__("end",v("Ae"));$f.prototype.__defineSetter__("end",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid end"));this.Ae=a});$f.prototype.__defineGetter__("radius",v("dc"));
$f.prototype.__defineSetter__("radius",function(a){x(a)||m(Error("Invalid radius."));this.dc=a});$f.prototype.p=function(){od(this,new Zf({start:this.Re,end:this.Ae,qb:this.dc,na:this.Wa}));$f.z.p.call(this)};B("X.cylinder",$f);B("X.cylinder.prototype.modified",$f.prototype.p);function ag(a){function b(a,b){a*=2*Math.PI;b*=Math.PI;var d=new ya(Math.cos(a)*Math.sin(b),Math.cos(b),Math.sin(a)*Math.sin(b));g.push(new jc(Aa(c,Ba(d,e)),d))}this.V=[];a=a||{};var c=new ya(a.$e||[0,0,0]),e=a.qb||1,d=a.na||16;a=a.Fj||8;for(var f=[],g=[],h=0;h<d;h++)for(var l=0;l<a;l++)g=[],b(h/d,l/a),0<l&&b((h+1)/d,l/a),l<a-1&&b((h+1)/d,(l+1)/a),b(h/d,(l+1)/a),f.push(new lc(g));return tc(f)}C(ag,sc);function bg(){Y.call(this);this.g="sphere";this.A=[0,0,0];this.dc=5;this.Wa=32;this.Ih=16;Ga(this,new md)}C(bg,Y);bg.prototype.__defineGetter__("center",v("A"));bg.prototype.__defineSetter__("center",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid center"));this.A=a});bg.prototype.__defineGetter__("radius",v("dc"));bg.prototype.__defineSetter__("radius",function(a){x(a)||m(Error("Invalid radius."));this.dc=a});
bg.prototype.p=function(){od(this,new ag({$e:this.A,qb:this.dc,na:this.Wa,Fj:this.Ih}));bg.z.p.call(this)};B("X.sphere",bg);B("X.sphere.prototype.modified",bg.prototype.p);function Xe(a){Q.call(this);this.g="labelmap";this.zb=a;this.Qe=new Float32Array([-255,-255,-255,-255])}C(Xe,Q);Xe.prototype.p=function(){var a=new jd;a.K=this;this.dispatchEvent(a);this.zb.p()};Xe.prototype.__defineSetter__("showOnly",function(a){var b=[-1,-1,-1,-1];a!=t&&(la(a)&&4==a.length?b=a:(this.Aa||m(Error("No colortable assigned.")),b=this.Aa.Fa.get(a).slice(1,5)));this.Qe=new Float32Array([Math.floor(255*b[0]),Math.floor(255*b[1]),Math.floor(255*b[2]),Math.floor(255*b[3])])});
B("X.labelmap",Xe);function cg(a){this.V=[];a=a||{};var b=new ya(a.$e||[0,0,0]),c=!a.qb?[1,1,1]:a.qb.length?a.qb:[a.qb,a.qb,a.qb];return tc([[[0,4,6,2],[-1,0,0]],[[1,3,7,5],[1,0,0]],[[0,1,5,4],[0,-1,0]],[[2,6,7,3],[0,1,0]],[[0,2,3,1],[0,0,-1]],[[4,5,7,6],[0,0,1]]].map(function(a){return new lc(a[0].map(function(d){d=new ya(b.x()+c[0]*(2*!!(d&1)-1),b.y()+c[1]*(2*!!(d&2)-1),b.d()+c[2]*(2*!!(d&4)-1));return new jc(d,new ya(a[1]))}))}))}C(cg,sc);function dg(){Y.call(this);this.g="cube";this.A=[0,0,0];this.Fe=this.Ee=this.De=20;this.Fc=[0,1,1,1,1,0,0,1,1,0,0,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0,0,0,0,1,1,1,0,0,1,1,1,0,1,1,1,0,0,0,1,1,0,0,0,1,0,1,1,1,1,0,0,1,1,0,0,0];Ga(this,new md)}C(dg,Y);dg.prototype.__defineGetter__("center",v("A"));dg.prototype.__defineSetter__("center",function(a){(a==t||!la(a)||3!=a.length)&&m(Error("Invalid center"));this.A=a});dg.prototype.__defineGetter__("lengthX",v("De"));
dg.prototype.__defineSetter__("lengthX",function(a){x(a)||m(Error("Invalid lengthX."));this.De=a});dg.prototype.__defineGetter__("lengthY",v("Ee"));dg.prototype.__defineSetter__("lengthY",function(a){x(a)||m(Error("Invalid lengthY."));this.Ee=a});dg.prototype.__defineGetter__("lengthZ",v("Fe"));dg.prototype.__defineSetter__("lengthZ",function(a){x(a)||m(Error("Invalid lengthZ."));this.Fe=a});dg.prototype.p=function(){od(this,new cg({$e:this.A,qb:[this.De/2,this.Ee/2,this.Fe/2]}));dg.z.p.call(this)};
B("X.cube",dg);B("X.cube.prototype.modified",dg.prototype.p);function Ie(a){Ge.call(this,a);this.g="interactor3D";this.Bk=u}C(Ie,Ge);Ie.prototype.wd=function(a){Ie.z.wd.call(this,a);var b=new Hd;a.Jc==t&&(a.Jc=0);b.nb=0>a.Jc;b.Za=q;this.dispatchEvent(b)};function eg(a){O.call(this);this.g="array";this.F=[];this.Rf=a}C(eg,O);function fg(a,b,c){for(var e=0;4>e;e++)if(a[e+0]!==b[e+c])return u;return q}eg.prototype.add=function(a){this.F.push(a);return q};eg.prototype.remove=function(a){a=this.F.indexOf(a);-1<a&&this.F.splice(a,1);return q};eg.prototype.clear=function(){this.F.length=0};
function gg(a,b,c){var e=c-b;if(!(2>e)){e=b+Math.floor(e/2);gg(a,b,e);for(gg(a,e,c);b<e;++b)if(0<a.Rf(a.F[b],a.F[e])){var d=a.F[b];a.F[b]=a.F[e];for(var f=a,g=e,h=c;g+1<h&&0>f.Rf(f.F[g+1],d);){var l=f,j=g+1,k=l.F[g];l.F[g]=l.F[j];l.F[j]=k;++g}f.F[g]=d}}}eg.prototype.sort=function(){gg(this,0,this.F.length)};function hg(a,b){Yf.call(this,a,b);this.g="camera2D"}C(hg,Yf);hg.prototype.rotate=function(a){a=hg.z.rotate.call(this,a);var b=new Ed;0<a.x?b.Te--:0>a.x&&b.Te++;0<a.y?b.Ge++:0>a.y&&b.Ge--;this.dispatchEvent(b)};hg.prototype.Pf=function(a){var b=20;a!=t&&!a&&(b=0.02);this.n[14]+=b};hg.prototype.Qf=function(a){var b=20;a!=t&&!a&&(b=0.02);this.n[14]-=b};
hg.prototype.zf=function(a){la(a)&&2==a.length?a=new D.m(a[0],a[1],0):a instanceof D.m||m(Error("Invalid distance vector for pan operation."));this.n[12]-=a.x/this.n[14];this.n[13]+=a.y/this.n[14]};function ig(a,b){Yf.call(this,a,b);this.g="camera3D";this.Uf=45;this.Le=D.f.mf(D.f.td(),this.Uf,a/b,1,1E4)}C(ig,Yf);ig.prototype.rotate=function(a){a=ig.z.rotate.call(this,a);var b=-a.x/5*Math.PI/180;a=-a.y/5*Math.PI/180;var c=new D.m(this.n[1],this.n[5],this.n[9]),e=new D.m(this.n[0],this.n[4],this.n[8]);c.normalize();e.normalize();D.f.rotate(this.n,b,c.x,c.y,c.d);D.f.rotate(this.n,a,e.x,e.y,e.d)};ig.prototype.me=function(a,b){var c=ig.z.me.call(this,a,b);D.f.Mg(c,a,b,this.Z);return c};
function jg(a,b,c,e){var d=new Float32Array(4),f=new Float32Array(4),g=new Float32Array(16),h=new Float32Array(16);new Float32Array(16);D.f.multiply(a.Le,a.n,h);D.f.U(h,g);d[0]=b;d[1]=c;d[2]=2*e-1;d[3]=1;D.f.Qg(g,d,f);f[3]=1/f[3];f[0]*=f[3];f[1]*=f[3];f[2]*=f[3];return f}B("X.camera3D",ig);function kg(a){Pb.call(this);this.Ab=a;this.Q=[]}C(kg,Pb);var lg=[];function mg(a,b,c,e,d){la(c)||(lg[0]=c,c=lg);for(var f=0;f<c.length;f++){var g=L(b,c[f],e||a,d||u,a.Ab||a);a.Q.push(g)}}kg.prototype.Df=function(){Jb(this.Q,bc);this.Q.length=0};kg.prototype.handleEvent=function(){m(Error("EventHandler.handleEvent not implemented"))};function ng(){}ng.zg=function(){return ng.Hg?ng.Hg:ng.Hg=new ng};ng.prototype.Ji=0;ng.zg();function og(a){ic.call(this);this.Wb=a||Xd();this.tj=pg}C(og,ic);og.prototype.ui=ng.zg();var pg=t;w=og.prototype;w.Gg=t;w.Lc=u;w.D=t;w.tj=t;w.xd=t;w.qd=t;w.af=t;w.s=v("D");w.Ff=function(a){this.xd&&this.xd!=a&&m(Error("Method not supported"));og.z.Ff.call(this,a)};w.fe=v("Wb");w.Ic=function(){this.D=this.Wb.createElement("div")};w.Zb=function(a){this.$b(a)};
w.$b=function(a,b){this.Lc&&m(Error("Component already rendered"));this.D||this.Ic();a?a.insertBefore(this.D,b||t):this.Wb.da.body.appendChild(this.D);(!this.xd||this.xd.Lc)&&this.be()};w.be=function(){function a(a){!a.Lc&&a.s()&&a.be()}this.Lc=q;this.qd&&Jb(this.qd,a,p)};w.ce=function(){function a(a){a.Lc&&a.ce()}this.qd&&Jb(this.qd,a,p);this.ni&&this.ni.Df();this.Lc=u};
w.removeChild=function(a,b){if(a){var c=na(a)?a:a.Gg||(a.Gg=":"+(a.ui.Ji++).toString(36)),e;this.af&&c?(e=this.af,e=(c in e?e[c]:p)||t):e=t;a=e;c&&a&&(e=this.af,c in e&&delete e[c],Nb(this.qd,a),b&&(a.ce(),a.D&&de(a.D)),c=a,c==t&&m(Error("Unable to set parent component")),c.xd=t,og.z.Ff.call(c,t))}a||m(Error("Child is not in parent component"));return a};function qg(){ic.call(this)}C(qg,ic);w=qg.prototype;w.Nf=0;w.vd=0;w.nf=100;w.wg=0;w.Jf=1;w.Bi=u;w.Ii=u;w.Bd=function(a){a=rg(this,a);this.Nf!=a&&(this.Nf=a+this.wg>this.nf?this.nf-this.wg:a<this.vd?this.vd:a,!this.Bi&&!this.Ii&&this.dispatchEvent("change"))};w.ie=function(){return rg(this,this.Nf)};w.he=function(){return rg(this,this.vd)};w.ge=function(){return rg(this,this.nf)};function rg(a,b){return a.Jf==t?b:a.vd+Math.round((b-a.vd)/a.Jf)*a.Jf};function sg(a){og.call(this,a);this.zd=new qg;L(this.zd,"change",this.oi,u,this)}C(sg,og);var ug={vertical:"progress-bar-vertical",horizontal:"progress-bar-horizontal"};w=sg.prototype;w.Ic=function(){this.rb=this.fe().Ic("div","progress-bar-thumb");var a=ug[this.Yg];this.D=this.fe().Ic("div",a,this.rb);vg(this);a=this.he();this.s().setAttribute("aria-valuemin",a);a=this.ge();this.s().setAttribute("aria-valuemax",a)};
w.be=function(){sg.z.be.call(this);J&&7>vb&&L(this.s(),"resize",this.we,u,this);this.we();var a=this.s();a.setAttribute("role","progressbar");a.setAttribute("aria-live","polite")};w.ce=function(){sg.z.ce.call(this);J&&7>vb&&ac(this.s(),"resize",this.we,u,this)};w.ie=function(){return this.zd.ie()};w.Bd=function(a){this.zd.Bd(a);this.s()&&vg(this)};function vg(a){var b=a.ie();a.s().setAttribute("aria-valuenow",b)}w.he=function(){return this.zd.he()};w.ge=function(){return this.zd.ge()};w.Yg="horizontal";
w.oi=function(){this.we();this.dispatchEvent("change")};w.we=function(){if(this.rb){var a=this.he(),b=this.ge(),a=(this.ie()-a)/(b-a),b=Math.round(100*a);"vertical"==this.Yg?J&&7>vb?(this.rb.style.top=0,this.rb.style.height="100%",b=this.rb.offsetHeight,a=Math.round(a*b),this.rb.style.top=b-a+"px",this.rb.style.height=a+"px"):(this.rb.style.top=100-b+"%",this.rb.style.height=b+"%"):this.rb.style.width=b+"%"}};function wg(a,b){a==t&&m(Error("No valid parent element."));b==t&&m(Error("Invalid initial value."));sg.call(this);this.g="progressbar";this.Va=a;this.Ke="";this.Jd=this.yb=t;this.ac=[];var c;c=".progress-bar-horizontal {\n  position: relative;\n  border: 1px solid #949dad;\n";c+="  background: white;\n";c+="  padding: 1px;\n";c+="  overflow: hidden;\n";c+="  margin: 2px;\n";c+="  width: 100px;\n";c+="  height: 5px;\n";c+="}";var e;e=".progress-bar-thumb {\n  position: relative;\n  background: #F62217;\n";
e+="  overflow: hidden;\n";e+="  width: 0%;\n";e+="  height: 100%;\n";e+="}";var d;d=".progress-bar-thumb-done {\n  background: #57E964;\n}";this.ac=[c,e,d];this.Bd(b);this.hf()}C(wg,sg);
wg.prototype.hf=function(){var a=le(this.Va,"position");if("static"==a||""==a)this.Ke=this.Va.style.position,this.Va.style.position="relative";var a=document.getElementsByTagName("head")[0],b=be("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.ac[0])),e=document.createTextNode(String(this.ac[1])),d=document.createTextNode(String(this.ac[2]));a.appendChild(b);b.appendChild(c);b.appendChild(e);b.appendChild(d);this.yb=b;this.Zb(this.Va);a=this.s();a.style.position=
"absolute";a.style.top=(this.Va.clientHeight-5)/2+"px";a.style.left=(this.Va.clientWidth-100)/2+"px";a.classList.add("xtk-progress-bar")};function xg(a){var b=a.s().style.top,c=a.s().style.left;de(a.s());var e=new wg(a.Va,100),d=e.s();d.style.position="absolute";d.style.top=b;d.style.left=c;d.classList.add("xtk-progress-bar");(d.firstElementChild!=p?d.firstElementChild:ee(d.firstChild)).classList.add("progress-bar-thumb-done");a.Jd=e}
wg.prototype.ud=function(){this.yb&&de(this.yb);this.s()&&de(this.s());this.Jd&&de(this.Jd.s());this.Jd=this.yb=t;this.Ke&&(this.Va.style.position=this.Ke)};function yg(a,b,c){oa(a)?c&&(a=va(a,c)):a&&"function"==typeof a.handleEvent?a=va(a.handleEvent,a):m(Error("Invalid listener argument"));return 2147483647<b?-1:ga.setTimeout(a,b||0)};function zg(){O.call(this);this.g="renderer";this.B=window.document.body;this.H=this.B.clientWidth;this.v=this.B.clientHeight;this.S=this.J=this.za=t;this.pb=new eg(ld);this.hb=[];this.W=t;this.Rd=this.Rc=this.Pd=u;this.a=this.Sb=this.Ga=t;this.O={PROGRESSBAR_ENABLED:q,INTERMEDIATE_RENDERING:u,SLICENAVIGATORS:q};this.xe=-1;window.console.log("XTK release 10 -- 2013-11-07 14:57:41 -- http://www.goXTK.com -- @goXTK")}C(zg,O);w=zg.prototype;
w.sf=function(){window.cancelAnimationFrame(this.xe);this.O.PROGRESSBAR_ENABLED&&(this.Sb=new wg(this.B,3))};w.tf=function(){this.O.PROGRESSBAR_ENABLED&&this.Sb&&(xg(this.Sb),this.Gd=yg(function(){this.Gd=t;this.Sb&&(this.Sb.ud(),this.Sb=t);this.Rc=this.Rd=q;this.Zb()}.bind(this),700))};w.uf=function(a){this.Sb&&this.Sb.Bd(100*a.od)};w.Xi=function(a){this.Ga&&this.Ga.Bd(100*a.od)};w.Ni=function(a){a!=t&&a instanceof jd&&a.K&&this.sb(a.K)};w.Yi=function(a){a!=t&&a instanceof kd&&a.K&&this.remove(a.K)};
w.wf=function(a){(a==t||!(a instanceof Jd))&&m(Error("Invalid hover event."))};w.xf=function(){var a=$d(this.B);this.H=a.clientWidth;this.v=a.clientHeight;a=$d(this.za);a.width=this.H;a.height=this.v;"renderer3D"==this.g&&(this.a.viewport(0,0,this.H,this.v),this.J.Le=D.f.mf(D.f.td(),this.J.Uf,this.za.width/this.za.height,1,1E4))};w.yf=function(a){(a==t||!(a instanceof Id))&&m(Error("Invalid scroll event."))};zg.prototype.__defineGetter__("config",v("O"));
zg.prototype.__defineGetter__("interactor",v("S"));zg.prototype.__defineGetter__("camera",v("J"));zg.prototype.__defineGetter__("loadingCompleted",v("Rc"));zg.prototype.__defineGetter__("container",v("B"));zg.prototype.__defineSetter__("container",function(a){a==t&&m(Error("An ID to a valid container (<div>..) is required."));var b=a;na(b)&&(b=$d(a));pa(b)&&1==b.nodeType||m(Error("Could not find the given container."));this.B=b});w=zg.prototype;w.Ad=function(){this.J.reset()};
w.wa=function(a){var b=be("canvas");this.B.appendChild(b);this.H=this.B.clientWidth;this.v=this.B.clientHeight;b.width=this.H;b.height=this.v;try{var c=b.getContext(a);c||m(Error())}catch(e){var d="Sorry, "+a+' context is <strong>not supported</strong> on this machine! See <a href="http://crash.goXTK.com" target="_blank">http://crash.goXTK.com</a> for requirements..';this.B.innerHTML='<h3 style="color:red;font-family:sans-serif;">Oooops..</h3><p style="color:red;font-family:sans-serif;">'+d+"</p>";
m(Error(d))}this.W=new Uf;L(this.W,yd,this.Xi.bind(this));this.za=b;this.a=c;b=new Ie(this.za);"2d"==a&&(b=new Ke(this.za));b.wa();L(b,ud,this.Ad.bind(this));L(b,zd,this.wf.bind(this));L(b,td,this.yf.bind(this));this.S=b;b=new ig(this.H,this.v);"2d"==a&&(b=new hg(this.H,this.v));b.observe(this.S);this.J=b;L(window,"resize",this.xf,u,this)};w.add=function(a){(a instanceof dg||a instanceof bg||a instanceof $f)&&a.p();this.hb.push(a);this.sb(a)};
w.remove=function(a){(!this.za||!this.a)&&m(Error("The renderer was not initialized properly."));if(a!=t){var b=0;if(a!=t){if(a=qa(a),Wb[a]){a=Wb[a];for(var c=a.length-1;0<=c;c--)bc(a[c].key),b++}}else Na(Ub,function(a,c){bc(c);b++})}return u};
w.sb=function(a){(!this.za||!this.a)&&m(Error("The renderer was not initialized properly."));a!=t&&(dc(a,wd)||L(a,wd,this.Ni.bind(this)),dc(a,xd)||L(a,xd,this.Yi.bind(this)),dc(a,Bd)||L(a,Bd,this.sf.bind(this)),dc(a,Dd)||L(a,Dd,this.uf.bind(this)),dc(a,Cd)||L(a,Cd,this.tf.bind(this)))};w.get=function(a){a==t&&m(Error("Invalid object id."));for(var b=this.pb.F,c=b.length,e=0,e=0;e<c;e++)if(b[e].ta==a)return b[e];return t};
w.Zb=function(){(!this.za||!this.a)&&m(Error("The renderer was not initialized properly."));if(this.ig==t){if(Ac(this.W.yc)){if(this.O.PROGRESSBAR_ENABLED&&!this.Ga&&(this.Ga=new wg(this.B,3)),this.Rd=this.Rc=u,this.ig=yg(function(){this.ig=t;this.Zb()}.bind(this),100),!this.O.INTERMEDIATE_RENDERING)return}else if(!this.Rc&&!this.Rd&&(this.Rd=q,eval("this.onShowtime()"),this.Rc=q),this.Ga){this.O.PROGRESSBAR_ENABLED&&(this.Ga&&!this.Gd)&&(xg(this.Ga),this.Gd=yg(function(){this.Gd=t;this.Ga&&(this.Ga.ud(),
this.Ga=t);this.Zb()}.bind(this),700));return}this.xe=window.requestAnimationFrame(this.Zb.bind(this));eval("this.onRender()");this.$b(u,q)}};w.Xg=ea();w.Vg=ea();w.$b=ea();w.$d=function(){window.cancelAnimationFrame(this.xe);this.W&&(delete this.W,this.W=t);this.Ga&&(this.Ga.ud(),delete this.Ga,this.Ga=t);this.pb.clear();delete this.pb;this.hb.length=0;delete this.hb;delete this.W;this.W=t;delete this.J;this.J=t;delete this.S;this.S=t;delete this.a;this.a=t;de(this.za);delete this.za;this.za=t};function Ag(){O.call(this);this.g="shaders";this.Vd="";var a;a="precision mediump float;\n\n";a+="attribute vec3 vertexPosition;\n";a+="attribute vec3 vertexNormal;\n";a+="attribute vec3 vertexColor;\n";a+="attribute vec2 vertexTexturePos;\n";a+="attribute float vertexScalar;\n";a+="\n";a+="uniform mat4 view;\n";a+="uniform mat4 perspective;\n";a+="uniform vec3 center;\n";a+="uniform mat4 objectTransform;\n";a+="uniform bool useObjectColor;\n";a+="uniform bool useScalars;\n";a+="uniform bool scalarsReplaceMode;\n";
a+="uniform float scalarsMin;\n";a+="uniform float scalarsMax;\n";a+="uniform vec3 scalarsMinColor;\n";a+="uniform vec3 scalarsMaxColor;\n";a+="uniform float scalarsMinThreshold;\n";a+="uniform float scalarsMaxThreshold;\n";a+="uniform int scalarsInterpolation;\n";a+="uniform vec3 objectColor;\n";a+="uniform float pointSize;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";
a+="varying vec3 fTransformedVertexNormal;\n";a+="\n";a+="void main(void) {\n";a+="  fTransformedVertexNormal = mat3(view[0].xyz,view[1].xyz,view[2].xyz) * ";a+="mat3(objectTransform[0].xyz,objectTransform[1].xyz,objectTransform[2].xyz) * ";a+="vertexNormal;\n";a+="  fVertexNormal = vertexNormal;\n";a+="  fDiscardNow = 0.0;\n";a+="  vec3 vertexPosition2 = vertexPosition - center;\n";a+="  fVertexPosition = view * objectTransform * vec4(vertexPosition2, 1.0);\n";a+="  fragmentTexturePos = vertexTexturePos;\n";
a+="  if (useScalars) {\n";a+="    float scalarValue = vertexScalar;\n";a+="    if (scalarValue < scalarsMinThreshold || scalarValue > scalarsMaxThreshold) {\n";a+="      if (scalarsReplaceMode) {\n";a+="        fragmentColor = objectColor;\n";a+="      } else {\n";a+="        fDiscardNow = 1.0;\n";a+="      }\n";a+="    } else {\n";a+="      if (scalarsReplaceMode) {\n";a+="        if (scalarsInterpolation == 1) {\n";a+="            vec3 zeroMaxColor;\n";a+="            vec3 zeroMinColor;\n";a+=
"            zeroMaxColor[0] = scalarsMaxColor[0]*0.33;\n";a+="            zeroMaxColor[1] = scalarsMaxColor[1]*0.33;\n";a+="            zeroMaxColor[2] = scalarsMaxColor[2]*0.33;\n";a+="            zeroMinColor[0] = scalarsMinColor[0]*0.33;\n";a+="            zeroMinColor[1] = scalarsMinColor[1]*0.33;\n";a+="            zeroMinColor[2] = scalarsMinColor[2]*0.33;\n";a+="            if(scalarValue < 0.0) {fragmentColor = scalarValue/(scalarsMin) * scalarsMinColor + (1.0 - scalarValue/(scalarsMin)) * (zeroMinColor);}\n";
a+="            else {fragmentColor = scalarValue/(scalarsMax) * scalarsMaxColor + (1.0 - scalarValue/(scalarsMax)) * (zeroMaxColor);}\n";a+="        } else {\n";a+="            fragmentColor = scalarValue * scalarsMaxColor + (1.0 - scalarValue) * scalarsMinColor;\n";a+="          }\n";a+="      } else {\n";a+="        fragmentColor = vertexColor;\n";a+="      }\n";a+="    }\n";a+="  } else if (useObjectColor) {\n";a+="    fragmentColor = objectColor;\n";a+="  } else {\n";a+="    fragmentColor = vertexColor;\n";
a+="  }\n";a+="  gl_PointSize = pointSize;\n";a+="  gl_Position = perspective * fVertexPosition;\n";this.Vd=a+="}\n";this.Kd="";a="precision mediump float;\n\n";a+="uniform bool usePicking;\n";a+="uniform bool useTexture;\n";a+="uniform bool volumeTexture;\n";a+="uniform bool useLabelMapTexture;\n";a+="uniform sampler2D textureSampler;\n";a+="uniform sampler2D textureSampler2;\n";a+="uniform float objectOpacity;\n";a+="uniform float labelmapOpacity;\n";a+="uniform vec4 labelmapColor;\n";a+="uniform float volumeLowerThreshold;\n";
a+="uniform float volumeUpperThreshold;\n";a+="uniform float volumeScalarMin;\n";a+="uniform float volumeScalarMax;\n";a+="uniform vec3 volumeScalarMinColor;\n";a+="uniform vec3 volumeScalarMaxColor;\n";a+="uniform float volumeWindowLow;\n";a+="uniform float volumeWindowHigh;\n";a+="\n";a+="varying float fDiscardNow;\n";a+="varying vec4 fVertexPosition;\n";a+="varying vec3 fragmentColor;\n";a+="varying vec2 fragmentTexturePos;\n";a+="varying vec3 fVertexNormal;\n";a+="varying vec3 fTransformedVertexNormal;\n";
a+="\n";a+="void main(void) {\n";a+=" if (fDiscardNow > 0.0) {\n";a+="   discard;\n";a+=" }\n";a+=" if (usePicking) {\n";a+="   gl_FragColor = vec4(fragmentColor, 1.0);\n";a+=" } else if (useTexture) {\n";a+="   vec4 texture1 = texture2D(textureSampler,fragmentTexturePos);\n";a+="   vec4 textureSum = texture1;\n";a+="   if (volumeTexture) {\n";a+="     float _windowLow = (volumeWindowLow / volumeScalarMax);\n";a+="     float _windowHigh = (volumeWindowHigh / volumeScalarMax);\n";a+="     vec3 _minrange = vec3(_windowLow,_windowLow,_windowLow);\n";
a+="     vec3 _maxrange = vec3(_windowHigh,_windowHigh,_windowHigh);\n";a+="     vec3 fac = _maxrange - _minrange;\n";a+="     textureSum = vec4((textureSum.r - _minrange)/fac,1);\n";a+="     textureSum = textureSum.r * vec4(volumeScalarMaxColor,1) + (1.0 - textureSum.r) * vec4(volumeScalarMinColor,1);\n";a+="   }\n";a+="   if (useLabelMapTexture) {\n";a+="     vec4 texture2 = texture2D(textureSampler2,fragmentTexturePos);\n";a+="     if (texture2.a > 0.0) {\n";a+="         if (labelmapColor.a != -255.0) {\n";
a+="           if (all(equal(floor(texture2 * vec4(255)), labelmapColor))) {\n";a+="             if (labelmapOpacity < 1.0) {\n";a+="               textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="             } else {\n";a+="               textureSum = texture2;\n";a+="             }\n";a+="           }\n";a+="         } else {\n";a+="           if (labelmapOpacity < 1.0) {\n";a+="             textureSum = mix(texture2, textureSum, 1.0 - labelmapOpacity);\n";a+="           } else {\n";
a+="             textureSum = texture2;\n";a+="           }\n";a+="         }\n";a+="     }\n";a+="   }\n";a+="   if (volumeTexture) {\n";a+="     float _volumeLowerThreshold = (volumeLowerThreshold / volumeScalarMax);\n";a+="     float _volumeUpperThreshold = (volumeUpperThreshold / volumeScalarMax);\n";a+="     if (texture1.r < _volumeLowerThreshold ||\n";a+="         texture1.r > _volumeUpperThreshold ||\n";a+="         texture1.a == 0.0 ) {\n";a+="       discard;\n";a+="     };\n";a+="   };\n";
a+="   gl_FragColor = textureSum;\n";a+="   gl_FragColor.a = objectOpacity;\n";a+=" } else {\n";a+="   vec3 nNormal = normalize(fTransformedVertexNormal);\n";a+="   if (fVertexNormal == vec3(0.0,0.0,0.0)) {\n";a+="     gl_FragColor = vec4(fragmentColor,1.0);\n";a+="     return;\n";a+="   }\n";a+="   vec3 light = vec3(0.0, 0.0, 1.0);\n";a+="   vec3 lightDirection = vec3(0,0,-10);\n";a+="   lightDirection = normalize(lightDirection);\n";a+="   vec3 eyeDirection = normalize(-fVertexPosition.xyz);\n";
a+="   vec3 reflectionDirection = reflect(-lightDirection, nNormal);\n";a+="   float specular = pow(max(dot(reflectionDirection, eyeDirection), 0.0), 10.0);\n";a+="   float diffuse = 0.8 * max(dot(nNormal, light), 0.0);\n";a+="   float ambient = 0.3;\n";a+="   gl_FragColor = vec4(fragmentColor * ambient +\n";a+="                       fragmentColor * diffuse +\n";a+="                       vec3(0.2, 0.2, 0.2) * specular,\n";a+="                       objectOpacity);\n";a+=" }\n";this.Kd=a+="}\n"}
C(Ag,O);
var Bg={nk:"vertexPosition",mk:"vertexNormal",lk:"vertexColor",pk:"vertexTexturePos",ok:"vertexScalar"},Cg={qk:"view",Vj:"perspective",Mj:"center",Uj:"objectTransform",hk:"useObjectColor",Sj:"objectColor",jk:"useScalars",dk:"scalarsReplaceMode",ak:"scalarsMin",Yj:"scalarsMax",bk:"scalarsMinColor",Zj:"scalarsMaxColor",ck:"scalarsMinThreshold",$j:"scalarsMaxThreshold",Xj:"scalarsInterpolation",Wj:"pointSize",Tj:"objectOpacity",Rj:"normal",ik:"usePicking",kk:"useTexture",gk:"useLabelMapTexture",Pj:"labelmapOpacity",
Oj:"labelmapColor",ek:"textureSampler",fk:"textureSampler2",rk:"volumeLowerThreshold",xk:"volumeUpperThreshold",uk:"volumeScalarMin",sk:"volumeScalarMax",vk:"volumeScalarMinColor",tk:"volumeScalarMaxColor",zk:"volumeWindowLow",yk:"volumeWindowHigh",wk:"volumeTexture"};function Dg(a,b,c,e,d,f,g,h){var l,j;if(l=c.offsetParent){var k="HTML"==l.tagName||"BODY"==l.tagName;if(!k||"static"!=me(l,"position"))j=re(l),k||(k=(k=se(l))&&lb?-l.scrollLeft:k&&(!J||!Cb("8"))&&"visible"!=me(l,"overflowX")?l.scrollWidth-l.clientWidth-l.scrollLeft:l.scrollLeft,j=Wd(j,new Vd(k,l.scrollTop)))}l=j||new Vd;j=re(a);k=we(a);j=new je(j.x,j.y,k.width,k.height);(k=qe(a))&&j.Ig(new je(k.left,k.top,k.right-k.left,k.bottom-k.top));var k=Xd(a),n=Xd(c);if(k.da!=n.da){var r=k.da.body,n=n.da.parentWindow||
n.da.defaultView,s=new Vd(0,0),z=Zd(r)?Zd(r).parentWindow||Zd(r).defaultView:window,y=r;do{var E=z==n?re(y):te(y);s.x+=E.x;s.y+=E.y}while(z&&z!=n&&(y=z.frameElement)&&(z=z.parent));r=Wd(s,re(r));J&&!ge(k)&&(r=Wd(r,he(k)));j.left+=r.x;j.top+=r.y}a=(b&4&&se(a)?b^2:b)&-5;b=new Vd(a&2?j.left+j.width:j.left,a&1?j.top+j.height:j.top);b=Wd(b,l);d&&(b.x+=(a&2?-1:1)*d.x,b.y+=(a&1?-1:1)*d.y);var F;if(g&&(F=qe(c)))F.top-=l.y,F.right-=l.x,F.bottom-=l.y,F.left-=l.x;return Eg(b,c,e,f,F,g,h)}
function Eg(a,b,c,e,d,f,g){a=a.l();var h=0,l=(c&4&&se(b)?c^2:c)&-5;c=we(b);g=g?g.l():c.l();if(e||0!=l)l&2?a.x-=g.width+(e?e.right:0):e&&(a.x+=e.left),l&1?a.y-=g.height+(e?e.bottom:0):e&&(a.y+=e.top);if(f){if(d){h=a;e=0;if(65==(f&65)&&(h.x<d.left||h.x>=d.right))f&=-2;if(132==(f&132)&&(h.y<d.top||h.y>=d.bottom))f&=-5;h.x<d.left&&f&1&&(h.x=d.left,e|=1);h.x<d.left&&(h.x+g.width>d.right&&f&16)&&(g.width=Math.max(g.width-(h.x+g.width-d.right),0),e|=4);h.x+g.width>d.right&&f&1&&(h.x=Math.max(d.right-g.width,
d.left),e|=1);f&2&&(e|=(h.x<d.left?16:0)|(h.x+g.width>d.right?32:0));h.y<d.top&&f&4&&(h.y=d.top,e|=2);h.y<=d.top&&(h.y+g.height<d.bottom&&f&32)&&(g.height=Math.max(g.height-(d.top-h.y),0),h.y=0,e|=8);h.y>=d.top&&(h.y+g.height>d.bottom&&f&32)&&(g.height=Math.max(g.height-(h.y+g.height-d.bottom),0),e|=8);h.y+g.height>d.bottom&&f&4&&(h.y=Math.max(d.bottom-g.height,d.top),e|=2);f&8&&(e|=(h.y<d.top?64:0)|(h.y+g.height>d.bottom?128:0));h=e}else h=256;if(h&496)return h}f=a;d=lb&&(bb||qb)&&Cb("1.9");f instanceof
Vd?(a=f.x,f=f.y):(a=f,f=p);b.style.left=ve(a,d);b.style.top=ve(f,d);if(!(c==g||(!c||!g?0:c.width==g.width&&c.height==g.height)))a=ge(Xd(Zd(b))),J&&(!a||!Cb("8"))?(c=b.style,a?(J?(a=Ae(b,"paddingLeft"),d=Ae(b,"paddingRight"),f=Ae(b,"paddingTop"),e=Ae(b,"paddingBottom"),a=new ie(f,d,e,a)):(a=le(b,"paddingLeft"),d=le(b,"paddingRight"),f=le(b,"paddingTop"),e=le(b,"paddingBottom"),a=new ie(parseFloat(f),parseFloat(d),parseFloat(e),parseFloat(a))),J?(d=Ce(b,"borderLeft"),f=Ce(b,"borderRight"),e=Ce(b,"borderTop"),
b=Ce(b,"borderBottom"),b=new ie(e,f,b,d)):(d=le(b,"borderLeftWidth"),f=le(b,"borderRightWidth"),e=le(b,"borderTopWidth"),b=le(b,"borderBottomWidth"),b=new ie(parseFloat(e),parseFloat(f),parseFloat(b),parseFloat(d))),c.pixelWidth=g.width-b.left-a.left-a.right-b.right,c.pixelHeight=g.height-b.top-a.top-a.bottom-b.bottom):(c.pixelWidth=g.width,c.pixelHeight=g.height)):(b=b.style,lb?b.MozBoxSizing="border-box":mb?b.WebkitBoxSizing="border-box":b.boxSizing="border-box",b.width=Math.max(g.width,0)+"px",
b.height=Math.max(g.height,0)+"px");return h};function Fg(){}Fg.prototype.lb=ea();function Gg(a,b){this.bf=a instanceof Vd?a:new Vd(a,b)}C(Gg,Fg);Gg.prototype.lb=function(a,b,c,e){Dg(ne(a),0,a,b,this.bf,c,t,e)};function Hg(a,b,c){this.element=a;this.ug=b;this.mj=c}C(Hg,Fg);Hg.prototype.lb=function(a,b,c){Dg(this.element,this.ug,a,b,p,c,this.mj)};function Ig(a,b){ic.call(this);this.Ab=new kg(this);this.Ef(a||t);b&&(this.Mc=b)}C(Ig,ic);w=Ig.prototype;w.D=t;w.Ph=q;w.og=t;w.Ha=u;w.xj=u;w.kf=-1;w.Lg=-1;w.ti=u;w.ci=q;w.Mc="toggle_display";w.s=v("D");w.Ef=function(a){this.Ha&&m(Error("Can not change this state of the popup while showing."));this.D=a};
function Jg(a,b){a.ve&&a.ve.stop();a.je&&a.je.stop();if(b){if(!a.Ha&&a.rf()){a.D||m(Error("Caller must call setElement before trying to show the popup"));a.lb();var c=Zd(a.D);a.ti&&mg(a.Ab,c,"keydown",a.Li,q);if(a.Ph)if(mg(a.Ab,c,"mousedown",a.Tg,q),J){var e;try{e=c.activeElement}catch(d){}for(;e&&"IFRAME"==e.nodeName;){try{var f=e.contentDocument||e.contentWindow.document}catch(g){break}c=f;e=c.activeElement}mg(a.Ab,c,"mousedown",a.Tg,q);mg(a.Ab,c,"deactivate",a.Sg)}else mg(a.Ab,c,"blur",a.Sg);"toggle_display"==
a.Mc?(a.D.style.visibility="visible",ye(a.D,q)):"move_offscreen"==a.Mc&&a.lb();a.Ha=q;a.ve?($b(a.ve,"end",a.Wg,u,a),a.ve.play()):a.Wg()}}else Kg(a)}w.lb=ha;function Kg(a,b){if(!a.Ha||!a.dispatchEvent({type:"beforehide",target:b}))return u;a.Ab&&a.Ab.Df();a.Ha=u;a.Lg=xa();a.je?($b(a.je,"end",wa(a.tg,b),u,a),a.je.play()):a.tg(b);return q}w.tg=function(a){"toggle_display"==this.Mc?this.xj?yg(this.Dg,0,this):this.Dg():"move_offscreen"==this.Mc&&(this.D.style.top="-10000px");this.vf(a)};
w.Dg=function(){this.D.style.visibility="hidden";ye(this.D,u)};w.rf=function(){return this.dispatchEvent("beforeshow")};w.Wg=function(){this.kf=xa();this.Lg=-1;this.dispatchEvent("show")};w.vf=function(a){this.dispatchEvent({type:"hide",target:a})};w.Tg=function(a){a=a.target;!fe(this.D,a)&&((!this.og||fe(this.og,a))&&!(150>xa()-this.kf))&&Kg(this,a)};w.Li=function(a){27==a.keyCode&&Kg(this,a.target)&&(a.preventDefault(),a.stopPropagation())};
w.Sg=function(a){if(this.ci){var b=Zd(this.D);if(J||jb){if(a=b.activeElement,!a||fe(this.D,a)||"BODY"==a.tagName)return}else if(a.target!=b)return;150>xa()-this.kf||Kg(this)}};function Lg(a,b){this.qj=4;this.ne=b||p;Ig.call(this,a)}C(Lg,Ig);Lg.prototype.lb=function(){if(this.ne){var a=!this.Ha&&"move_offscreen"!=this.Mc,b=this.s();a&&(b.style.visibility="hidden",ye(b,q));this.ne.lb(b,this.qj,this.Sk);a&&ye(b,u)}};function Mg(a){this.$=new yc;a&&this.Ue(a)}function Ng(a){var b=typeof a;return"object"==b&&a||"function"==b?"o"+qa(a):b.substr(0,1)+a}w=Mg.prototype;w.ee=function(){return this.$.ee()};w.add=function(a){this.$.set(Ng(a),a)};w.Ue=function(a){a=xc(a);for(var b=a.length,c=0;c<b;c++)this.add(a[c])};w.Df=function(a){a=xc(a);for(var b=a.length,c=0;c<b;c++)this.remove(a[c])};w.remove=function(a){return this.$.remove(Ng(a))};w.clear=function(){this.$.clear()};
w.contains=function(a){a=Ng(a);return Bc(this.$.$,a)};w.Ig=function(a){var b=new Mg;a=xc(a);for(var c=0;c<a.length;c++){var e=a[c];this.contains(e)&&b.add(e)}return b};w.sd=function(){return this.$.sd()};w.l=function(){return new Mg(this)};function Og(a,b,c){this.Wb=c||(a?Xd($d(a)):Xd());Lg.call(this,this.Wb.Ic("div",{style:"position:absolute;display:none;"}));this.cf=new Vd(1,1);this.ae=new Mg;a&&Pg(this,a);if(b!=t)if(a=this.s(),"textContent"in a)a.textContent=b;else if(a.firstChild&&3==a.firstChild.nodeType){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{for(;c=a.firstChild;)a.removeChild(c);a.appendChild(Zd(a).createTextNode(String(b)))}}C(Og,Lg);var Qg=[];w=Og.prototype;w.Na=t;w.className="goog-tooltip";
w.jh=500;w.si=0;w.fe=v("Wb");function Pg(a,b){b=$d(b);a.ae.add(b);L(b,"mouseover",a.ri,u,a);L(b,"mouseout",a.Ag,u,a);L(b,"mousemove",a.qi,u,a);L(b,"focus",a.pi,u,a);L(b,"blur",a.Ag,u,a)}w.Ef=function(a){var b=this.s();b&&de(b);Og.z.Ef.call(this,a);a&&(b=this.Wb.da.body,b.insertBefore(a,b.lastChild))};
w.rf=function(){if(!Ig.prototype.rf.call(this))return u;if(this.anchor)for(var a,b=0;a=Qg[b];b++)fe(a.s(),this.anchor)||Jg(a,u);0<=Ib(Qg,this)||Qg.push(this);a=this.s();a.className=this.className;Rg(this);L(a,"mouseover",this.Cg,u,this);L(a,"mouseout",this.Bg,u,this);Sg(this);return q};
w.vf=function(){Nb(Qg,this);for(var a=this.s(),b,c=0;b=Qg[c];c++)b.anchor&&fe(a,b.anchor)&&Jg(b,u);this.Zg&&Tg(this.Zg);ac(a,"mouseover",this.Cg,u,this);ac(a,"mouseout",this.Bg,u,this);this.anchor=p;if(0==(this.Db?this.Ha?4:1:this.Kc?3:this.Ha?2:0))this.se=u;Ig.prototype.vf.call(this)};w.Pg=function(a,b){this.anchor==a&&this.ae.contains(this.anchor)&&(this.se||!this.Wk?(Jg(this,u),this.Ha||(this.anchor=a,this.ne=b||Ug(this,0)||p,this.Ha&&this.lb(),Jg(this,q))):this.anchor=p);this.Db=p};
w.Hi=function(a){this.Kc=p;a==this.anchor&&(this.Na==t||this.Na!=this.s()&&!this.ae.contains(this.Na))&&(!this.qg||!this.qg.Na)&&Jg(this,u)};function Vg(a,b){var c=he(a.Wb);a.cf.x=b.clientX+c.x;a.cf.y=b.clientY+c.y}w.ri=function(a){var b=Wg(this,a.target);this.Na=b;Rg(this);b!=this.anchor&&(this.anchor=b,this.Db||(this.Db=yg(va(this.Pg,this,b,p),this.jh)),Xg(this),Vg(this,a))};function Wg(a,b){try{for(;b&&!a.ae.contains(b);)b=b.parentNode;return b}catch(c){return t}}
w.qi=function(a){Vg(this,a);this.se=q};w.pi=function(a){this.Na=a=Wg(this,a.target);this.se=q;if(this.anchor!=a){this.anchor=a;var b=Ug(this,1);Rg(this);this.Db||(this.Db=yg(va(this.Pg,this,a,b),this.jh));Xg(this)}};function Ug(a,b){if(0==b){var c=a.cf.l();return new Yg(c)}return new Zg(a.Na)}function Xg(a){if(a.anchor)for(var b,c=0;b=Qg[c];c++)fe(b.s(),a.anchor)&&(b.qg=a,a.Zg=b)}
w.Ag=function(a){var b=Wg(this,a.target),c=Wg(this,a.relatedTarget);b!=c&&(b==this.Na&&(this.Na=t),Sg(this),this.se=u,this.Ha&&(!a.relatedTarget||!fe(this.s(),a.relatedTarget))?Tg(this):this.anchor=p)};w.Cg=function(){var a=this.s();this.Na!=a&&(Rg(this),this.Na=a)};w.Bg=function(a){var b=this.s();if(this.Na==b&&(!a.relatedTarget||!fe(b,a.relatedTarget)))this.Na=t,Tg(this)};function Sg(a){a.Db&&(ga.clearTimeout(a.Db),a.Db=p)}
function Tg(a){if(2==(a.Db?a.Ha?4:1:a.Kc?3:a.Ha?2:0))a.Kc=yg(va(a.Hi,a,a.anchor),a.si)}function Rg(a){a.Kc&&(ga.clearTimeout(a.Kc),a.Kc=p)}function Yg(a,b){Gg.call(this,a,b)}C(Yg,Gg);Yg.prototype.lb=function(a,b,c){b=ne(a);b=qe(b);c=c?new ie(c.top+10,c.right,c.bottom,c.left+10):new ie(10,0,0,10);Eg(this.bf,a,4,c,b,9)&496&&Eg(this.bf,a,4,c,b,5)};function Zg(a){Hg.call(this,a,3)}C(Zg,Hg);
Zg.prototype.lb=function(a,b,c){var e=new Vd(10,0);Dg(this.element,this.ug,a,b,e,c,9)&496&&Dg(this.element,2,a,1,e,c,5)};function $g(a,b,c,e){a==t&&m(Error("No valid parent element."));(!x(b)||!x(c))&&m(Error("Invalid coordinates."));(e==t||!(e instanceof Ge))&&m(Error("Invalid interactor."));Og.call(this);this.g="caption";this.Va=a;this.Xd=b;this.Yd=c;this.S=e;this.yb=t;this.ac=[];a=".x-tooltip {\n  background: #C0C0FF;\n  color: #000000;\n";a+="  border: 1px solid infotext;\n";a+="  padding: 1px;\n";a+="  font-family: sans-serif;\n";a+="}";this.ac=[a];$b(e,Ad,this.ud.bind(this));this.hf()}C($g,Og);
$g.prototype.hf=function(){var a=le(this.Va,"position");if("static"==a||""==a)this.Va.style.position="relative";var a=document.getElementsByTagName("head")[0],b=be("style");b.type="text/css";b.media="screen";var c=document.createTextNode(String(this.ac[0]));a.appendChild(b);b.appendChild(c);this.yb=b;this.ne=new Gg(this.Xd,this.Yd)||p;this.Ha&&this.lb();Jg(this,q);Pg(this,this.Va);this.s().classList.add("x-tooltip")};
$g.prototype.ud=function(){Jg(this,u);this.yb&&de(this.yb);this.s()&&de(this.s());this.yb=t};function ah(){zg.call(this);this.g="renderer3D";this.Vc=this.Yc=this.Uc=this.Xc=this.Tc=this.Wc=this.Oe=this.Pe=t;this.A=[0,0,0];this.Nc=[0,0,0];this.gg=t;this.ze=new yc;this.ld=new yc;this.fc=new yc;this.Zc=new yc;this.rc=new yc;this.Bc=new yc;this.ec=new yc;this.Gc=new yc;this.O={PROGRESSBAR_ENABLED:q,PICKING_ENABLED:q,ORDERING_ENABLED:q,STATISTICS_ENABLED:u,INTERMEDIATE_RENDERING:u}}C(ah,zg);ah.prototype.__defineGetter__("config",v("O"));w=ah.prototype;
w.sj=function(){this.Vc=this.Yc=this.Uc=this.Xc=this.Tc=this.Wc=t;this.A=[0,0,0]};w.wf=function(a){ah.z.wf.call(this,a);var b=a.Xd;a=a.Yd;var c=this.Bf(b,a);if(c=this.get(c))if(c=c.qc){var e=te(this.B);(new $g(this.B,e.x+b+10,e.y+a+10,this.S)).s().innerHTML=c}};
w.wa=function(){ah.z.wa.call(this,"experimental-webgl");try{if(this.a.viewport(0,0,this.H,this.v),this.a.clearColor(this.Nc[0],this.Nc[1],this.Nc[2],0),this.a.enable(this.a.BLEND),this.a.blendEquation(this.a.FUNC_ADD),this.a.blendFunc(this.a.SRC_ALPHA,this.a.ONE_MINUS_SRC_ALPHA),this.a.enable(this.a.DEPTH_TEST),this.a.depthFunc(this.a.LEQUAL),this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT),this.O.PICKING_ENABLED){var a=this.a.createFramebuffer(),b=this.a.createRenderbuffer(),c=this.a.createTexture();
this.a.bindTexture(this.a.TEXTURE_2D,c);this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGB,this.H,this.v,0,this.a.RGB,this.a.UNSIGNED_BYTE,t);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,this.a.CLAMP_TO_EDGE);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST);this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST);this.a.bindFramebuffer(this.a.FRAMEBUFFER,
a);this.a.bindRenderbuffer(this.a.RENDERBUFFER,b);this.a.renderbufferStorage(this.a.RENDERBUFFER,this.a.DEPTH_COMPONENT16,this.H,this.v);this.a.bindRenderbuffer(this.a.RENDERBUFFER,t);this.a.framebufferTexture2D(this.a.FRAMEBUFFER,this.a.COLOR_ATTACHMENT0,this.a.TEXTURE_2D,c,0);this.a.framebufferRenderbuffer(this.a.FRAMEBUFFER,this.a.DEPTH_ATTACHMENT,this.a.RENDERBUFFER,b);this.a.bindFramebuffer(this.a.FRAMEBUFFER,t);this.gg=a}}catch(e){m(Error("Exception while accessing GL Context!\n"+e))}a=new Ag;
(this.za==t||this.a==t||this.J==t)&&m(Error("Renderer was not initialized properly."));(a==t||!(a instanceof Ag))&&m(Error("Could not add shaders."));b=Object.keys(Cg);Object.keys(Bg).every(function(a){a=Bg[a];return-1!=this.Vd.search(a)||-1!=this.Kd.search(a)}.bind(a))||m(Error("Could not find all attributes in the shader sources."));b.every(function(a){a=Cg[a];return-1!=this.Vd.search(a)||-1!=this.Kd.search(a)}.bind(a))||m(Error("Could not find all uniforms in the shader sources."));b=this.a.createShader(this.a.FRAGMENT_SHADER);
c=this.a.createShader(this.a.VERTEX_SHADER);this.a.shaderSource(b,a.Kd);this.a.shaderSource(c,a.Vd);this.a.compileShader(b);this.a.compileShader(c);this.a.getShaderParameter(b,this.a.COMPILE_STATUS)||m(Error("Fragement Shader compilation failed!\n"+this.a.getShaderInfoLog(b)));this.a.getShaderParameter(c,this.a.COMPILE_STATUS)||m(Error("Vertex Shader compilation failed!\n"+this.a.getShaderInfoLog(c)));var d=this.a.createProgram();this.a.attachShader(d,c);this.a.attachShader(d,b);this.a.linkProgram(d);
this.a.getProgramParameter(d,this.a.LINK_STATUS)||m(Error("Could not create shader program!\n"+this.a.getShaderInfoLog(b)+"\n"+this.a.getShaderInfoLog(c)+"\n"+this.a.getProgramInfoLog(d)));this.a.useProgram(d);this.Oe=d;Object.keys(Bg).forEach(function(a){a=Bg[a];this.ze.set(a,this.a.getAttribLocation(this.Oe,a));this.a.enableVertexAttribArray(this.ze.get(a))}.bind(this));Object.keys(Cg).forEach(function(a){a=Cg[a];this.ld.set(a,this.a.getUniformLocation(this.Oe,a))}.bind(this));this.Pe=a};
w.sb=function(a){ah.z.sb.call(this,a);var b=u;if(a!=t){this.get(a.ta)&&(b=q);var c=a.ta,e=a.h,d=a.q,f=a.la,g=a.C,h=a.r,l=a.ca,j=a.Aa,k=a.e,n=a.G;if(k!=t&&k.r!=t&&k.r.j)this.sb(k);else if(k!=t&&k.j&&this.sb(k),j!=t&&j.r!=t&&j.r.j)this.W.load(j,a);else if(g!=t&&g.r!=t&&g.r.j)this.W.load(g,a);else{if(h!=t&&la(h))if(a.nc!=t){if(a.nc.lf!=h.length||!a.j)return}else{b=0;c=h.length;for(b=0;b<c;b++)this.W.load(h[b],a);return}else{if(h!=t&&h.j){this.W.load(a,a);return}if(n!=t&&n.r!=t&&n.r.j){this.W.load(n,
a);return}}if(0<a.c.length){h=a.c;j=h.length;for(k=k=0;k<j;k++)this.sb(h[k])}if(e){for(h=0;this.Pd;)h++,window.console.log("Possible thread lock avoided: "+h);this.Pd=q;j=a instanceof Le&&a.zb instanceof Xe;b&&(g!=t&&g.j)&&(h=this.ec.get(c),h!=t&&this.a.isBuffer(h.M)&&this.a.deleteBuffer(h.M));h=t;g!=t&&(!b||g.j?(h=a.Fc,h==t&&m(Error("Can not add an object and texture without valid coordinate mapping! Set the textureCoordinateMap!")),k=u,g.Tb&&(k=q),this.a.pixelStorei(this.a.UNPACK_FLIP_Y_WEBGL,k),
k=this.a.createTexture(),k.vi=g.Jb,this.Gc.set(g.ta,k),this.a.bindTexture(this.a.TEXTURE_2D,k),g.Tb?(k=this.a.RGBA,g.Xf&&(k=this.a.LUMINANCE,this.a.pixelStorei(this.a.UNPACK_ALIGNMENT,1)),this.a.texImage2D(this.a.TEXTURE_2D,0,k,g.Ne,g.Me,0,k,this.a.UNSIGNED_BYTE,g.Tb)):this.a.texImage2D(this.a.TEXTURE_2D,0,this.a.RGBA,this.a.RGBA,this.a.UNSIGNED_BYTE,k.vi),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_S,this.a.CLAMP_TO_EDGE),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_WRAP_T,
this.a.CLAMP_TO_EDGE),j?(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.NEAREST),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.NEAREST)):(this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MAG_FILTER,this.a.LINEAR),this.a.texParameteri(this.a.TEXTURE_2D,this.a.TEXTURE_MIN_FILTER,this.a.LINEAR)),this.a.bindTexture(this.a.TEXTURE_2D,t),k=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,k),this.a.bufferData(this.a.ARRAY_BUFFER,new Float32Array(h),
this.a.STATIC_DRAW),h=new Qd(k,h.length,2),this.ec.set(c,h),g.j=u):h=this.ec.get(c));Vf(this.W,0.1);if(j)this.Pd=u,D.Ua(this.g+".update"),Vf(this.W,0.9);else{if(!b||e.j||l.j){j=l.N;g=D.f.X(j,e.eb,e.fb,e.gb);j=D.f.X(j,e.$a,e.ab,e.bb);if(this.Wc===t||g.x<this.Wc)this.Wc=g.x;if(this.Tc===t||j.x>this.Tc)this.Tc=j.x;if(this.Xc===t||g.y<this.Xc)this.Xc=g.y;if(this.Uc===t||j.y>this.Uc)this.Uc=j.y;if(this.Yc===t||g.d<this.Yc)this.Yc=g.d;if(this.Vc===t||j.d>this.Vc)this.Vc=j.d;this.A=[(this.Wc+this.Tc)/2,
(this.Xc+this.Uc)/2,(this.Yc+this.Vc)/2];l.j=u}b&&e.j&&(l=this.fc.get(c),l!=t&&this.a.isBuffer(l.M)&&this.a.deleteBuffer(l.M));l=t;!b||e.j?(l=this.a.createBuffer(),e.Cb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,l),this.a.bufferData(this.a.ARRAY_BUFFER,e.Y,this.a.STATIC_DRAW),l=new Qd(l,e.count,3),e.j=u):l=this.fc.get(c);Vf(this.W,0.3);b&&d.j&&(g=this.fc.get(c),g!=t&&this.a.isBuffer(g.M)&&this.a.deleteBuffer(g.M));g=t;!b||d.j?(g=this.a.createBuffer(),d.Cb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,g),this.a.bufferData(this.a.ARRAY_BUFFER,
d.Y,this.a.STATIC_DRAW),g=new Qd(g,d.count,3),d.j=u):g=this.Zc.get(c);Vf(this.W,0.3);b&&(f&&f.j)&&(d=this.rc.get(c),d!=t&&this.a.isBuffer(d.M)&&this.a.deleteBuffer(d.M));d=t;f&&(!b||f.j?(f.length!=e.length&&m(Error("Mismatch between points and point colors.")),d=this.a.createBuffer(),f.Cb(),this.a.bindBuffer(this.a.ARRAY_BUFFER,d),this.a.bufferData(this.a.ARRAY_BUFFER,f.Y,this.a.STATIC_DRAW),d=new Qd(d,f.count,3),f.j=u):d=this.rc.get(c));Vf(this.W,0.2);b&&(n&&n.j)&&(f=this.Bc.get(c),f!=t&&this.a.isBuffer(f.M)&&
this.a.deleteBuffer(f.M));f=t;n&&(f=n.Pc,!b||n.j?(f.length!=e.length&&m(Error("Mismatch between points and scalars.")),e=this.a.createBuffer(),this.a.bindBuffer(this.a.ARRAY_BUFFER,e),this.a.bufferData(this.a.ARRAY_BUFFER,f,this.a.STATIC_DRAW),f=new Qd(e,f.length,3),n.j=u):f=this.Bc.get(c));Vf(this.W,0.1);b||this.pb.add(a);this.fc.set(c,l);this.Zc.set(c,g);this.rc.set(c,d);this.ec.set(c,h);this.Bc.set(c,f);this.Pd=a.j=u}}else a.j=u}}};
w.Bf=function(a,b){if(this.O.PICKING_ENABLED){this.$b(q,u);var c=new Uint8Array(4);this.a.readPixels(a,this.v-b,1,1,this.a.RGBA,this.a.UNSIGNED_BYTE,c);return c[0]+255*c[1]+65025*c[2]}return-1};
w.$b=function(a,b){ah.z.$b.call(this,a,b);this.a.viewport(0,0,this.H,this.v);this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);var c=this.pb.F,e=c.length;if(0!=e){a?this.a.bindFramebuffer(this.a.FRAMEBUFFER,this.gg):this.a.bindFramebuffer(this.a.FRAMEBUFFER,t);var d=this.J.Le,f=this.J.n;this.a.uniformMatrix4fv(this.ld.get("perspective"),u,d);this.a.uniformMatrix4fv(this.ld.get("view"),u,f);d=this.A;this.a.uniform3f(this.ld.get("center"),parseFloat(d[0]),parseFloat(d[1]),parseFloat(d[2]));
f=this.hb.length;for(d=0;d<f;++d){var g=this.hb[d];if(g instanceof Q){var h=D.f.X(this.J.n,g.t[0]+g.b[0].i[0],g.t[1]+g.b[0].i[1],g.t[2]+g.b[0].i[2]),l=D.f.X(this.J.n,g.t[0]-g.b[0].i[0],g.t[1]-g.b[0].i[1],g.t[2]-g.b[0].i[2]),j=Math.abs(h.d-l.d),h=D.f.X(this.J.n,g.t[0]+g.b[1].i[0],g.t[1]+g.b[1].i[1],g.t[2]+g.b[1].i[2]),l=D.f.X(this.J.n,g.t[0]-g.b[1].i[0],g.t[1]-g.b[1].i[1],g.t[2]+-g.b[1].i[2]),k=Math.abs(h.d-l.d),h=D.f.X(this.J.n,g.t[0]+g.b[2].i[0],g.t[1]+g.b[2].i[1],g.t[2]+g.b[2].i[2]),l=D.f.X(this.J.n,
g.t[0]-g.b[2].i[0],g.t[1]-g.b[2].i[1],g.t[2]-g.b[2].i[2]),h=Math.max(j,k,Math.abs(h.d-l.d));h==j?We(g,0):h==k?We(g,1):We(g,2)}}if(this.O.ORDERING_ENABLED){j=u;f=this.hb;g=f.length-1;do if(d=f[g],d instanceof Q&&d.Ma&&-1!=d.T){var j=d.c[d.T].c,k=d.T,h=D.f.X(this.J.n,d.t[0]+d.b[k].w[0],d.t[1]+d.b[k].w[1],d.t[2]+d.b[k].w[2]),l=D.f.X(this.J.n,d.t[0]-d.b[k].w[0],d.t[1]-d.b[k].w[1],d.t[2]-d.b[k].w[2]),h=h.d-l.d,l=Math.max(d.oc[d.T],Math.max(d.oc[d.T+4],d.oc[d.T+8])),n=Math.min(d.oc[d.T],Math.min(d.oc[d.T+
4],d.oc[d.T+8]));if(0>h*(l+n))for(h=h=0;h<d.cd[k]-1;h++)j[h]&&(j[h].qa=d.qa,j[h].sa=d.b[k].Dc*h);else for(h=d.cd[k]-1;0<=h;h--)j[h]&&(j[h].qa=d.qa,j[h].sa=(d.cd[k]-1)*d.b[k].Dc-d.b[k].Dc*h);j=q}while(g--);f=this.pb.F;g=f.length-1;do if(d=f[g],d.L&&!(1==d.qa||d instanceof Le))j=d,k=d.h.Hd,d=D.f.X(d.ca.N,k[0],k[1],k[2]),d=D.f.X(this.J.n,d.x,d.y,d.d),d=D.m.ff(this.J.cc,d),d=Math.round(1E3*d)/1E3,j.sa=d,j=q;while(g--);j&&this.pb.sort()}if(f=!a&&b!=t&&b&&this.O.STATISTICS_ENABLED)var r=0,s=0,z=0,y=0;var d=
this.ze,g=d.get("vertexPosition"),j=d.get("vertexNormal"),k=d.get("vertexColor"),h=d.get("vertexTexturePos"),l=d.get("vertexScalar"),d=this.ld,n=d.get("usePicking"),E=d.get("useObjectColor"),F=d.get("objectColor"),K=d.get("useScalars"),A=d.get("scalarsReplaceMode"),G=d.get("scalarsMin"),I=d.get("scalarsMax"),H=d.get("scalarsMinColor"),R=d.get("scalarsMaxColor"),N=d.get("scalarsInterpolation"),S=d.get("scalarsMinThreshold"),ba=d.get("scalarsMaxThreshold"),aa=d.get("objectOpacity"),ca=d.get("labelmapOpacity"),
M=d.get("labelmapColor"),T=d.get("useTexture"),P=d.get("useLabelMapTexture"),Ea=d.get("textureSampler"),sb=d.get("textureSampler2"),tb=d.get("volumeLowerThreshold"),ub=d.get("volumeUpperThreshold"),kb=d.get("volumeScalarMin"),Tc=d.get("volumeScalarMax"),eh=d.get("volumeWindowLow"),fh=d.get("volumeWindowHigh"),gh=d.get("volumeScalarMinColor"),hh=d.get("volumeScalarMaxColor"),tg=d.get("volumeTexture"),ih=d.get("objectTransform"),jh=d.get("pointSize"),d=e;do{var da=c[e-d];if(da){var ka=t;da instanceof
Le&&da.zb&&(ka=da.zb);if(da.L&&(!ka||ka.L)&&(!a||da.$c)){var za=da.ta,db=da.Sc,Qa=this.fc.get(za),nb=this.Zc.get(za),Te=this.rc.get(za),Kb=this.Bc.get(za),Ue=this.ec.get(za);this.a.bindBuffer(this.a.ARRAY_BUFFER,Qa.M);this.a.vertexAttribPointer(g,Qa.Lb,this.a.FLOAT,u,0,0);this.a.bindBuffer(this.a.ARRAY_BUFFER,nb.M);this.a.vertexAttribPointer(j,nb.Lb,this.a.FLOAT,u,0,0);a?this.a.uniform1i(n,q):this.a.uniform1i(n,u);Te&&!a&&!db?(this.a.uniform1i(E,u),this.a.bindBuffer(this.a.ARRAY_BUFFER,Te.M),this.a.vertexAttribPointer(k,
Te.Lb,this.a.FLOAT,u,0,0)):(nb=1,db&&!a&&(nb=0),this.a.uniform1i(E,nb),nb=da.u,a&&(nb=[Math.floor(za%65025%255)/255,Math.floor(za%65025/255)/255,Math.floor(za/65025)/255]),this.a.uniform3f(F,parseFloat(nb[0]),parseFloat(nb[1]),parseFloat(nb[2])),this.a.vertexAttribPointer(k,Qa.Lb,this.a.FLOAT,u,0,0));Kb&&!a&&!db?(this.a.uniform1i(K,q),this.a.uniform1i(A,da.G.jg),za=da.G.Ob,db=da.G.Mb,this.a.uniform3f(H,parseFloat(za[0]),parseFloat(za[1]),parseFloat(za[2])),this.a.uniform3f(R,parseFloat(db[0]),parseFloat(db[1]),
parseFloat(db[2])),this.a.uniform1f(S,parseFloat(da.G.fa)),this.a.uniform1f(ba,parseFloat(da.G.ga)),this.a.uniform1f(G,parseFloat(da.G.cb)),this.a.uniform1f(I,parseFloat(da.G.ma)),this.a.uniform1i(N,parseInt(da.G.Be,10)),this.a.bindBuffer(this.a.ARRAY_BUFFER,Kb.M),this.a.vertexAttribPointer(l,Kb.Lb,this.a.FLOAT,u,0,0)):(this.a.uniform1i(K,u),this.a.vertexAttribPointer(l,Qa.Lb,this.a.FLOAT,u,0,0));this.a.uniform1f(aa,parseFloat(da.qa));da.C&&Ue&&!a?(this.a.uniform1i(T,q),this.a.activeTexture(this.a.TEXTURE0),
this.a.bindTexture(this.a.TEXTURE_2D,this.Gc.get(da.C.ta)),this.a.uniform1i(Ea,0),this.a.bindBuffer(this.a.ARRAY_BUFFER,Ue.M),this.a.vertexAttribPointer(h,Ue.Lb,this.a.FLOAT,u,0,0),this.a.uniform1i(tg,u)):(this.a.uniform1i(T,u),this.a.vertexAttribPointer(h,Qa.Lb,this.a.FLOAT,u,0,0));ka&&(this.a.uniform1i(tg,q),this.a.uniform1f(tb,ka.fa),this.a.uniform1f(ub,ka.ga),this.a.uniform1f(kb,ka.cb),this.a.uniform1f(Tc,ka.ma),za=ka.Ob,db=ka.Mb,this.a.uniform3f(gh,parseFloat(za[0]),parseFloat(za[1]),parseFloat(za[2])),
this.a.uniform3f(hh,parseFloat(db[0]),parseFloat(db[1]),parseFloat(db[2])),this.a.uniform1f(eh,ka.ia),this.a.uniform1f(fh,ka.ha),Kb=ka.e,this.a.uniform1i(P,u),ka.Ma?this.a.uniform1f(aa,parseFloat(ka.qa)):Kb&&Kb.L&&(ka=da.e.ta,this.a.uniform1i(P,q),this.a.activeTexture(this.a.TEXTURE1),this.a.bindTexture(this.a.TEXTURE_2D,this.Gc.get(ka)),this.a.uniform1i(sb,1),this.a.uniform1f(ca,Kb.qa),this.a.uniform4fv(M,Kb.Qe)));this.a.uniformMatrix4fv(ih,u,da.ca.N);ka=1;"POINTS"==da.Da&&(ka=da.ad);this.a.uniform1f(jh,
ka);ka=-1;da.Da==gd?(ka=this.a.TRIANGLES,f&&(s+=Qa.Kb/3)):"LINES"==da.Da?(this.a.lineWidth(da.zc),ka=this.a.LINES,f&&(z+=Qa.Kb/2)):"POINTS"==da.Da?(ka=this.a.POINTS,f&&(y+=Qa.Kb)):"TRIANGLE_STRIPS"==da.Da?(ka=this.a.TRIANGLE_STRIP,f&&(s+=Qa.Kb/3)):"POLYGONS"==da.Da&&(ka=0==Qa.Kb%3?this.a.TRIANGLES:this.a.TRIANGLE_FAN,f&&(s+=Qa.Kb/3));f&&(r+=Qa.Kb);this.a.drawArrays(ka,0,Qa.Kb)}}}while(--d);f&&(c="Objects: "+e+" | "+("Vertices: "+r+" | "),c+="Triangles: "+Math.round(s)+" | ",c+="Lines: "+z+" | ",c+=
"Points: "+y+" | ",c+="Textures: "+this.Gc.ee(),window.console.log(c))}};
w.remove=function(a){ah.z.remove.call(this,a);if(0<a.c.length)for(var b=a.c,c=b.length,e=0,e=0;e<c;e++)this.remove(b[e]);b=a.ta;c=this.ec.get(b);c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M);if(a.C&&(c=this.Gc.get(a.C.ta)))this.a.deleteTexture(c),this.Gc.remove(a.C.ta);c=this.fc.get(b);c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M);c=this.Zc.get(b);c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M);c=this.rc.get(b);c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M);c=this.Bc.get(b);
c!=t&&this.a.isBuffer(c.M)&&this.a.deleteBuffer(c.M);this.fc.remove(b);this.Zc.remove(b);this.rc.remove(b);this.ec.remove(b);this.Bc.remove(b);this.pb.remove(a);return q};w.$d=function(){this.Pe=t;delete this.Pe;this.a.clear(this.a.COLOR_BUFFER_BIT|this.a.DEPTH_BUFFER_BIT);ah.z.$d.call(this)};ah.prototype.__defineGetter__("bgColor",v("Nc"));ah.prototype.__defineSetter__("bgColor",fa("Nc"));
ah.prototype.oj=function(a,b,c,e,d){c!=t||(c=4);e!=t||(e=2);if(d==t){d=this.Bf(a,b);if(-1==d)return t;d=this.get(d);if(!d)return t}var f=jg(this.J,2*(a/this.H)-1,2*((this.v-b)/this.v)-1,0);a=jg(this.J,2*(a/this.H)-1,2*((this.v-b)/this.v)-1,1);f[0]+=this.A[0];f[1]+=this.A[1];f[2]+=this.A[2];a[0]+=this.A[0];a[1]+=this.A[1];a[2]+=this.A[2];b=[d.h.eb,d.h.fb,d.h.gb];var g=[d.h.$a,d.h.fb,d.h.gb],h=[d.h.$a,d.h.ab,d.h.gb],l=[d.h.eb,d.h.ab,d.h.gb],j=[d.h.eb,d.h.ab,d.h.bb],k=[d.h.eb,d.h.fb,d.h.bb],n=[d.h.$a,
d.h.ab,d.h.bb],r=[d.h.$a,d.h.fb,d.h.bb];b=[D.f.X(d.ca.N,b[0],b[1],b[2]),D.f.X(d.ca.N,g[0],g[1],g[2]),D.f.X(d.ca.N,h[0],h[1],h[2]),D.f.X(d.ca.N,l[0],l[1],l[2]),D.f.X(d.ca.N,j[0],j[1],j[2]),D.f.X(d.ca.N,k[0],k[1],k[2]),D.f.X(d.ca.N,n[0],n[1],n[2]),D.f.X(d.ca.N,r[0],r[1],r[2])];var g=[Infinity,-Infinity,Infinity,-Infinity,Infinity,-Infinity],s;for(s in b)s=b[s],g=[Math.min(g[0],s.x),Math.max(g[1],s.x),Math.min(g[2],s.y),Math.max(g[3],s.y),Math.min(g[4],s.d),Math.max(g[5],s.d)];s=g;b=[];g=[];for(h=0;6>
h;h++){var l=Math.floor(h/2),j=(l+1)%3,k=(l+2)%3,r=(2+2*l)%6,z=(4+2*l)%6,y=(s[h]-f[l])*(1/a[l]);Infinity!=y&&-Infinity!=y&&(n=f[j]+a[j]*y,y=f[k]+a[k]*y,n>=s[r]&&n<=s[r+1]&&y>=s[z]&&y<=s[z+1]?(r=[],r[l]=s[h],r[j]=n,r[k]=y,b.push(r)):(r=[],r[l]=s[h],r[j]=n,r[k]=y,g.push(r)))}a=[b,g];a=a[0];if(0==a.length)return t;g=Array(2);for(s=0;2>s;s++)b=a[s],g[s]=Math.sqrt((b[0]-f[0])*(b[0]-f[0])+(b[1]-f[1])*(b[1]-f[1])+(b[2]-f[2])*(b[2]-f[2]));f=b=s=t;g[0]<g[1]?(s=a[0],b=a[1]):(s=a[1],b=a[0]);f=Math.sqrt((s[0]-
b[0])*(s[0]-b[0])+(s[1]-b[1])*(s[1]-b[1])+(s[2]-b[2])*(s[2]-b[2]));f/=c;a=s;s=[b[0]-s[0],b[1]-s[1],b[2]-s[2]];b=Math.sqrt(s[0]*s[0]+s[1]*s[1]+s[2]*s[2]);g=[s[0]/b,s[1]/b,s[2]/b];h=d.h.Y;l=h.length;for(s=0;s<f;s+=c){a=[a[0]+c*g[0],a[1]+c*g[1],a[2]+c*g[2]];for(b=0;b<l;b+=3)if(j=h[b],k=h[b+1],n=h[b+2],r=new D.m(j,k,n),r=D.f.X(d.ca.N,j,k,n),Math.sqrt((a[0]-r.x)*(a[0]-r.x)+(a[1]-r.y)*(a[1]-r.y)+(a[2]-r.d)*(a[2]-r.d))<=e)return[r.x,r.y,r.d]}return t};B("X.renderer3D",ah);
B("X.renderer3D.prototype.init",ah.prototype.wa);B("X.renderer3D.prototype.add",ah.prototype.add);B("X.renderer3D.prototype.onShowtime",ah.prototype.Xg);B("X.renderer3D.prototype.onRender",ah.prototype.Vg);B("X.renderer3D.prototype.get",ah.prototype.get);B("X.renderer3D.prototype.render",ah.prototype.Zb);B("X.renderer3D.prototype.destroy",ah.prototype.$d);B("X.renderer3D.prototype.remove",ah.prototype.remove);B("X.renderer3D.prototype.resetBoundingBox",ah.prototype.sj);
B("X.renderer3D.prototype.resetViewAndRender",ah.prototype.Ad);B("X.renderer3D.prototype.pick",ah.prototype.Bf);B("X.renderer3D.prototype.pick3d",ah.prototype.oj);function bh(){Y.call(this);this.g="fibers";Ga(this,new wc)}C(bh,Y);B("X.fibers",bh);function ch(){zg.call(this);this.g="renderer2D";this.La=t;this.Ba=-1;this.Pb=[];this.$f=this.Nd=this.Vf=this.Ld=t;this.Cc=this.Ec=this.dd=this.fd=0;this.ha=this.ia=this.ga=this.fa=this.Sf=-1;this.ag=new Float32Array([-255,-255,-255,-255]);this.hg=q}C(ch,zg);ch.prototype.$i=ea();ch.prototype.jj=ea();ch.prototype.yf=function(a){ch.z.yf.call(this,a);var b=this.hb[0];if(b){var c="",c=0==this.Ba?"indexX":1==this.Ba?"indexY":"indexZ";b[c]=a.Z?b[c]+1:b[c]-1;eval("this.onScroll();")}};
ch.prototype.kj=function(a){var b=this.hb[0];if(b){var c=b.ha-b.ia,e=c/2,d=parseInt(c+c/15*-a.Te,10);a=parseInt(e+e/15*a.Ge,10);c==d&&d++;e==a&&a++;b.ia-=parseInt(e-a,10);b.ia-=parseInt(c-d,10);b.ia=Math.max(b.ia,b.cb);b.ha-=parseInt(e-a,10);b.ha+=parseInt(c-d,10);b.ha=Math.min(b.ha,b.ma);eval("this.onWindowLevel();")}};ch.prototype.__defineGetter__("orientation",v("La"));
ch.prototype.__defineSetter__("orientation",function(a){a=a.toUpperCase();"AXIAL"==a?(a="Z",this.Ba=2):"SAGITTAL"==a?(a="X",this.Ba=0):"CORONAL"==a&&(a="Y",this.Ba=1);"X"!=a&&("Y"!=a&&"Z"!=a)&&m(Error("Invalid orientation."));this.La=a});ch.prototype.__defineGetter__("radiological",v("hg"));ch.prototype.__defineSetter__("radiological",fa("hg"));w=ch.prototype;
w.wa=function(){this.La||m(Error("No 2D orientation set."));ch.z.wa.call(this,"2d");this.a.fillStyle="rgba(50,50,50,0)";this.a.fillRect(0,0,this.za.width,this.za.height);this.Ld=be("canvas");this.Nd=be("canvas");L(this.J,vd,this.kj.bind(this))};w.xf=function(){ch.z.xf.call(this);dh(this)};w.Ad=function(){ch.z.Ad.call(this);dh(this);var a=this.hb[0];a&&(a.ha=a.ma,a.ia=a.cb)};
w.sb=function(a){ch.z.sb.call(this,a);var b=u;this.get(a.ta)&&(b=q);if(a instanceof Q){var c=a.r,e=a.e,d=a.Aa;if(e!=t&&e.r!=t&&e.r.j)this.sb(e);else if(d!=t&&d.r!=t&&d.r.j)this.W.load(d,a);else{if(c!=t&&la(c))if(a.nc!=t){if(a.nc.lf!=c.length||b&&!a.j)return}else{b=0;e=c.length;for(b=0;b<e;b++)this.W.load(c[b],a);return}else if(c!=t&&c.j){this.W.load(a,a);return}this.Ba="X"==this.La?0:"Y"==this.La?1:2;this.Wa=a.c[this.Ba].c;d=t;d=0==this.Ba?a.indexX:1==this.Ba?a.indexY:a.indexZ;c=a.c[this.Ba].c[d].Zf;
e=a.c[this.Ba].c[d].Yf;this.Ec=a.c[this.Ba].c[d].Hc;this.Cc=a.c[this.Ba].c[d].uc;this.fd=c;this.dd=e;d=this.Ld;d.width=c;d.height=e;var f=this.Nd;f.width=c;f.height=e;this.Vf=d.getContext("2d");this.$f=f.getContext("2d");b||(this.pb.add(a),dh(this))}}};function dh(a){var b=Math.min(a.H/(a.fd*a.Ec),a.v/(a.dd*a.Cc));a.J.n[14]=b}w.aj=ea();
w.sh=function(a,b){var c=this.hb[0],e=this.J.n,d=t,f=this.fd,g=this.dd,h=t,l=t;if("Y"==this.La)d=this.Wa[parseInt(c.indexY,10)],h=d.Hc,l=d.uc,this.Pb[0]="red",this.Pb[1]="blue";else if("Z"==this.La)d=this.Wa[parseInt(c.indexZ,10)],h=d.Hc,l=d.uc,this.Pb[0]="red",this.Pb[1]="green";else{d=this.Wa[parseInt(c.indexX,10)];h=d.uc;l=d.Hc;this.Pb[0]="green";this.Pb[1]="blue";var j=f,f=g,g=j}var k=1*e[12],n=-1*e[13],j=Math.max(e[14],0.6),e=[this.H/2,this.v/2],h=f*h*j,l=g*l*j,r=e[0]-h/2,e=e[1]-l/2,r=r+k*j,
e=e+n*j;return a>r&&a<r+h&&b>e&&b<e+l?(k=(a-r)/h*f,n=(b-e)/l*g,l=d.Nh[4],"X"==this.La?(j=f-k,k=n,n=j):"Y"==this.La?k=f-k:"Z"==this.La&&(k=f-k,n=g-n),k=d.Mh+k*d.Hc,n=d.Gh+n*d.uc,k=Pc(k,n,l,1),f=Qc(),ad(d.zh,k,f),g=Qc(),ad(d.Ah,k,g),d=Math.round((c.b[0].i[0]*g[0]+c.b[0].i[1]*g[1]+c.b[0].i[2]*g[2]+c.b[0].Je)/c.b[0].Dc),d>=c.b[0].o?d=c.b[0].o-1:0>d&&(d=0),k=Math.round((c.b[1].i[0]*g[0]+c.b[1].i[1]*g[1]+c.b[1].i[2]*g[2]+c.b[1].Je)/c.b[1].Dc),k>=c.b[1].o?k=c.b[1].o-1:0>k&&(k=0),n=Math.round((c.b[2].i[0]*
g[0]+c.b[2].i[1]*g[1]+c.b[2].i[2]*g[2]+c.b[2].Je)/c.b[2].Dc),n>=c.b[2].o?n=c.b[2].o-1:0>n&&(n=0),[[d,k,n],[f[0],f[1],f[2]],[g[0],g[1],g[2]]]):t};
w.$b=function(a,b){ch.z.$b.call(this,a,b);if(0!=this.pb.F.length){var c=this.hb[0],e=t,e=0==this.Ba?c.indexX:1==this.Ba?c.indexY:c.indexZ,d=this.Wa[parseInt(e,10)].Zf,f=this.Wa[parseInt(e,10)].Yf;this.Ec=this.Wa[parseInt(e,10)].Hc;this.Cc=this.Wa[parseInt(e,10)].uc;this.fd=d;this.dd=f;var g=this.H,h=this.v,l=this.J.n;this.a.save();this.a.clearRect(-g,-h,2*g,2*h);this.a.restore();var j=Math.max(l[14],0.1);this.a.setTransform(j,0,0,j,0,0);var k=1*l[12],l=-1*l[13],n=t;c.e&&(n=c.e.Qe);var r=this.Wa[parseInt(e,
10)],s=r.C.Tb,r=r.e,z=t;r&&(z=r.Tb);var y=this.fd,E=this.dd,F=this.Vf,K=this.$f,A=F.getImageData(0,0,y,E),G=K.getImageData(0,0,y,E),I=A.data,H=G.data,R=I.length,N=c.ma,S=c.fa,ba=c.ga,aa=c.ia/N,ca=c.ha/N;if(this.Sf!=e||this.fa!=S||this.ga!=ba||this.ia!=aa||this.ha!=ca||n&&!fg(n,this.ag,0)){var M=this.Ld;M.width=d;M.height=f;M=this.Nd;M.width=d;M.height=f;d=0;do{var M=[0,0,0,0],f=[0,0,0,0],T=s[d]/255*N,P=s[d],P=(P/255-aa)/(ca-aa),P=255*P;T>=S&&T<=ba&&(M=new U(c.Ob[0],c.Ob[1],c.Ob[2]),M=(new U(c.Mb[0],
c.Mb[1],c.Mb[2])).scale(P).add(M.scale(255-P)),M=[Math.floor(M.x),Math.floor(M.y),Math.floor(M.d),255],r&&(-255==n[3]?f=[z[d],z[d+1],z[d+2],z[d+3]]:fg(n,z,d)&&(f=[z[d],z[d+1],z[d+2],z[d+3]])));"X"==this.La?(I[d]=M[0],I[d+1]=M[1],I[d+2]=M[2],I[d+3]=M[3],H[d]=f[0],H[d+1]=f[1],H[d+2]=f[2],H[d+3]=f[3]):"Y"==this.La?(P=Math.floor(d/(4*y)),P=4*P*y+(4*(y-1)-(d-4*P*y)),I[P]=M[0],I[P+1]=M[1],I[P+2]=M[2],I[P+3]=M[3],H[P]=f[0],H[P+1]=f[1],H[P+2]=f[2],H[P+3]=f[3]):(P=R-1-d,I[P-3]=M[0],I[P-2]=M[1],I[P-1]=M[2],
I[P]=M[3],H[P-3]=f[0],H[P-2]=f[1],H[P-1]=f[2],H[P]=f[3]);d+=4}while(d<R);F.putImageData(A,0,0);K.putImageData(G,0,0);this.Sf=e;this.fa=S;this.ga=ba;this.ia=aa;this.ha=ca;r&&(this.ag=n)}this.a.globalAlpha=1;this.a.translate(g/2/j,h/2/j);"X"==this.La&&(this.a.rotate(0.5*Math.PI),e=k,k=l,l=-e);k=-y*this.Ec/2+k;l=-E*this.Cc/2+l;this.a.drawImage(this.Ld,k,l,y*this.Ec,E*this.Cc);r&&c.e.L&&(this.a.globalAlpha=c.e.qa,this.a.drawImage(this.Nd,k,l,y*this.Ec,E*this.Cc));if(this.O.SLICENAVIGATORS&&(this.S.Qd&&
this.S.lg&&!this.S.ob)&&(k=this.S.pa,k=this.sh(k[0],k[1])))c.vb=k[0][0],c.wb=k[0][1],c.xb=k[0][2],c.p(u),this.onSliceNavigation(),this.a.setTransform(1,0,0,1,0,0),this.a.lineWidth=1,this.a.beginPath(),this.a.moveTo(this.S.pa[0],0),this.a.lineTo(this.S.pa[0],this.S.pa[1]-10),this.a.moveTo(this.S.pa[0],this.S.pa[1]+10),this.a.lineTo(this.S.pa[0],this.v),this.a.strokeStyle=this.Pb[0],this.a.stroke(),this.a.closePath(),this.a.beginPath(),this.a.moveTo(0,this.S.pa[1]),this.a.lineTo(this.S.pa[0]-10,this.S.pa[1]),
this.a.moveTo(this.S.pa[0]+10,this.S.pa[1]+0.5),this.a.lineTo(this.H,this.S.pa[1]),this.a.strokeStyle=this.Pb[1],this.a.stroke(),this.a.closePath(),this.a.font="10pt Arial",this.a.textAlign="left",this.a.textBaseline="top",this.a.fillStyle="white",this.a.fillText("RAS: "+k[2][0].toFixed(2)+", "+k[2][1].toFixed(2)+", "+k[2][2].toFixed(2),0,0),y=r=l="undefined","undefined"!=typeof c.ba[k[1][2].toFixed(0)]&&"undefined"!=typeof c.ba[k[1][2].toFixed(0)][k[1][1].toFixed(0)]&&(l=c.ba[k[1][2].toFixed(0)][k[1][1].toFixed(0)][k[1][0].toFixed(0)],
c.I&&(r=c.e.ba[k[1][2].toFixed(0)][k[1][1].toFixed(0)][k[1][0].toFixed(0)],c.e.Oc&&(y=c.e.Oc.get(r),"undefined"!=typeof y&&(y=y[0])))),this.a.fillText("Background:  "+l+" ("+k[1][0].toFixed(0)+", "+k[1][1].toFixed(0)+", "+k[1][2].toFixed(0)+")",0,15),c.I&&this.a.fillText("Labelmap:  "+y+" ("+r+")",0,30)}};B("X.renderer2D",ch);B("X.renderer2D.prototype.init",ch.prototype.wa);B("X.renderer2D.prototype.add",ch.prototype.add);B("X.renderer2D.prototype.onShowtime",ch.prototype.Xg);
B("X.renderer2D.prototype.onRender",ch.prototype.Vg);B("X.renderer2D.prototype.onScroll",ch.prototype.$i);B("X.renderer2D.prototype.onWindowLevel",ch.prototype.jj);B("X.renderer2D.prototype.get",ch.prototype.get);B("X.renderer2D.prototype.resetViewAndRender",ch.prototype.Ad);B("X.renderer2D.prototype.xy2ijk",ch.prototype.sh);B("X.renderer2D.prototype.render",ch.prototype.Zb);B("X.renderer2D.prototype.destroy",ch.prototype.$d);B("X.renderer2D.prototype.onSliceNavigation",ch.prototype.aj);function kh(){Y.call(this);this.g="mesh";Ga(this,new wc)}C(kh,Y);B("X.mesh",kh);
